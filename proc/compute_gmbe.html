<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>compute_gmbe &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>compute_gmbe
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.3% of total for procedures.">107 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe.f90.html'>mqc_mbe.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe.html'>mqc_mbe</a></li>
            <li class="breadcrumb-item active" aria-current="page">compute_gmbe</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-compute_grad~2">compute_grad</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-compute_hess~2">compute_hess</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-current_log_level~7">current_log_level</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-error~48">error</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-fragment~27">fragment</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-has_intersections~2">has_intersections</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-hess_dim~5">hess_dim</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-i~55">i</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-k~14">k</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-level_counts~2">level_counts</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-level_energies~2">level_energies</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-max_level~14">max_level</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-monomer_energy~2">monomer_energy</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-monomer_idx">monomer_idx</a>
            <a class="list-group-item" href="../proc/compute_gmbe.html#variable-sign_factor~2">sign_factor</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/compute_gmbe.html#src">compute_gmbe</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine compute_gmbe(monomers, n_monomers, monomer_results, n_intersections, intersection_results, intersection_sets, intersection_levels, total_energy, sys_geom, total_gradient, total_hessian, bonds, world_comm)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/mqc_physical_fragment.html'>mqc_physical_fragment</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_result_types.html'>mqc_result_types</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_config_parser.html'>mqc_config_parser</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_error.html'>mqc_error</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_gmbe_utils.html'>mqc_gmbe_utils</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_gmbe~~UsesGraph Pages: 1 -->
<svg id="proccompute_gmbeUsesGraph" width="641pt" height="570pt"
 viewBox="0.00 0.00 641.00 570.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_gmbe~~UsesGraph" class="graph" transform="scale(0.91 0.91) rotate(0) translate(4 625.21)">
<title>proc~~compute_gmbe~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-625.21 703,-625.21 703,4 -4,4"/>
<!-- proc~compute_gmbe -->
<g id="proc~~compute_gmbe~~UsesGraph_node1" class="node">
<title>proc~compute_gmbe</title>
<polygon fill="none" stroke="black" points="699,-285 603,-285 603,-261 699,-261 699,-285"/>
<text text-anchor="middle" x="651" y="-270.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_gmbe</text>
</g>
<!-- module~mqc_config_parser -->
<g id="proc~~compute_gmbe~~UsesGraph_node2" class="node">
<title>module~mqc_config_parser</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node2"><a xlink:href="../module/mqc_config_parser.html" xlink:title="mqc_config_parser">
<polygon fill="#337ab7" stroke="#337ab7" points="378.5,-304 264.5,-304 264.5,-280 378.5,-280 378.5,-304"/>
<text text-anchor="middle" x="321.5" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_config_parser</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;module~mqc_config_parser -->
<g id="proc~~compute_gmbe~~UsesGraph_edge1" class="edge">
<title>proc~compute_gmbe&#45;&gt;module~mqc_config_parser</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M636.64,-285.25C611.66,-307.33 555.27,-353.44 498.5,-374"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M496.5,-374C437.74,-395.29 371.91,-341.63 340.74,-311.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="343.13,-308.67 333.59,-304.06 338.17,-313.61 343.13,-308.67"/>
</g>
<!-- module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_node3" class="node">
<title>module~mqc_error</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node3"><a xlink:href="../module/mqc_error.html" xlink:title="mqc_error">
<polygon fill="#337ab7" stroke="#337ab7" points="190,-386 123,-386 123,-362 190,-362 190,-386"/>
<text text-anchor="middle" x="156.5" y="-371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_error</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_edge2" class="edge">
<title>proc~compute_gmbe&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M496.5,-374C423.79,-400.34 397.22,-354.08 322.5,-374"/>
</g>
<!-- module~mqc_gmbe_utils -->
<g id="proc~~compute_gmbe~~UsesGraph_node4" class="node">
<title>module~mqc_gmbe_utils</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node4"><a xlink:href="../module/mqc_gmbe_utils.html" xlink:title="mqc_gmbe_utils">
<polygon fill="#337ab7" stroke="#337ab7" points="371,-508 272,-508 272,-484 371,-484 371,-508"/>
<text text-anchor="middle" x="321.5" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_gmbe_utils</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;module~mqc_gmbe_utils -->
<g id="proc~~compute_gmbe~~UsesGraph_edge3" class="edge">
<title>proc~compute_gmbe&#45;&gt;module~mqc_gmbe_utils</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M496.5,-374C463.85,-385.83 385.12,-446.24 345.74,-477.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="343.17,-474.95 337.52,-483.91 347.53,-480.43 343.17,-474.95"/>
</g>
<!-- module~mqc_physical_fragment -->
<g id="proc~~compute_gmbe~~UsesGraph_node5" class="node">
<title>module~mqc_physical_fragment</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node5"><a xlink:href="../module/mqc_physical_fragment.html" xlink:title="mqc_physical_fragment">
<polygon fill="#337ab7" stroke="#337ab7" points="567,-184 428,-184 428,-160 567,-160 567,-184"/>
<text text-anchor="middle" x="497.5" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_physical_fragment</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;module~mqc_physical_fragment -->
<g id="proc~~compute_gmbe~~UsesGraph_edge4" class="edge">
<title>proc~compute_gmbe&#45;&gt;module~mqc_physical_fragment</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M631.73,-260.82C605.22,-243.15 555.95,-210.3 525.32,-189.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="527.1,-186.86 516.84,-184.23 523.22,-192.69 527.1,-186.86"/>
</g>
<!-- module~mqc_result_types -->
<g id="proc~~compute_gmbe~~UsesGraph_node6" class="node">
<title>module~mqc_result_types</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node6"><a xlink:href="../module/mqc_result_types.html" xlink:title="mqc_result_types">
<polygon fill="#337ab7" stroke="#337ab7" points="373.5,-426 269.5,-426 269.5,-402 373.5,-402 373.5,-426"/>
<text text-anchor="middle" x="321.5" y="-411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_result_types</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;module~mqc_result_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge5" class="edge">
<title>proc~compute_gmbe&#45;&gt;module~mqc_result_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M496.5,-374C460.05,-387.2 417.69,-397.05 383.89,-403.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.86,-400.31 373.69,-405.63 384.17,-407.18 382.86,-400.31"/>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_edge7" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M301.97,-304.04C281.31,-317.15 246.63,-338.22 215,-353 210.07,-355.31 204.8,-357.53 199.54,-359.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.24,-356.36 190.14,-363.2 200.73,-362.91 198.24,-356.36"/>
</g>
<!-- module~mqc_calc_types -->
<g id="proc~~compute_gmbe~~UsesGraph_node7" class="node">
<title>module~mqc_calc_types</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node7"><a xlink:href="../module/mqc_calc_types.html" xlink:title="mqc_calc_types">
<polygon fill="#337ab7" stroke="#337ab7" points="205,-264 108,-264 108,-240 205,-240 205,-264"/>
<text text-anchor="middle" x="156.5" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_calc_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_calc_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge6" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_calc_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M271.59,-280C253.79,-275.63 233.5,-270.65 215.01,-266.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="215.8,-262.7 205.25,-263.72 214.13,-269.5 215.8,-262.7"/>
</g>
<!-- module~mqc_geometry -->
<g id="proc~~compute_gmbe~~UsesGraph_node11" class="node">
<title>module~mqc_geometry</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node11"><a xlink:href="../module/mqc_geometry.html" xlink:title="mqc_geometry">
<polygon fill="#337ab7" stroke="#337ab7" points="203,-184 110,-184 110,-160 203,-160 203,-184"/>
<text text-anchor="middle" x="156.5" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_geometry</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_gmbe~~UsesGraph_edge8" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M303.97,-279.83C275.3,-258.72 216.16,-215.18 182.46,-190.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.2,-187.31 174.07,-184.2 180.05,-192.95 184.2,-187.31"/>
</g>
<!-- module~mqc_method_types -->
<g id="proc~~compute_gmbe~~UsesGraph_node12" class="node">
<title>module~mqc_method_types</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node12"><a xlink:href="../module/mqc_method_types.html" xlink:title="mqc_method_types">
<polygon fill="#337ab7" stroke="#337ab7" points="214.5,-344 98.5,-344 98.5,-320 214.5,-320 214.5,-344"/>
<text text-anchor="middle" x="156.5" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_method_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_method_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge9" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_method_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M271.59,-304C254.27,-308.25 234.59,-313.08 216.51,-317.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="215.53,-314.16 206.65,-319.94 217.2,-320.95 215.53,-314.16"/>
</g>
<!-- pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_node18" class="node">
<title>pic_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62,-284 0,-284 0,-260 62,-260 62,-284"/>
<text text-anchor="middle" x="31" y="-269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_types</text>
</g>
<!-- module~mqc_config_parser&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge10" class="edge">
<title>module~mqc_config_parser&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M264.19,-288.1C207.7,-284.18 122.11,-278.25 72.15,-274.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="72.28,-271.28 62.06,-274.08 71.79,-278.27 72.28,-271.28"/>
</g>
<!-- module~mqc_gmbe_utils&#45;&gt;module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_edge12" class="edge">
<title>module~mqc_gmbe_utils&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M305.68,-483.86C291.29,-471.88 269.05,-452.82 251,-435 233.98,-418.19 234.82,-408.39 215,-395 210.32,-391.84 205.11,-389.09 199.78,-386.71"/>
<polygon fill="#00ff66" stroke="#00ff66" points="200.76,-383.33 190.17,-382.82 198.13,-389.82 200.76,-383.33"/>
</g>
<!-- module~mqc_combinatorics -->
<g id="proc~~compute_gmbe~~UsesGraph_node9" class="node">
<title>module~mqc_combinatorics</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node9"><a xlink:href="../module/mqc_combinatorics.html" xlink:title="mqc_combinatorics">
<polygon fill="#337ab7" stroke="#337ab7" points="215,-508 98,-508 98,-484 215,-484 215,-508"/>
<text text-anchor="middle" x="156.5" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_combinatorics</text>
</a>
</g>
</g>
<!-- module~mqc_gmbe_utils&#45;&gt;module~mqc_combinatorics -->
<g id="proc~~compute_gmbe~~UsesGraph_edge11" class="edge">
<title>module~mqc_gmbe_utils&#45;&gt;module~mqc_combinatorics</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M271.59,-496C257.06,-496 240.86,-496 225.34,-496"/>
<polygon fill="#00ff66" stroke="#00ff66" points="225.27,-492.5 215.27,-496 225.27,-499.5 225.27,-492.5"/>
</g>
<!-- pic_io -->
<g id="proc~~compute_gmbe~~UsesGraph_node15" class="node">
<title>pic_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="183.5,-592 129.5,-592 129.5,-568 183.5,-568 183.5,-592"/>
<text text-anchor="middle" x="156.5" y="-577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_io</text>
</g>
<!-- module~mqc_gmbe_utils&#45;&gt;pic_io -->
<g id="proc~~compute_gmbe~~UsesGraph_edge13" class="edge">
<title>module~mqc_gmbe_utils&#45;&gt;pic_io</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M302.41,-508.24C281.84,-521.81 246.98,-543.78 215,-559 208.14,-562.27 200.62,-565.35 193.36,-568.09"/>
<polygon fill="#00ff66" stroke="#00ff66" points="191.89,-564.9 183.69,-571.61 194.28,-571.48 191.89,-564.9"/>
</g>
<!-- pic_logger -->
<g id="proc~~compute_gmbe~~UsesGraph_node16" class="node">
<title>pic_logger</title>
<polygon fill="#337ab7" stroke="#337ab7" points="190.5,-550 122.5,-550 122.5,-526 190.5,-526 190.5,-550"/>
<text text-anchor="middle" x="156.5" y="-535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_logger</text>
</g>
<!-- module~mqc_gmbe_utils&#45;&gt;pic_logger -->
<g id="proc~~compute_gmbe~~UsesGraph_edge14" class="edge">
<title>module~mqc_gmbe_utils&#45;&gt;pic_logger</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M273.79,-508.04C250.7,-513.98 223.03,-521.11 200.47,-526.93"/>
<polygon fill="#00ff66" stroke="#00ff66" points="199.31,-523.61 190.5,-529.5 201.06,-530.39 199.31,-523.61"/>
</g>
<!-- module~mqc_gmbe_utils&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge15" class="edge">
<title>module~mqc_gmbe_utils&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M313.09,-508.13C298.03,-531.43 261.34,-581.87 215,-601 166.93,-620.84 138.22,-633.96 98,-601 50.29,-561.91 36.35,-362.39 32.96,-294.59"/>
<polygon fill="#00ff66" stroke="#00ff66" points="36.44,-294.02 32.47,-284.2 29.44,-294.35 36.44,-294.02"/>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_config_parser -->
<g id="proc~~compute_gmbe~~UsesGraph_edge17" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_config_parser</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M478.86,-184.17C448.03,-205.42 384.25,-249.41 348.4,-274.14"/>
<polygon fill="#0066ff" stroke="#0066ff" points="346.17,-271.42 339.93,-279.98 350.15,-277.18 346.17,-271.42"/>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_edge19" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M491.83,-184.19C475.76,-223.89 418.43,-348.43 322.5,-374"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M320.5,-374C280.9,-384.56 233.94,-383.17 200.62,-379.97"/>
<polygon fill="#0066ff" stroke="#0066ff" points="200.62,-376.45 190.3,-378.88 199.88,-383.41 200.62,-376.45"/>
</g>
<!-- module~mqc_cgto -->
<g id="proc~~compute_gmbe~~UsesGraph_node8" class="node">
<title>module~mqc_cgto</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node8"><a xlink:href="../module/mqc_cgto.html" xlink:title="mqc_cgto">
<polygon fill="#337ab7" stroke="#337ab7" points="353.5,-226 289.5,-226 289.5,-202 353.5,-202 353.5,-226"/>
<text text-anchor="middle" x="321.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_cgto</text>
</a>
</g>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_cgto -->
<g id="proc~~compute_gmbe~~UsesGraph_edge16" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_cgto</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M446.64,-184.04C420.34,-190.38 388.46,-198.08 363.59,-204.08"/>
<polygon fill="#0066ff" stroke="#0066ff" points="362.65,-200.71 353.75,-206.46 364.29,-207.51 362.65,-200.71"/>
</g>
<!-- module~mqc_elements -->
<g id="proc~~compute_gmbe~~UsesGraph_node10" class="node">
<title>module~mqc_elements</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node10"><a xlink:href="../module/mqc_elements.html" xlink:title="mqc_elements">
<polygon fill="#337ab7" stroke="#337ab7" points="367,-104 276,-104 276,-80 367,-80 367,-104"/>
<text text-anchor="middle" x="321.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_elements</text>
</a>
</g>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_elements -->
<g id="proc~~compute_gmbe~~UsesGraph_edge18" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_elements</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M474.85,-159.85C453.97,-148.36 421.31,-131 392,-118 383.87,-114.39 375.07,-110.84 366.56,-107.58"/>
<polygon fill="#0066ff" stroke="#0066ff" points="367.71,-104.27 357.12,-104.03 365.24,-110.82 367.71,-104.27"/>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_gmbe~~UsesGraph_edge20" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M447.1,-159.98C429.79,-156.33 410.14,-152.8 392,-151 329.64,-144.8 313.28,-144.09 251,-151 238.21,-152.42 224.62,-154.9 211.87,-157.66"/>
<polygon fill="#0066ff" stroke="#0066ff" points="210.85,-154.31 201.87,-159.93 212.39,-161.13 210.85,-154.31"/>
</g>
<!-- module~mqc_physical_constants -->
<g id="proc~~compute_gmbe~~UsesGraph_node13" class="node">
<title>module~mqc_physical_constants</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node13"><a xlink:href="../module/mqc_physical_constants.html" xlink:title="mqc_physical_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="392,-24 251,-24 251,0 392,0 392,-24"/>
<text text-anchor="middle" x="321.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_physical_constants</text>
</a>
</g>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_physical_constants -->
<g id="proc~~compute_gmbe~~UsesGraph_edge21" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_physical_constants</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M490.09,-159.8C475.85,-133.82 439.09,-72.57 392,-38 386.89,-34.25 381.17,-30.98 375.28,-28.14"/>
<polygon fill="#0066ff" stroke="#0066ff" points="376.48,-24.85 365.92,-24.04 373.67,-31.26 376.48,-24.85"/>
</g>
<!-- module~mqc_xyz_reader -->
<g id="proc~~compute_gmbe~~UsesGraph_node14" class="node">
<title>module~mqc_xyz_reader</title>
<g id="a_proc~~compute_gmbe~~UsesGraph_node14"><a xlink:href="../module/mqc_xyz_reader.html" xlink:title="mqc_xyz_reader">
<polygon fill="#337ab7" stroke="#337ab7" points="371,-184 272,-184 272,-160 371,-160 371,-184"/>
<text text-anchor="middle" x="321.5" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_xyz_reader</text>
</a>
</g>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;module~mqc_xyz_reader -->
<g id="proc~~compute_gmbe~~UsesGraph_edge22" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;module~mqc_xyz_reader</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M427.73,-172C412.37,-172 396.22,-172 381.31,-172"/>
<polygon fill="#0066ff" stroke="#0066ff" points="381.2,-168.5 371.2,-172 381.2,-175.5 381.2,-168.5"/>
</g>
<!-- module~mqc_physical_fragment&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge23" class="edge">
<title>module~mqc_physical_fragment&#45;&gt;pic_types</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M488.45,-159.96C472.85,-137.79 436.14,-90.96 392,-71 344.36,-49.46 201.04,-23.06 157.5,-52"/>
</g>
<!-- module~mqc_result_types&#45;&gt;module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_edge24" class="edge">
<title>module~mqc_result_types&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M271.59,-402C248.93,-396.44 222.23,-389.89 200.37,-384.52"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="200.92,-381.05 190.38,-382.07 199.25,-387.85 200.92,-381.05"/>
</g>
<!-- pic_mpi_lib -->
<g id="proc~~compute_gmbe~~UsesGraph_node17" class="node">
<title>pic_mpi_lib</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192.5,-428 120.5,-428 120.5,-404 192.5,-404 192.5,-428"/>
<text text-anchor="middle" x="156.5" y="-413.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_mpi_lib</text>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_mpi_lib -->
<g id="proc~~compute_gmbe~~UsesGraph_edge25" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_mpi_lib</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M269.37,-414.63C248.05,-414.89 223.48,-415.19 202.82,-415.44"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="202.67,-411.95 192.71,-415.57 202.75,-418.94 202.67,-411.95"/>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge26" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M295.94,-426.05C252.07,-445.66 159.1,-478.37 98,-437 50.31,-404.71 37.07,-331.77 33.41,-294.64"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="36.87,-294.02 32.55,-284.35 29.89,-294.6 36.87,-294.02"/>
</g>
<!-- module~mqc_calc_types&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge27" class="edge">
<title>module~mqc_calc_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M107.75,-259.73C96.01,-261.63 83.55,-263.65 72.2,-265.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="71.46,-262.06 62.14,-267.12 72.57,-268.97 71.46,-262.06"/>
</g>
<!-- module~mqc_cgto&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge28" class="edge">
<title>module~mqc_cgto&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M289.37,-211.8C245.51,-209.72 163.54,-209.57 98,-231 82.52,-236.06 66.97,-245.46 54.85,-253.99"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="52.69,-251.24 46.68,-259.97 56.82,-256.89 52.69,-251.24"/>
</g>
<!-- module~mqc_combinatorics&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge29" class="edge">
<title>module~mqc_combinatorics&#45;&gt;pic_types</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M116.98,-483.94C109.95,-480.35 103.21,-475.78 98,-470 51.86,-418.85 37.85,-334.46 33.7,-294.42"/>
<polygon fill="#ffff00" stroke="#ffff00" points="37.17,-294.01 32.77,-284.37 30.2,-294.65 37.17,-294.01"/>
</g>
<!-- module~mqc_elements&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge31" class="edge">
<title>module~mqc_elements&#45;&gt;pic_types</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M275.98,-101.05C235.32,-109.66 178.45,-122.64 157.5,-132"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M155.5,-132C130.92,-142.97 118.67,-133.76 98,-151 66.37,-177.39 47.43,-223 38.42,-250.05"/>
<polygon fill="#7fff00" stroke="#7fff00" points="35.03,-249.17 35.35,-259.76 41.71,-251.28 35.03,-249.17"/>
</g>
<!-- pic_ascii -->
<g id="proc~~compute_gmbe~~UsesGraph_node19" class="node">
<title>pic_ascii</title>
<polygon fill="#337ab7" stroke="#337ab7" points="185.5,-104 127.5,-104 127.5,-80 185.5,-80 185.5,-104"/>
<text text-anchor="middle" x="156.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_ascii</text>
</g>
<!-- module~mqc_elements&#45;&gt;pic_ascii -->
<g id="proc~~compute_gmbe~~UsesGraph_edge30" class="edge">
<title>module~mqc_elements&#45;&gt;pic_ascii</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M275.96,-92C250.83,-92 219.76,-92 195.75,-92"/>
<polygon fill="#7fff00" stroke="#7fff00" points="195.59,-88.5 185.59,-92 195.59,-95.5 195.59,-88.5"/>
</g>
<!-- module~mqc_geometry&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge32" class="edge">
<title>module~mqc_geometry&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M122.55,-184.06C114.16,-187.88 105.42,-192.55 98,-198 77.51,-213.05 58.7,-235.36 46.45,-251.54"/>
<polygon fill="#00ff00" stroke="#00ff00" points="43.47,-249.69 40.35,-259.82 49.1,-253.85 43.47,-249.69"/>
</g>
<!-- module~mqc_method_types&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge33" class="edge">
<title>module~mqc_method_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M128.17,-319.98C118.58,-315.68 107.77,-310.72 98,-306 86.78,-300.58 74.62,-294.4 63.83,-288.81"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="65.25,-285.61 54.76,-284.09 62.02,-291.81 65.25,-285.61"/>
</g>
<!-- module~mqc_physical_constants&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge34" class="edge">
<title>module~mqc_physical_constants&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M250.81,-18.37C220.21,-23.76 185.04,-33.7 157.5,-52"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M155.5,-52C133.08,-66.9 117.01,-51.95 98,-71 48.33,-120.77 36.04,-208.51 33,-249.6"/>
<polygon fill="#00ffff" stroke="#00ffff" points="29.5,-249.46 32.37,-259.66 36.49,-249.89 29.5,-249.46"/>
</g>
<!-- module~mqc_xyz_reader&#45;&gt;module~mqc_error -->
<g id="proc~~compute_gmbe~~UsesGraph_edge35" class="edge">
<title>module~mqc_xyz_reader&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M271.84,-179.47C264.03,-182.56 256.67,-186.91 251,-193 201.35,-246.36 263.12,-298.25 215,-353 210.76,-357.82 205.33,-361.53 199.49,-364.4"/>
<polygon fill="#007fff" stroke="#007fff" points="198.05,-361.21 190.11,-368.23 200.69,-367.69 198.05,-361.21"/>
</g>
<!-- module~mqc_xyz_reader&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_gmbe~~UsesGraph_edge36" class="edge">
<title>module~mqc_xyz_reader&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M271.59,-172C253.15,-172 232.05,-172 213.04,-172"/>
<polygon fill="#007fff" stroke="#007fff" points="213.03,-168.5 203.03,-172 213.03,-175.5 213.03,-168.5"/>
</g>
<!-- module~mqc_xyz_reader&#45;&gt;pic_types -->
<g id="proc~~compute_gmbe~~UsesGraph_edge37" class="edge">
<title>module~mqc_xyz_reader&#45;&gt;pic_types</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M301.7,-159.71C270.61,-141.03 206.99,-109.9 157.5,-132"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_gmbeUsesGraph = svgPanZoom('#proccompute_gmbeUsesGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


    <p>Compute generalized many-body expansion (GMBE) energy with optional gradient and/or hessian</p>
<p>This is the core routine that handles all GMBE computations using
the inclusion-exclusion principle for overlapping fragments.
Optional arguments control what derivatives are computed:
  - If sys_geom and total_gradient are present: compute gradient
  - If total_hessian is also present: compute hessian</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-monomers~9"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>monomers</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_monomers~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_monomers</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-monomer_results"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>monomer_results</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_intersections~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_intersections</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-intersection_results"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>intersection_results</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-intersection_sets~2"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>intersection_sets</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-intersection_levels~2"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>intersection_levels</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_energy~5"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_energy</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~37"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_gradient~5"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_gradient</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_hessian~3"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_hessian</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~26"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~14"></span>
              type(comm_t),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_gmbe~~CallsGraph Pages: 1 -->
<svg id="proccompute_gmbeCallsGraph" width="641pt" height="646pt"
 viewBox="0.00 0.00 641.00 646.24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_gmbe~~CallsGraph" class="graph" transform="scale(0.48 0.48) rotate(0) translate(4 1339.89)">
<title>proc~~compute_gmbe~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1339.89 1329,-1339.89 1329,4 -4,4"/>
<!-- proc~compute_gmbe -->
<g id="proc~~compute_gmbe~~CallsGraph_node1" class="node">
<title>proc~compute_gmbe</title>
<polygon fill="none" stroke="black" points="96,-468 0,-468 0,-444 96,-444 96,-468"/>
<text text-anchor="middle" x="48" y="-453.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_gmbe</text>
</g>
<!-- abort_comm -->
<g id="proc~~compute_gmbe~~CallsGraph_node2" class="node">
<title>abort_comm</title>
<polygon fill="#777777" stroke="#777777" points="504.5,-872 424.5,-872 424.5,-848 504.5,-848 504.5,-872"/>
<text text-anchor="middle" x="464.5" y="-857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abort_comm</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;abort_comm -->
<g id="proc~~compute_gmbe~~CallsGraph_edge1" class="edge">
<title>proc~compute_gmbe&#45;&gt;abort_comm</title>
<path fill="none" stroke="#ff0000" d="M50.42,-468.18C55.31,-505.59 74.5,-620.64 132,-693 204.34,-784.03 246,-787.49 353,-833 372.42,-841.26 394.89,-847.33 414.47,-851.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="413.91,-855.06 424.41,-853.67 415.33,-848.2 413.91,-855.06"/>
</g>
<!-- cart_disp -->
<g id="proc~~compute_gmbe~~CallsGraph_node3" class="node">
<title>cart_disp</title>
<polygon fill="#777777" stroke="#777777" points="255,-314 194,-314 194,-290 255,-290 255,-314"/>
<text text-anchor="middle" x="224.5" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cart_disp</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;cart_disp -->
<g id="proc~~compute_gmbe~~CallsGraph_edge2" class="edge">
<title>proc~compute_gmbe&#45;&gt;cart_disp</title>
<path fill="none" stroke="#ff0000" d="M53.51,-443.68C63.5,-418.09 90.03,-359 132,-328 147.1,-316.85 166.84,-310.47 184.11,-306.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.76,-310.27 193.94,-304.99 183.47,-303.39 184.76,-310.27"/>
</g>
<!-- configuration -->
<g id="proc~~compute_gmbe~~CallsGraph_node4" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="266.5,-272 182.5,-272 182.5,-248 266.5,-248 266.5,-272"/>
<text text-anchor="middle" x="224.5" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;configuration -->
<g id="proc~~compute_gmbe~~CallsGraph_edge3" class="edge">
<title>proc~compute_gmbe&#45;&gt;configuration</title>
<path fill="none" stroke="#ff0000" d="M51.08,-443.55C57.16,-411.26 78,-324.38 132,-281 143.35,-271.88 157.92,-266.57 172.08,-263.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.05,-266.9 182.26,-261.67 171.8,-260.01 173.05,-266.9"/>
</g>
<!-- error -->
<g id="proc~~compute_gmbe~~CallsGraph_node5" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1057.5,-583 1003.5,-583 1003.5,-559 1057.5,-559 1057.5,-583"/>
<text text-anchor="middle" x="1030.5" y="-568.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge4" class="edge">
<title>proc~compute_gmbe&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M56.12,-443.96C68.61,-424.08 96.56,-384.93 132,-368 221.09,-325.43 479.77,-328.89 576,-351 750.72,-391.14 936.22,-507.93 1003.36,-552.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1001.79,-556.14 1012.03,-558.84 1005.71,-550.34 1001.79,-556.14"/>
</g>
<!-- fc_mdyne -->
<g id="proc~~compute_gmbe~~CallsGraph_node6" class="node">
<title>fc_mdyne</title>
<polygon fill="#777777" stroke="#777777" points="256.5,-230 192.5,-230 192.5,-206 256.5,-206 256.5,-230"/>
<text text-anchor="middle" x="224.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fc_mdyne</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;fc_mdyne -->
<g id="proc~~compute_gmbe~~CallsGraph_edge5" class="edge">
<title>proc~compute_gmbe&#45;&gt;fc_mdyne</title>
<path fill="none" stroke="#ff0000" d="M49.79,-443.94C52.89,-407.1 67.46,-295.1 132,-239 145.65,-227.14 164.66,-221.61 181.82,-219.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.65,-222.59 192.2,-218 181.87,-215.63 182.65,-222.59"/>
</g>
<!-- force_constants -->
<g id="proc~~compute_gmbe~~CallsGraph_node7" class="node">
<title>force_constants</title>
<polygon fill="#777777" stroke="#777777" points="272.5,-188 176.5,-188 176.5,-164 272.5,-164 272.5,-188"/>
<text text-anchor="middle" x="224.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">force_constants</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;force_constants -->
<g id="proc~~compute_gmbe~~CallsGraph_edge6" class="edge">
<title>proc~compute_gmbe&#45;&gt;force_constants</title>
<path fill="none" stroke="#ff0000" d="M48.95,-443.77C49.48,-402.32 57.07,-265.85 132,-197 141.47,-188.3 153.79,-182.97 166.32,-179.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.3,-183.12 176.35,-177.61 165.84,-176.28 167.3,-183.12"/>
</g>
<!-- frequencies -->
<g id="proc~~compute_gmbe~~CallsGraph_node8" class="node">
<title>frequencies</title>
<polygon fill="#777777" stroke="#777777" points="262,-146 187,-146 187,-122 262,-122 262,-146"/>
<text text-anchor="middle" x="224.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">frequencies</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;frequencies -->
<g id="proc~~compute_gmbe~~CallsGraph_edge7" class="edge">
<title>proc~compute_gmbe&#45;&gt;frequencies</title>
<path fill="none" stroke="#ff0000" d="M50.7,-443.68C58.04,-392.41 88.54,-196.61 132,-155 143.88,-143.63 160.61,-137.96 176.52,-135.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.35,-138.68 186.8,-133.89 176.42,-131.74 177.35,-138.68"/>
</g>
<!-- info -->
<g id="proc~~compute_gmbe~~CallsGraph_node9" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-1196 437.5,-1196 437.5,-1172 491.5,-1172 491.5,-1196"/>
<text text-anchor="middle" x="464.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;info -->
<g id="proc~~compute_gmbe~~CallsGraph_edge8" class="edge">
<title>proc~compute_gmbe&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M49.06,-468.16C49.66,-544.23 56.4,-954.31 132,-1048 187.01,-1116.17 246.46,-1064.06 317,-1116 338.19,-1131.6 330.6,-1149.19 353,-1163 375.1,-1176.62 404.05,-1181.76 426.77,-1183.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="426.85,-1187.06 437.04,-1184.17 427.27,-1180.08 426.85,-1187.06"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~compute_gmbe~~CallsGraph_node10" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node10"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-792 381.5,-792 381.5,-768 547.5,-768 547.5,-792"/>
<text text-anchor="middle" x="464.5" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_gmbe~~CallsGraph_edge9" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#ff0000" d="M52.88,-468.02C62.48,-496.36 89.72,-568.43 132,-615 210.81,-701.79 244.25,-715.23 353,-759 358.88,-761.37 365.06,-763.47 371.34,-765.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="370.73,-768.81 381.3,-768.1 372.59,-762.06 370.73,-768.81"/>
</g>
<!-- proc~compute_vibrational_analysis -->
<g id="proc~~compute_gmbe~~CallsGraph_node11" class="node">
<title>proc~compute_vibrational_analysis</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node11"><a xlink:href="../proc/compute_vibrational_analysis.html" xlink:title="compute_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="309.5,-1039 139.5,-1039 139.5,-1015 309.5,-1015 309.5,-1039"/>
<text text-anchor="middle" x="224.5" y="-1024.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~compute_vibrational_analysis -->
<g id="proc~~compute_gmbe~~CallsGraph_edge10" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~compute_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M50,-468.26C55.61,-535.31 84.71,-857.71 132,-944 146.88,-971.16 174.08,-994.08 194.97,-1008.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="193.26,-1011.98 203.48,-1014.76 197.22,-1006.21 193.26,-1011.98"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~compute_gmbe~~CallsGraph_node12" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node12"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="532.5,-106 396.5,-106 396.5,-82 532.5,-82 532.5,-106"/>
<text text-anchor="middle" x="464.5" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~energy_total -->
<g id="proc~~compute_gmbe~~CallsGraph_edge11" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#ff0000" d="M50.06,-443.7C55.17,-387.63 79.19,-157.06 132,-113 169.16,-81.99 300.21,-83.49 385.98,-88.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="386.02,-91.7 396.21,-88.78 386.42,-84.71 386.02,-91.7"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~compute_gmbe~~CallsGraph_node13" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node13"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="545,-586 384,-586 384,-562 545,-562 545,-586"/>
<text text-anchor="middle" x="464.5" y="-571.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~compute_gmbe~~CallsGraph_edge12" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#ff0000" d="M75.93,-468.16C92,-475.13 112.92,-483.71 132,-490 221.83,-519.62 328.25,-544.91 395.81,-559.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="395.38,-563.27 405.9,-561.99 396.88,-556.43 395.38,-563.27"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~compute_gmbe~~CallsGraph_node14" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node14"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="814.5,-582 675.5,-582 675.5,-558 814.5,-558 814.5,-582"/>
<text text-anchor="middle" x="745" y="-567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge13" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#ff0000" d="M89.22,-443.93C179.5,-418.98 403.86,-369.02 576,-431 642.37,-454.9 701.13,-517.66 728.2,-550.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="725.63,-552.43 734.68,-557.94 731.04,-547.99 725.63,-552.43"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_node15" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node15"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="576,-384 353,-384 353,-360 576,-360 576,-384"/>
<text text-anchor="middle" x="464.5" y="-369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_edge14" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#ff0000" d="M63.51,-443.93C79.29,-431.57 105.76,-412.93 132,-404 199.42,-381.06 278.69,-372.79 342.81,-370.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="343.09,-373.87 352.97,-370.04 342.86,-366.87 343.09,-373.87"/>
</g>
<!-- proc~print_gmbe_energy_breakdown -->
<g id="proc~~compute_gmbe~~CallsGraph_node16" class="node">
<title>proc~print_gmbe_energy_breakdown</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node16"><a xlink:href="../proc/print_gmbe_energy_breakdown.html" xlink:title="print_gmbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1149 134.5,-1149 134.5,-1125 314.5,-1125 314.5,-1149"/>
<text text-anchor="middle" x="224.5" y="-1134.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_gmbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~print_gmbe_energy_breakdown -->
<g id="proc~~compute_gmbe~~CallsGraph_edge15" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~print_gmbe_energy_breakdown</title>
<path fill="none" stroke="#ff0000" d="M48.93,-468.17C48.72,-548.05 51.15,-997.25 132,-1101 138.44,-1109.27 147.05,-1115.64 156.43,-1120.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="155.06,-1123.77 165.6,-1124.82 158.01,-1117.43 155.06,-1123.77"/>
</g>
<!-- proc~print_gmbe_gradient_info -->
<g id="proc~~compute_gmbe~~CallsGraph_node17" class="node">
<title>proc~print_gmbe_gradient_info</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node17"><a xlink:href="../proc/print_gmbe_gradient_info.html" xlink:title="print_gmbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="299,-1196 150,-1196 150,-1172 299,-1172 299,-1196"/>
<text text-anchor="middle" x="224.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_gmbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~print_gmbe_gradient_info -->
<g id="proc~~compute_gmbe~~CallsGraph_edge16" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~print_gmbe_gradient_info</title>
<path fill="none" stroke="#ff0000" d="M49.62,-468.01C54.32,-556.28 85.18,-1103.07 132,-1158 134.69,-1161.16 137.74,-1163.95 141.05,-1166.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.42,-1169.53 149.75,-1171.89 143.15,-1163.6 139.42,-1169.53"/>
</g>
<!-- proc~print_gmbe_intersection_debug -->
<g id="proc~~compute_gmbe~~CallsGraph_node18" class="node">
<title>proc~print_gmbe_intersection_debug</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node18"><a xlink:href="../proc/print_gmbe_intersection_debug.html" xlink:title="print_gmbe_intersection_debug">
<polygon fill="#d9534f" stroke="#d9534f" points="315,-66 134,-66 134,-42 315,-42 315,-66"/>
<text text-anchor="middle" x="224.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_gmbe_intersection_debug</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~print_gmbe_intersection_debug -->
<g id="proc~~compute_gmbe~~CallsGraph_edge17" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~print_gmbe_intersection_debug</title>
<path fill="none" stroke="#ff0000" d="M50.02,-443.98C55.17,-385.93 80.2,-134.98 132,-80 135.14,-76.66 138.68,-73.75 142.49,-71.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.29,-74.2 151.21,-66.17 140.8,-68.13 144.29,-74.2"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~compute_gmbe~~CallsGraph_node19" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node19"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="298.5,-935 150.5,-935 150.5,-911 298.5,-911 298.5,-935"/>
<text text-anchor="middle" x="224.5" y="-920.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_gmbe~~CallsGraph_edge18" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M49.54,-468.13C52.1,-515.93 65.87,-694.83 132,-822 149.15,-854.99 179.72,-885.53 200.78,-904.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.76,-907.08 208.6,-910.99 203.34,-901.8 198.76,-907.08"/>
</g>
<!-- proc~process_intersection_derivatives -->
<g id="proc~~compute_gmbe~~CallsGraph_node20" class="node">
<title>proc~process_intersection_derivatives</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node20"><a xlink:href="../proc/process_intersection_derivatives.html" xlink:title="process_intersection_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-606 132,-606 132,-582 317,-582 317,-606"/>
<text text-anchor="middle" x="224.5" y="-591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">process_intersection_derivatives</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~process_intersection_derivatives -->
<g id="proc~~compute_gmbe~~CallsGraph_edge19" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~process_intersection_derivatives</title>
<path fill="none" stroke="#ff0000" d="M54.68,-468.04C66.06,-490.86 93.88,-540.48 132,-567 138.4,-571.46 145.55,-575.19 152.95,-578.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="151.83,-581.63 162.42,-581.94 154.34,-575.09 151.83,-581.63"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~compute_gmbe~~CallsGraph_node21" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node21"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-506 387.5,-506 387.5,-482 541.5,-482 541.5,-506"/>
<text text-anchor="middle" x="464.5" y="-491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~compute_gmbe~~CallsGraph_edge20" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#ff0000" d="M96.34,-463.39C107.98,-465.06 120.42,-466.71 132,-468 215.09,-477.25 310.25,-484.36 377.24,-488.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="377.12,-492.28 387.33,-489.44 377.58,-485.3 377.12,-492.28"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~compute_gmbe~~CallsGraph_node22" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node22"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="536.5,-464 392.5,-464 392.5,-440 536.5,-440 536.5,-464"/>
<text text-anchor="middle" x="464.5" y="-449.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~compute_gmbe~~CallsGraph_edge21" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#ff0000" d="M96.14,-455.55C165.67,-454.87 296.67,-453.61 381.98,-452.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.19,-456.28 392.15,-452.69 382.12,-449.29 382.19,-456.28"/>
</g>
<!-- reduced_masses -->
<g id="proc~~compute_gmbe~~CallsGraph_node23" class="node">
<title>reduced_masses</title>
<polygon fill="#777777" stroke="#777777" points="275,-24 174,-24 174,0 275,0 275,-24"/>
<text text-anchor="middle" x="224.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduced_masses</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;reduced_masses -->
<g id="proc~~compute_gmbe~~CallsGraph_edge22" class="edge">
<title>proc~compute_gmbe&#45;&gt;reduced_masses</title>
<path fill="none" stroke="#ff0000" d="M49.65,-443.71C53.26,-380.67 72.77,-94.15 132,-33 140.5,-24.22 151.88,-18.78 163.71,-15.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="164.75,-18.84 173.71,-13.19 163.18,-12.01 164.75,-18.84"/>
</g>
<!-- to_char -->
<g id="proc~~compute_gmbe~~CallsGraph_node24" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1057.5,-1240 1003.5,-1240 1003.5,-1216 1057.5,-1216 1057.5,-1240"/>
<text text-anchor="middle" x="1030.5" y="-1225.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~compute_gmbe&#45;&gt;to_char -->
<g id="proc~~compute_gmbe~~CallsGraph_edge23" class="edge">
<title>proc~compute_gmbe&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M49.43,-468.01C52.87,-560 76.99,-1150.85 132,-1205 375.27,-1444.5 859.21,-1291.03 993.95,-1241.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="995.24,-1244.95 1003.4,-1238.19 992.81,-1238.38 995.24,-1244.95"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge29" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00ff16" d="M547.57,-775.76C558.14,-772.13 568.04,-766.78 576,-759 630.62,-705.64 556.58,-643.54 612,-591 626.34,-577.4 645.75,-570.53 665.26,-567.41"/>
<polygon fill="#00ff16" stroke="#00ff16" points="665.97,-570.85 675.45,-566.11 665.09,-563.9 665.97,-570.85"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~compute_gmbe~~CallsGraph_node26" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node26"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="804,-750 686,-750 686,-726 804,-726 804,-750"/>
<text text-anchor="middle" x="745" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~compute_gmbe~~CallsGraph_edge24" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#00ff16" d="M545.31,-767.96C586.56,-761.74 636.38,-754.23 675.82,-748.28"/>
<polygon fill="#00ff16" stroke="#00ff16" points="676.5,-751.72 685.87,-746.77 675.46,-744.8 676.5,-751.72"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~compute_gmbe~~CallsGraph_node29" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node29"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="829.5,-834 660.5,-834 660.5,-810 829.5,-810 829.5,-834"/>
<text text-anchor="middle" x="745" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~compute_gmbe~~CallsGraph_edge25" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#00ff16" d="M545.31,-792.04C579.25,-797.15 618.99,-803.15 653.97,-808.42"/>
<polygon fill="#00ff16" stroke="#00ff16" points="653.77,-811.93 664.18,-809.96 654.82,-805.01 653.77,-811.93"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~compute_gmbe~~CallsGraph_node30" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node30"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="813.5,-666 676.5,-666 676.5,-642 813.5,-642 813.5,-666"/>
<text text-anchor="middle" x="745" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~compute_gmbe~~CallsGraph_edge26" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#00ff16" d="M547.69,-773.84C557.93,-770.45 567.7,-765.67 576,-759 607.66,-733.56 579.96,-699.96 612,-675 627.43,-662.98 647.02,-656.6 666.34,-653.44"/>
<polygon fill="#00ff16" stroke="#00ff16" points="666.96,-656.89 676.4,-652.08 666.02,-649.96 666.96,-656.89"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~compute_gmbe~~CallsGraph_node36" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node36"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-624 681,-624 681,-600 809,-600 809,-624"/>
<text text-anchor="middle" x="745" y="-609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~compute_gmbe~~CallsGraph_edge27" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#00ff16" d="M547.67,-775.08C558.1,-771.53 567.93,-766.37 576,-759 619,-719.72 568.41,-671.63 612,-633 628.04,-618.78 649.69,-612.09 670.82,-609.35"/>
<polygon fill="#00ff16" stroke="#00ff16" points="671.2,-612.83 680.79,-608.33 670.48,-605.86 671.2,-612.83"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~compute_gmbe~~CallsGraph_node38" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node38"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="822,-792 668,-792 668,-768 822,-768 822,-792"/>
<text text-anchor="middle" x="745" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_gmbe~~CallsGraph_edge28" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#00ff16" d="M547.55,-780C582.16,-780 622.48,-780 657.55,-780"/>
<polygon fill="#00ff16" stroke="#00ff16" points="657.77,-783.5 667.77,-780 657.77,-776.5 657.77,-783.5"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~compute_gmbe~~CallsGraph_node40" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node40"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="878,-708 612,-708 612,-684 878,-684 878,-708"/>
<text text-anchor="middle" x="745" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~compute_gmbe~~CallsGraph_edge30" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#00ff16" d="M547.72,-770.86C557.62,-767.9 567.3,-764.04 576,-759 597.27,-746.68 590.54,-729 612,-717 615.34,-715.13 618.79,-713.42 622.33,-711.85"/>
<polygon fill="#00ff16" stroke="#00ff16" points="623.91,-714.99 631.89,-708.01 621.3,-708.49 623.91,-714.99"/>
</g>
<!-- proc~compute_cartesian_displacements -->
<g id="proc~~compute_gmbe~~CallsGraph_node31" class="node">
<title>proc~compute_cartesian_displacements</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node31"><a xlink:href="../proc/compute_cartesian_displacements.html" xlink:title="compute_cartesian_displacements">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-1162 646.5,-1162 646.5,-1138 843.5,-1138 843.5,-1162"/>
<text text-anchor="middle" x="745" y="-1147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_cartesian_displacements</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements -->
<g id="proc~~compute_gmbe~~CallsGraph_edge31" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements</title>
<path fill="none" stroke="#00ff58" d="M248.35,-1039.09C273.38,-1051.83 315.02,-1071.61 353,-1083 449.3,-1111.88 477.34,-1101.64 576,-1121 592.08,-1124.16 595.9,-1125.93 612,-1129 625.3,-1131.53 639.39,-1134 653.23,-1136.3"/>
<polygon fill="#00ff58" stroke="#00ff58" points="652.8,-1139.78 663.24,-1137.95 653.94,-1132.88 652.8,-1139.78"/>
</g>
<!-- proc~compute_force_constants -->
<g id="proc~~compute_gmbe~~CallsGraph_node32" class="node">
<title>proc~compute_force_constants</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node32"><a xlink:href="../proc/compute_force_constants.html" xlink:title="compute_force_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="538.5,-1074 390.5,-1074 390.5,-1050 538.5,-1050 538.5,-1074"/>
<text text-anchor="middle" x="464.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_force_constants</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants -->
<g id="proc~~compute_gmbe~~CallsGraph_edge32" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants</title>
<path fill="none" stroke="#00ff58" d="M307.41,-1039.05C330.94,-1042.51 356.62,-1046.28 380.23,-1049.75"/>
<polygon fill="#00ff58" stroke="#00ff58" points="379.81,-1053.23 390.21,-1051.22 380.83,-1046.3 379.81,-1053.23"/>
</g>
<!-- proc~compute_ir_intensities -->
<g id="proc~~compute_gmbe~~CallsGraph_node33" class="node">
<title>proc~compute_ir_intensities</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node33"><a xlink:href="../proc/compute_ir_intensities.html" xlink:title="compute_ir_intensities">
<polygon fill="#d9534f" stroke="#d9534f" points="811,-1120 679,-1120 679,-1096 811,-1096 811,-1120"/>
<text text-anchor="middle" x="745" y="-1105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ir_intensities</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_ir_intensities -->
<g id="proc~~compute_gmbe~~CallsGraph_edge33" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_ir_intensities</title>
<path fill="none" stroke="#00ff58" d="M284.79,-1014.96C357.7,-1003.26 483.18,-993.46 576,-1041 599.11,-1052.83 589.63,-1073.83 612,-1087 629.03,-1097.03 649.33,-1102.71 668.85,-1105.82"/>
<polygon fill="#00ff58" stroke="#00ff58" points="668.58,-1109.32 678.96,-1107.23 669.54,-1102.39 668.58,-1109.32"/>
</g>
<!-- proc~compute_reduced_masses -->
<g id="proc~~compute_gmbe~~CallsGraph_node34" class="node">
<title>proc~compute_reduced_masses</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node34"><a xlink:href="../proc/compute_reduced_masses.html" xlink:title="compute_reduced_masses">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1154 387.5,-1154 387.5,-1130 541.5,-1130 541.5,-1154"/>
<text text-anchor="middle" x="464.5" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_reduced_masses</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses -->
<g id="proc~~compute_gmbe~~CallsGraph_edge34" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses</title>
<path fill="none" stroke="#00ff58" d="M257.01,-1039.03C275.57,-1047.01 298.88,-1058.65 317,-1073 336.54,-1088.47 331.78,-1102.92 353,-1116 360.64,-1120.71 369.06,-1124.57 377.73,-1127.72"/>
<polygon fill="#00ff58" stroke="#00ff58" points="376.63,-1131.05 387.22,-1130.88 378.84,-1124.4 376.63,-1131.05"/>
</g>
<!-- proc~compute_vibrational_frequencies -->
<g id="proc~~compute_gmbe~~CallsGraph_node35" class="node">
<title>proc~compute_vibrational_frequencies</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node35"><a xlink:href="../proc/compute_vibrational_frequencies.html" xlink:title="compute_vibrational_frequencies">
<polygon fill="#d9534f" stroke="#d9534f" points="559.5,-994 369.5,-994 369.5,-970 559.5,-970 559.5,-994"/>
<text text-anchor="middle" x="464.5" y="-979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_frequencies</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies -->
<g id="proc~~compute_gmbe~~CallsGraph_edge35" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies</title>
<path fill="none" stroke="#00ff58" d="M288.97,-1015C320.04,-1009.12 357.63,-1002.02 389.95,-995.91"/>
<polygon fill="#00ff58" stroke="#00ff58" points="390.62,-999.34 399.8,-994.04 389.32,-992.46 390.62,-999.34"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~compute_gmbe~~CallsGraph_node42" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node42"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="820.5,-106 669.5,-106 669.5,-82 820.5,-82 820.5,-106"/>
<text text-anchor="middle" x="745" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~compute_gmbe~~CallsGraph_edge36" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#00ff9b" d="M532.56,-94C570.55,-94 618.44,-94 659.03,-94"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="659.18,-97.5 669.18,-94 659.18,-90.5 659.18,-97.5"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge37" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00ffdd" d="M545.31,-572.85C582.77,-572.32 627.3,-571.68 664.7,-571.14"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="665.1,-574.63 675.05,-570.99 665,-567.63 665.1,-574.63"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_node27" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node27"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="859.5,-304 630.5,-304 630.5,-280 859.5,-280 859.5,-304"/>
<text text-anchor="middle" x="745" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_edge38" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#009bff" d="M507.5,-359.94C556.89,-345.75 638.89,-322.19 692.19,-306.88"/>
<polygon fill="#009bff" stroke="#009bff" points="693.47,-310.16 702.12,-304.03 691.54,-303.43 693.47,-310.16"/>
</g>
<!-- proc~print_gmbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~compute_gmbe~~CallsGraph_edge39" class="edge">
<title>proc~print_gmbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#0058ff" d="M283.54,-1149.01C305.31,-1153.47 330.28,-1158.52 353,-1163 377.7,-1167.86 405.54,-1173.15 427.1,-1177.21"/>
<polygon fill="#0058ff" stroke="#0058ff" points="426.66,-1180.69 437.14,-1179.09 427.95,-1173.81 426.66,-1180.69"/>
</g>
<!-- proc~print_gmbe_gradient_info&#45;&gt;info -->
<g id="proc~~compute_gmbe~~CallsGraph_edge40" class="edge">
<title>proc~print_gmbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#0016ff" d="M299.17,-1184C341.67,-1184 393.24,-1184 427.14,-1184"/>
<polygon fill="#0016ff" stroke="#0016ff" points="427.49,-1187.5 437.49,-1184 427.49,-1180.5 427.49,-1187.5"/>
</g>
<!-- proc~print_gmbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~compute_gmbe~~CallsGraph_edge41" class="edge">
<title>proc~print_gmbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#0016ff" d="M288.52,-1196.04C309.01,-1199.5 331.9,-1202.91 353,-1205 596.68,-1229.11 891.88,-1229.21 993.27,-1228.41"/>
<polygon fill="#0016ff" stroke="#0016ff" points="993.33,-1231.91 1003.3,-1228.32 993.27,-1224.91 993.33,-1231.91"/>
</g>
<!-- proc~print_gmbe_intersection_debug&#45;&gt;proc~energy_total -->
<g id="proc~~compute_gmbe~~CallsGraph_edge43" class="edge">
<title>proc~print_gmbe_intersection_debug&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#2c00ff" d="M296.91,-66C325.08,-70.74 357.51,-76.19 386.23,-81.01"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="385.78,-84.49 396.22,-82.69 386.94,-77.58 385.78,-84.49"/>
</g>
<!-- debug -->
<g id="proc~~compute_gmbe~~CallsGraph_node25" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-64 437.5,-64 437.5,-40 491.5,-40 491.5,-64"/>
<text text-anchor="middle" x="464.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~print_gmbe_intersection_debug&#45;&gt;debug -->
<g id="proc~~compute_gmbe~~CallsGraph_edge42" class="edge">
<title>proc~print_gmbe_intersection_debug&#45;&gt;debug</title>
<path fill="none" stroke="#2c00ff" d="M315.14,-53.25C353.98,-52.92 397.28,-52.56 427.03,-52.31"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="427.37,-55.8 437.34,-52.22 427.31,-48.8 427.37,-55.8"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;info -->
<g id="proc~~compute_gmbe~~CallsGraph_edge44" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;info</title>
<path fill="none" stroke="#6e00ff" d="M244.8,-935.17C265.88,-949.5 299.01,-975.28 317,-1006 353.17,-1067.78 301.44,-1113.34 353,-1163 372.36,-1181.64 402.84,-1186.31 426.89,-1186.64"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="427.13,-1190.14 437.09,-1186.53 427.05,-1183.14 427.13,-1190.14"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~compute_gmbe~~CallsGraph_node37" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node37"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1112,-750 949,-750 949,-726 1112,-726 1112,-750"/>
<text text-anchor="middle" x="1030.5" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_gmbe~~CallsGraph_edge45" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#6e00ff" d="M298.74,-928.24C449.32,-937.53 787.14,-950.22 878,-885 911,-861.31 886.67,-831.04 914,-801 933.18,-779.91 961.11,-764.41 984.7,-754.06"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="986.31,-757.18 994.17,-750.08 983.6,-750.73 986.31,-757.18"/>
</g>
<!-- warning -->
<g id="proc~~compute_gmbe~~CallsGraph_node43" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="772.5,-876 717.5,-876 717.5,-852 772.5,-852 772.5,-876"/>
<text text-anchor="middle" x="745" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;warning -->
<g id="proc~~compute_gmbe~~CallsGraph_edge46" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;warning</title>
<path fill="none" stroke="#6e00ff" d="M298.69,-914.67C411.12,-901.88 622.24,-877.86 707.2,-868.19"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="707.85,-871.64 717.39,-867.03 707.06,-864.68 707.85,-871.64"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;abort_comm -->
<g id="proc~~compute_gmbe~~CallsGraph_edge47" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;abort_comm</title>
<path fill="none" stroke="#b100ff" d="M230.4,-606.22C248.45,-650.64 312.27,-802.6 353,-834 370.36,-847.38 393.49,-854.04 414.1,-857.3"/>
<polygon fill="#b100ff" stroke="#b100ff" points="413.91,-860.81 424.29,-858.67 414.85,-853.87 413.91,-860.81"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge48" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;error</title>
<path fill="none" stroke="#b100ff" d="M254.52,-581.94C279.97,-572.03 318.24,-558.73 353,-553 583.24,-515.07 645.27,-532.19 878,-549 917.6,-551.86 962.57,-558.87 993.16,-564.22"/>
<polygon fill="#b100ff" stroke="#b100ff" points="992.89,-567.73 1003.35,-566.03 994.12,-560.83 992.89,-567.73"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~compute_gmbe~~CallsGraph_edge50" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#b100ff" d="M317.18,-586.3C335.74,-584.74 355.24,-583.1 373.73,-581.54"/>
<polygon fill="#b100ff" stroke="#b100ff" points="374.22,-585.01 383.89,-580.69 373.63,-578.04 374.22,-585.01"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge51" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#b100ff" d="M317.08,-594.8C329.16,-594.89 341.38,-594.95 353,-595 452.11,-595.39 477.16,-602.31 576,-595 593.33,-593.72 630.32,-588.32 665.18,-582.86"/>
<polygon fill="#b100ff" stroke="#b100ff" points="666.09,-586.26 675.42,-581.25 665,-579.35 666.09,-586.26"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_edge53" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#b100ff" d="M232.45,-581.97C249.71,-552.92 297.16,-477.91 353,-431 374.27,-413.13 401.83,-398.4 424.1,-388.13"/>
<polygon fill="#b100ff" stroke="#b100ff" points="425.6,-391.29 433.29,-384.01 422.74,-384.91 425.6,-391.29"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~compute_gmbe~~CallsGraph_edge55" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#b100ff" d="M242.41,-581.99C266.07,-565.71 310.91,-536.74 353,-520 364.09,-515.59 376.11,-511.81 388.01,-508.61"/>
<polygon fill="#b100ff" stroke="#b100ff" points="389.13,-511.94 397.95,-506.06 387.39,-505.16 389.13,-511.94"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~compute_gmbe~~CallsGraph_edge56" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#b100ff" d="M234.46,-581.67C253.31,-556.71 299.77,-500.28 353,-473 362.15,-468.31 372.22,-464.66 382.43,-461.82"/>
<polygon fill="#b100ff" stroke="#b100ff" points="383.4,-465.19 392.24,-459.34 381.69,-458.4 383.4,-465.19"/>
</g>
<!-- proc~build_fragment_from_atom_list -->
<g id="proc~~compute_gmbe~~CallsGraph_node28" class="node">
<title>proc~build_fragment_from_atom_list</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node28"><a xlink:href="../proc/build_fragment_from_atom_list.html" xlink:title="build_fragment_from_atom_list">
<polygon fill="#d9534f" stroke="#d9534f" points="553,-666 376,-666 376,-642 553,-642 553,-666"/>
<text text-anchor="middle" x="464.5" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_atom_list</text>
</a>
</g>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~build_fragment_from_atom_list -->
<g id="proc~~compute_gmbe~~CallsGraph_edge49" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~build_fragment_from_atom_list</title>
<path fill="none" stroke="#b100ff" d="M269.38,-606.04C293.93,-612.69 325.11,-621 353,-628 368.45,-631.88 385.15,-635.89 400.78,-639.58"/>
<polygon fill="#b100ff" stroke="#b100ff" points="400.33,-643.07 410.87,-641.95 401.93,-636.26 400.33,-643.07"/>
</g>
<!-- proc~find_fragment_intersection -->
<g id="proc~~compute_gmbe~~CallsGraph_node39" class="node">
<title>proc~find_fragment_intersection</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node39"><a xlink:href="../proc/find_fragment_intersection.html" xlink:title="find_fragment_intersection">
<polygon fill="#d94e8f" stroke="#d94e8f" points="542.5,-708 386.5,-708 386.5,-684 542.5,-684 542.5,-708"/>
<text text-anchor="middle" x="464.5" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_fragment_intersection</text>
</a>
</g>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~find_fragment_intersection -->
<g id="proc~~compute_gmbe~~CallsGraph_edge52" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~find_fragment_intersection</title>
<path fill="none" stroke="#b100ff" d="M240.55,-606.29C263.4,-624.27 308.86,-657.53 353,-675 360.49,-677.96 368.43,-680.52 376.48,-682.72"/>
<polygon fill="#b100ff" stroke="#b100ff" points="375.79,-686.15 386.35,-685.23 377.52,-679.37 375.79,-686.15"/>
</g>
<!-- proc~get_monomer_atom_list -->
<g id="proc~~compute_gmbe~~CallsGraph_node41" class="node">
<title>proc~get_monomer_atom_list</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node41"><a xlink:href="../proc/get_monomer_atom_list.html" xlink:title="get_monomer_atom_list">
<polygon fill="#d9534f" stroke="#d9534f" points="535,-750 394,-750 394,-726 535,-726 535,-750"/>
<text text-anchor="middle" x="464.5" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_monomer_atom_list</text>
</a>
</g>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;proc~get_monomer_atom_list -->
<g id="proc~~compute_gmbe~~CallsGraph_edge54" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;proc~get_monomer_atom_list</title>
<path fill="none" stroke="#b100ff" d="M234.12,-606.15C252.69,-631.32 299.19,-689.15 353,-717 362.63,-721.98 373.27,-725.79 384.05,-728.7"/>
<polygon fill="#b100ff" stroke="#b100ff" points="383.4,-732.15 393.95,-731.13 385.07,-725.35 383.4,-732.15"/>
</g>
<!-- proc~process_intersection_derivatives&#45;&gt;warning -->
<g id="proc~~compute_gmbe~~CallsGraph_edge57" class="edge">
<title>proc~process_intersection_derivatives&#45;&gt;warning</title>
<path fill="none" stroke="#b100ff" d="M228.99,-606.09C240.18,-642.45 278.81,-751.35 353,-801 360.39,-805.95 611.45,-844.08 707.31,-858.5"/>
<polygon fill="#b100ff" stroke="#b100ff" points="707,-861.99 717.41,-860.02 708.04,-855.07 707,-861.99"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_node45" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node45"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1147,-304 914,-304 914,-280 1147,-280 1147,-304"/>
<text text-anchor="middle" x="1030.5" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_edge58" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#ffa100" d="M859.68,-292C874.2,-292 889.12,-292 903.82,-292"/>
<polygon fill="#ffa100" stroke="#ffa100" points="903.95,-295.5 913.95,-292 903.95,-288.5 903.95,-295.5"/>
</g>
<!-- proc~build_fragment_from_atom_list&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge63" class="edge">
<title>proc~build_fragment_from_atom_list&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#fff100" d="M542.25,-641.95C553.98,-638.42 565.62,-633.87 576,-628 595.97,-616.7 591.63,-601.56 612,-591 628.25,-582.57 647.02,-577.34 665.22,-574.14"/>
<polygon fill="#fff100" stroke="#fff100" points="665.91,-577.58 675.24,-572.57 664.82,-570.66 665.91,-577.58"/>
</g>
<!-- proc~build_fragment_from_atom_list&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~compute_gmbe~~CallsGraph_edge59" class="edge">
<title>proc~build_fragment_from_atom_list&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#fff100" d="M553.18,-664.87C561.16,-667.56 568.9,-670.89 576,-675 597.27,-687.32 590.54,-705 612,-717 631.23,-727.76 654.36,-733.42 675.84,-736.29"/>
<polygon fill="#fff100" stroke="#fff100" points="675.57,-739.79 685.91,-737.46 676.38,-732.83 675.57,-739.79"/>
</g>
<!-- proc~build_fragment_from_atom_list&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~compute_gmbe~~CallsGraph_edge60" class="edge">
<title>proc~build_fragment_from_atom_list&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#fff100" d="M553.24,-654C589.37,-654 630.89,-654 665.95,-654"/>
<polygon fill="#fff100" stroke="#fff100" points="666.13,-657.5 676.13,-654 666.13,-650.5 666.13,-657.5"/>
</g>
<!-- proc~build_fragment_from_atom_list&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~compute_gmbe~~CallsGraph_edge61" class="edge">
<title>proc~build_fragment_from_atom_list&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#fff100" d="M545.31,-641.96C584.85,-636 632.27,-628.85 670.86,-623.03"/>
<polygon fill="#fff100" stroke="#fff100" points="671.62,-626.46 680.98,-621.5 670.57,-619.53 671.62,-626.46"/>
</g>
<!-- proc~build_fragment_from_atom_list&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_gmbe~~CallsGraph_edge62" class="edge">
<title>proc~build_fragment_from_atom_list&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#fff100" d="M553.27,-662.17C561.47,-665.37 569.23,-669.56 576,-675 607.66,-700.44 579.96,-734.04 612,-759 625.11,-769.22 641.22,-775.36 657.63,-778.91"/>
<polygon fill="#fff100" stroke="#fff100" points="657.38,-782.42 667.85,-780.8 658.65,-775.54 657.38,-782.42"/>
</g>
<!-- proc~build_fragment_from_atom_list&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~compute_gmbe~~CallsGraph_edge64" class="edge">
<title>proc~build_fragment_from_atom_list&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#fff100" d="M545.31,-666.04C579.25,-671.15 618.99,-677.15 653.97,-682.42"/>
<polygon fill="#fff100" stroke="#fff100" points="653.77,-685.93 664.18,-683.96 654.82,-679.01 653.77,-685.93"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~compute_gmbe~~CallsGraph_node50" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node50"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1070,-834 991,-834 991,-810 1070,-810 1070,-834"/>
<text text-anchor="middle" x="1030.5" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~compute_gmbe~~CallsGraph_edge65" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#bbff00" d="M829.53,-822C878.76,-822 939.34,-822 980.84,-822"/>
<polygon fill="#bbff00" stroke="#bbff00" points="980.96,-825.5 990.96,-822 980.96,-818.5 980.96,-825.5"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge66" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#6bff00" d="M813.8,-646.28C834.61,-643.09 857.44,-638.76 878,-633 919.86,-621.28 965.78,-601.43 995.96,-587.35"/>
<polygon fill="#6bff00" stroke="#6bff00" points="997.63,-590.43 1005.19,-583 994.65,-584.1 997.63,-590.43"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~compute_gmbe~~CallsGraph_edge69" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#6bff00" d="M813.71,-648.73C837.24,-650.62 861.78,-657.45 878,-675 946.69,-749.32 868.11,-1038.8 914,-1129 932.4,-1165.16 970.31,-1193.58 997.69,-1210.52"/>
<polygon fill="#6bff00" stroke="#6bff00" points="996.15,-1213.68 1006.53,-1215.82 999.75,-1207.67 996.15,-1213.68"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_gmbe~~CallsGraph_edge67" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#6bff00" d="M813.82,-661.65C834.63,-664.84 857.46,-669.18 878,-675 920.04,-686.9 966.1,-707.16 996.26,-721.49"/>
<polygon fill="#6bff00" stroke="#6bff00" points="994.94,-724.74 1005.47,-725.91 997.97,-718.43 994.94,-724.74"/>
</g>
<!-- proc~error_set -->
<g id="proc~~compute_gmbe~~CallsGraph_node47" class="node">
<title>proc~error_set</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node47"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1083,-666 978,-666 978,-642 1083,-642 1083,-666"/>
<text text-anchor="middle" x="1030.5" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~compute_gmbe~~CallsGraph_edge68" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#6bff00" d="M813.55,-654C860.44,-654 922.43,-654 967.96,-654"/>
<polygon fill="#6bff00" stroke="#6bff00" points="967.99,-657.5 977.99,-654 967.99,-650.5 967.99,-657.5"/>
</g>
<!-- proc~element_mass -->
<g id="proc~~compute_gmbe~~CallsGraph_node46" class="node">
<title>proc~element_mass</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node46"><a xlink:href="../proc/element_mass.html" xlink:title="element_mass">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1075.5,-1120 985.5,-1120 985.5,-1096 1075.5,-1096 1075.5,-1120"/>
<text text-anchor="middle" x="1030.5" y="-1105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_mass</text>
</a>
</g>
</g>
<!-- proc~compute_cartesian_displacements&#45;&gt;proc~element_mass -->
<g id="proc~~compute_gmbe~~CallsGraph_edge70" class="edge">
<title>proc~compute_cartesian_displacements&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#1aff00" d="M827.24,-1137.96C874.7,-1130.93 933.31,-1122.25 975.2,-1116.05"/>
<polygon fill="#1aff00" stroke="#1aff00" points="975.82,-1119.49 985.2,-1114.56 974.8,-1112.57 975.82,-1119.49"/>
</g>
<!-- proc~compute_ir_intensities&#45;&gt;proc~element_mass -->
<g id="proc~~compute_gmbe~~CallsGraph_edge71" class="edge">
<title>proc~compute_ir_intensities&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#00ff86" d="M811.04,-1108C860.74,-1108 928.44,-1108 975.24,-1108"/>
<polygon fill="#00ff86" stroke="#00ff86" points="975.48,-1111.5 985.48,-1108 975.48,-1104.5 975.48,-1111.5"/>
</g>
<!-- proc~compute_reduced_masses&#45;&gt;proc~element_mass -->
<g id="proc~~compute_gmbe~~CallsGraph_edge72" class="edge">
<title>proc~compute_reduced_masses&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#00ffd6" d="M530.72,-1154.05C545.61,-1156.9 561.37,-1159.98 576,-1163 592.05,-1166.31 595.71,-1169.21 612,-1171 729.52,-1183.9 762.07,-1194.14 878,-1171 921.86,-1162.24 968.91,-1140.53 998.73,-1125.05"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="1000.58,-1128.03 1007.79,-1120.26 997.31,-1121.84 1000.58,-1128.03"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;error -->
<g id="proc~~compute_gmbe~~CallsGraph_edge73" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;error</title>
<path fill="none" stroke="#00d6ff" d="M535.53,-969.95C647.06,-950.12 854.88,-910.28 878,-885 954.36,-801.52 849.19,-725.73 914,-633 932.84,-606.04 967.23,-589.76 993.6,-580.69"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="994.82,-583.97 1003.26,-577.56 992.67,-577.31 994.82,-583.97"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;warning -->
<g id="proc~~compute_gmbe~~CallsGraph_edge77" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;warning</title>
<path fill="none" stroke="#00d6ff" d="M487.02,-969.89C509.54,-957.04 545.76,-935.9 576,-916 592.49,-905.15 593.9,-897.87 612,-890 642.54,-876.73 680.01,-870.17 707.21,-866.97"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="707.89,-870.42 717.46,-865.87 707.14,-863.46 707.89,-870.42"/>
</g>
<!-- pic_syev -->
<g id="proc~~compute_gmbe~~CallsGraph_node44" class="node">
<title>pic_syev</title>
<polygon fill="#777777" stroke="#777777" points="774,-994 716,-994 716,-970 774,-970 774,-994"/>
<text text-anchor="middle" x="745" y="-979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_syev</text>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;pic_syev -->
<g id="proc~~compute_gmbe~~CallsGraph_edge74" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;pic_syev</title>
<path fill="none" stroke="#00d6ff" d="M559.79,-982C609.63,-982 668.07,-982 705.54,-982"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="706,-985.5 716,-982 706,-978.5 706,-985.5"/>
</g>
<!-- proc~mass_weight_hessian -->
<g id="proc~~compute_gmbe~~CallsGraph_node48" class="node">
<title>proc~mass_weight_hessian</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node48"><a xlink:href="../proc/mass_weight_hessian.html" xlink:title="mass_weight_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="808.5,-1078 681.5,-1078 681.5,-1054 808.5,-1054 808.5,-1078"/>
<text text-anchor="middle" x="745" y="-1063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mass_weight_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian -->
<g id="proc~~compute_gmbe~~CallsGraph_edge75" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian</title>
<path fill="none" stroke="#00d6ff" d="M542.25,-994.05C553.98,-997.58 565.62,-1002.13 576,-1008 595.97,-1019.3 591.63,-1034.44 612,-1045 630.06,-1054.37 651.24,-1059.78 671.27,-1062.85"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="670.93,-1066.34 681.31,-1064.21 671.87,-1059.4 670.93,-1066.34"/>
</g>
<!-- proc~project_translation_rotation -->
<g id="proc~~compute_gmbe~~CallsGraph_node49" class="node">
<title>proc~project_translation_rotation</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node49"><a xlink:href="../proc/project_translation_rotation.html" xlink:title="project_translation_rotation">
<polygon fill="#d9534f" stroke="#d9534f" points="824,-1036 666,-1036 666,-1012 824,-1012 824,-1036"/>
<text text-anchor="middle" x="745" y="-1021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">project_translation_rotation</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation -->
<g id="proc~~compute_gmbe~~CallsGraph_edge76" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation</title>
<path fill="none" stroke="#00d6ff" d="M545.31,-994.04C579.69,-999.22 620.02,-1005.3 655.33,-1010.63"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="655.21,-1014.15 665.62,-1012.18 656.26,-1007.23 655.21,-1014.15"/>
</g>
<!-- proc~cgto_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_node52" class="node">
<title>proc~cgto_destroy</title>
<g id="a_proc~~compute_gmbe~~CallsGraph_node52"><a xlink:href="../proc/cgto_destroy.html" xlink:title="cgto_type%cgto_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1325,-304 1183,-304 1183,-280 1325,-280 1325,-304"/>
<text text-anchor="middle" x="1254" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cgto_type%cgto_destroy</text>
</a>
</g>
</g>
<!-- proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy -->
<g id="proc~~compute_gmbe~~CallsGraph_edge78" class="edge">
<title>proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy</title>
<path fill="none" stroke="#ffda00" d="M1147.12,-292C1155.77,-292 1164.38,-292 1172.74,-292"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1172.79,-295.5 1182.79,-292 1172.79,-288.5 1172.79,-295.5"/>
</g>
<!-- proc~mass_weight_hessian&#45;&gt;proc~element_mass -->
<g id="proc~~compute_gmbe~~CallsGraph_edge79" class="edge">
<title>proc~mass_weight_hessian&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#0091ff" d="M808.57,-1075.27C858.39,-1082.65 927.44,-1092.88 975.02,-1099.93"/>
<polygon fill="#0091ff" stroke="#0091ff" points="974.73,-1103.42 985.13,-1101.43 975.75,-1096.5 974.73,-1103.42"/>
</g>
<!-- proc~project_translation_rotation&#45;&gt;proc~element_mass -->
<g id="proc~~compute_gmbe~~CallsGraph_edge81" class="edge">
<title>proc~project_translation_rotation&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#4800ff" d="M824.14,-1033.3C842.02,-1036.29 860.81,-1040.13 878,-1045 920.04,-1056.9 966.1,-1077.16 996.26,-1091.49"/>
<polygon fill="#4800ff" stroke="#4800ff" points="994.94,-1094.74 1005.47,-1095.91 997.97,-1088.43 994.94,-1094.74"/>
</g>
<!-- pic_gesvd -->
<g id="proc~~compute_gmbe~~CallsGraph_node51" class="node">
<title>pic_gesvd</title>
<polygon fill="#777777" stroke="#777777" points="1063,-1036 998,-1036 998,-1012 1063,-1012 1063,-1036"/>
<text text-anchor="middle" x="1030.5" y="-1021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_gesvd</text>
</g>
<!-- proc~project_translation_rotation&#45;&gt;pic_gesvd -->
<g id="proc~~compute_gmbe~~CallsGraph_edge80" class="edge">
<title>proc~project_translation_rotation&#45;&gt;pic_gesvd</title>
<path fill="none" stroke="#4800ff" d="M824.22,-1024C877.06,-1024 944.75,-1024 987.64,-1024"/>
<polygon fill="#4800ff" stroke="#4800ff" points="987.72,-1027.5 997.72,-1024 987.72,-1020.5 987.72,-1027.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_gmbeCallsGraph = svgPanZoom('#proccompute_gmbeCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_grad~2"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_grad</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_hess~2"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_hess</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_log_level~7"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_log_level</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-error~48"></span>
              type(<a href='../type/error_t.html'>error_t</a>),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>error</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment~27"></span>
              type(<a href='../type/physical_fragment_t.html'>physical_fragment_t</a>),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-has_intersections~2"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>has_intersections</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hess_dim~5"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>hess_dim</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~55"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~14"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-level_counts~2"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>level_counts</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-level_energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>level_energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~14"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-monomer_energy~2"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>monomer_energy</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-monomer_idx"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>monomer_idx</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sign_factor~2"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sign_factor</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">compute_gmbe</span><span class="p">(</span><span class="n">monomers</span><span class="p">,</span><span class="w"> </span><span class="n">n_monomers</span><span class="p">,</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">n_intersections</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">intersection_sets</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Compute generalized many-body expansion (GMBE) energy with optional gradient and/or hessian</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! This is the core routine that handles all GMBE computations using</span>
<span class="w">      </span><span class="c">!! the inclusion-exclusion principle for overlapping fragments.</span>
<span class="w">      </span><span class="c">!! Optional arguments control what derivatives are computed:</span>
<span class="w">      </span><span class="c">!!   - If sys_geom and total_gradient are present: compute gradient</span>
<span class="w">      </span><span class="c">!!   - If total_hessian is also present: compute hessian</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_result_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculation_result_t</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_physical_fragment</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">build_fragment_from_indices</span><span class="p">,</span><span class="w"> </span><span class="n">build_fragment_from_atom_list</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                       </span><span class="n">redistribute_cap_gradients</span><span class="p">,</span><span class="w"> </span><span class="n">redistribute_cap_hessian</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_gmbe_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">find_fragment_intersection</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_config_parser</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">bond_t</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_error</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">error_t</span>

<span class="w">      </span><span class="c">! Required arguments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">monomers</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_monomers</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_intersections</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">intersection_results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">intersection_sets</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">intersection_levels</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_energy</span>

<span class="w">      </span><span class="c">! Optional arguments for gradient computation</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">      </span><span class="c">! Optional arguments for hessian computation</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">      </span><span class="c">! Optional bond information for hydrogen cap handling</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span>

<span class="w">      </span><span class="c">! Optional MPI communicator for abort</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span>

<span class="w">      </span><span class="c">! Local variables</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">monomer_energy</span><span class="p">,</span><span class="w"> </span><span class="n">sign_factor</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">level_energies</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">level_counts</span><span class="p">(:)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">physical_fragment_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">error_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">error</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">monomer_idx</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">compute_grad</span><span class="p">,</span><span class="w"> </span><span class="n">compute_hess</span><span class="p">,</span><span class="w"> </span><span class="n">has_intersections</span>

<span class="w">      </span><span class="c">! Determine what to compute based on optional arguments</span>
<span class="w">      </span><span class="n">compute_grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">total_gradient</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_hess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_grad</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">total_hessian</span><span class="p">)</span>
<span class="w">      </span><span class="n">has_intersections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_intersections</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">intersection_results</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="nb">present</span><span class="p">(</span><span class="n">intersection_sets</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">intersection_levels</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Initialize outputs</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">hess_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Sum monomer energies (and gradients/hessians if requested)</span>
<span class="w">      </span><span class="n">monomer_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n_monomers</span>
<span class="w">         </span><span class="n">monomer_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomer_energy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">energy</span><span class="p">%</span><span class="n">total</span><span class="p">()</span>

<span class="w">         </span><span class="c">! Accumulate monomer derivatives if requested</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_gradient</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">monomer_idx</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">monomer_idx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomers</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">build_fragment_from_indices</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">monomer_idx</span><span class="p">,</span><span class="w"> </span><span class="n">fragment</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">%</span><span class="n">has_error</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="n">error</span><span class="p">%</span><span class="n">get_full_trace</span><span class="p">())</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Failed to build monomer fragment in GMBE&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">            call </span><span class="n">redistribute_cap_gradients</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_hessian</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">redistribute_cap_hessian</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span><span class="w"> </span><span class="n">monomer_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            call </span><span class="n">fragment</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">monomer_idx</span><span class="p">)</span>
<span class="w">         </span><span class="k">end if</span>
<span class="k">      end do</span>

<span class="w">      </span><span class="c">! Start with monomer contribution</span>
<span class="w">      </span><span class="n">total_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomer_energy</span>

<span class="w">      </span><span class="c">! Handle intersections with inclusion-exclusion</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_intersections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">max_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">intersection_levels</span><span class="p">)</span>

<span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">level_energies</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">level_counts</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">         </span><span class="n">level_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">level_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">         </span><span class="c">! Process intersection energies and derivatives</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n_intersections</span>
<span class="w">            </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intersection_levels</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="n">sign_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="n">level_energies</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level_energies</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">intersection_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">energy</span><span class="p">%</span><span class="n">total</span><span class="p">()</span>
<span class="w">            </span><span class="n">level_counts</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level_counts</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="c">! Handle intersection derivatives if requested</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">intersection_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_gradient</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="p">(</span><span class="n">compute_hess</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">intersection_results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_hessian</span><span class="p">)))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">process_intersection_derivatives</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">sign_factor</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                     </span><span class="n">intersection_sets</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                     </span><span class="n">compute_grad</span><span class="p">,</span><span class="w"> </span><span class="n">compute_hess</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>

<span class="w">         </span><span class="c">! Apply inclusion-exclusion to energy</span>
<span class="w">         </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">level_counts</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">sign_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">dp</span><span class="p">)</span>
<span class="w">               </span><span class="n">total_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_energy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sign_factor</span><span class="o">*</span><span class="n">level_energies</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>

<span class="w">         </span><span class="c">! Print energy breakdown</span>
<span class="w">         </span><span class="k">call </span><span class="n">print_gmbe_energy_breakdown</span><span class="p">(</span><span class="n">monomer_energy</span><span class="p">,</span><span class="w"> </span><span class="n">n_monomers</span><span class="p">,</span><span class="w"> </span><span class="n">level_energies</span><span class="p">,</span><span class="w"> </span><span class="n">level_counts</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                          </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="w">         </span><span class="c">! Print debug info for intersections</span>
<span class="w">         </span><span class="k">call </span><span class="n">print_gmbe_intersection_debug</span><span class="p">(</span><span class="n">n_intersections</span><span class="p">,</span><span class="w"> </span><span class="n">n_monomers</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_sets</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">intersection_levels</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_results</span><span class="p">)</span>

<span class="w">         </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">level_energies</span><span class="p">,</span><span class="w"> </span><span class="n">level_counts</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span><span class="c">! No intersections - just print monomer sum</span>
<span class="w">         </span><span class="k">call </span><span class="n">print_gmbe_energy_breakdown</span><span class="p">(</span><span class="n">monomer_energy</span><span class="p">,</span><span class="w"> </span><span class="n">n_monomers</span><span class="p">,</span><span class="w"> </span><span class="n">level_energies</span><span class="p">,</span><span class="w"> </span><span class="n">level_counts</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                          </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print gradient/hessian info</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">configuration</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">print_gmbe_gradient_info</span><span class="p">(</span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GMBE Hessian computation completed&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Total Hessian Frobenius norm: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">total_hessian</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span>

<span class="w">         </span><span class="c">! Compute and print full vibrational analysis</span>
<span class="w">         </span><span class="k">block</span>
<span class="k">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">frequencies</span><span class="p">(:),</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">(:),</span><span class="w"> </span><span class="n">force_constants</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Computing vibrational analysis (projecting trans/rot modes)...&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_vibrational_analysis</span><span class="p">(</span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">project_trans_rot</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">frequencies</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">print_vibrational_analysis</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                               </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                               </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">               </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end block</span>
<span class="k">      end if</span>

<span class="k">   end subroutine </span><span class="n">compute_gmbe</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-10 12:44 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>