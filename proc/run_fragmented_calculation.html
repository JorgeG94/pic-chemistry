<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>run_fragmented_calculation &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>run_fragmented_calculation
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 3.0% of total for procedures.">73 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_driver.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_driver.f90.html'>mqc_driver.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_driver.html'>mqc_driver</a></li>
            <li class="breadcrumb-item active" aria-current="page">run_fragmented_calculation</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-all_node_leader_ranks">all_node_leader_ranks</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-global_node_rank">global_node_rank</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-i~14">i</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-j~5">j</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-monomers">monomers</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-n_expected_frags">n_expected_frags</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-n_rows">n_rows</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-node_leader_ranks">node_leader_ranks</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-num_nodes">num_nodes</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-polymers~4">polymers</a>
            <a class="list-group-item" href="../proc/run_fragmented_calculation.html#variable-total_fragments">total_fragments</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/run_fragmented_calculation.html#src">run_fragmented_calculation</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine run_fragmented_calculation(world_comm, node_comm, method, sys_geom, max_level, matrix_size)  
</h2>
    

    <p>Handle fragmented calculation (nlevel &gt; 0)</p>
<p>Generates fragments, distributes work across MPI processes organized in nodes,
and coordinates many-body expansion calculation using hierarchical parallelism.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~3"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                <p>Global MPI communicator</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_comm~2"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_comm</strong></td>
            <td>
                <p>Node-local MPI communicator</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-method~3"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>method</strong></td>
            <td>
                <p>Quantum chemistry method (gfn1/gfn2)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~5"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                <p>System geometry and fragment info</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                <p>Maximum fragment level for MBE</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-matrix_size~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>matrix_size</strong></td>
            <td>
                <p>Size of gradient matrix (natoms*3)</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~run_fragmented_calculation~~CallsGraph Pages: 1 -->
<svg id="procrun_fragmented_calculationCallsGraph" width="641pt" height="763pt"
 viewBox="0.00 0.00 641.00 763.14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~run_fragmented_calculation~~CallsGraph" class="graph" transform="scale(0.47 0.47) rotate(0) translate(4 1633)">
<title>proc~~run_fragmented_calculation~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1633 1371,-1633 1371,4 -4,4"/>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node1" class="node">
<title>proc~run_fragmented_calculation</title>
<polygon fill="none" stroke="black" points="163,-939 0,-939 0,-915 163,-915 163,-939"/>
<text text-anchor="middle" x="81.5" y="-924.6" font-family="Helvetica,sans-Serif" font-size="10.50">run_fragmented_calculation</text>
</g>
<!-- allgather -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node2" class="node">
<title>allgather</title>
<polygon fill="#777777" stroke="#777777" points="306.5,-1525 245.5,-1525 245.5,-1501 306.5,-1501 306.5,-1525"/>
<text text-anchor="middle" x="276" y="-1510.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allgather</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;allgather -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge1" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;allgather</title>
<path fill="none" stroke="#ff0000" d="M83.32,-939.21C88.57,-1013.77 119.79,-1407.36 199,-1492 208.39,-1502.04 222.11,-1507.43 235.31,-1510.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="234.78,-1513.74 245.23,-1512 235.97,-1506.84 234.78,-1513.74"/>
</g>
<!-- bcast -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node3" class="node">
<title>bcast</title>
<polygon fill="#777777" stroke="#777777" points="303,-1483 249,-1483 249,-1459 303,-1459 303,-1483"/>
<text text-anchor="middle" x="276" y="-1468.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bcast</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;bcast -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge2" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;bcast</title>
<path fill="none" stroke="#ff0000" d="M83.54,-939.22C89.84,-1010.52 125.13,-1372.3 199,-1450 209.25,-1460.78 224.48,-1466.19 238.63,-1468.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="238.24,-1472.33 248.65,-1470.34 239.27,-1465.41 238.24,-1472.33"/>
</g>
<!-- info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node4" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="1092,-546 1038,-546 1038,-522 1092,-522 1092,-546"/>
<text text-anchor="middle" x="1065" y="-531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge3" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M82.72,-914.9C84.5,-832.49 99.09,-354.31 199,-260 260.82,-201.65 304.13,-242.9 389,-238 487.95,-232.29 522.9,-194.59 612,-238 635.34,-249.37 626.92,-268.84 648,-284 746.37,-354.75 805.48,-305.88 905,-375 925.47,-389.22 923.9,-399.86 941,-418 974.97,-454.04 1017.6,-492.97 1042.71,-515.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1040.41,-517.95 1050.22,-521.97 1045.05,-512.72 1040.41,-517.95"/>
</g>
<!-- leader -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node5" class="node">
<title>leader</title>
<polygon fill="#777777" stroke="#777777" points="303,-1399 249,-1399 249,-1375 303,-1375 303,-1399"/>
<text text-anchor="middle" x="276" y="-1384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leader</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;leader -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge4" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;leader</title>
<path fill="none" stroke="#ff0000" d="M84.11,-939.31C92.76,-1003.8 135.76,-1302.11 199,-1366 209.46,-1376.57 224.73,-1381.95 238.84,-1384.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="238.41,-1388.12 248.83,-1386.16 239.47,-1381.2 238.41,-1388.12"/>
</g>
<!-- omp_get_max_threads -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node6" class="node">
<title>omp_get_max_threads</title>
<polygon fill="#777777" stroke="#777777" points="567,-313 434,-313 434,-289 567,-289 567,-313"/>
<text text-anchor="middle" x="500.5" y="-298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omp_get_max_threads</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;omp_get_max_threads -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge5" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;omp_get_max_threads</title>
<path fill="none" stroke="#ff0000" d="M82.12,-914.63C80.92,-855.49 82.79,-597.88 199,-440 252.59,-367.2 353.74,-331.39 423.79,-314.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="424.94,-317.92 433.9,-312.25 423.36,-311.1 424.94,-317.92"/>
</g>
<!-- omp_set_num_threads -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node7" class="node">
<title>omp_set_num_threads</title>
<polygon fill="#777777" stroke="#777777" points="566.5,-271 434.5,-271 434.5,-247 566.5,-247 566.5,-271"/>
<text text-anchor="middle" x="500.5" y="-256.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omp_set_num_threads</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;omp_set_num_threads -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge6" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;omp_set_num_threads</title>
<path fill="none" stroke="#ff0000" d="M83.2,-914.68C87.8,-837.63 116.24,-422.51 199,-333 255.98,-271.37 355.33,-257.4 424.12,-255.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="424.51,-259.37 434.46,-255.73 424.41,-252.37 424.51,-259.37"/>
</g>
<!-- proc~create_monomer_list -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node8" class="node">
<title>proc~create_monomer_list</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node8"><a xlink:href="../proc/create_monomer_list.html" xlink:title="create_monomer_list">
<polygon fill="#d9534f" stroke="#d9534f" points="338,-981 214,-981 214,-957 338,-957 338,-981"/>
<text text-anchor="middle" x="276" y="-966.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_monomer_list</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~create_monomer_list -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge7" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~create_monomer_list</title>
<path fill="none" stroke="#ff0000" d="M137.66,-939.04C160.22,-943.96 186.47,-949.69 209.96,-954.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.31,-958.25 219.83,-956.96 210.81,-951.41 209.31,-958.25"/>
</g>
<!-- proc~generate_fragment_list -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node9" class="node">
<title>proc~generate_fragment_list</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node9"><a xlink:href="../proc/generate_fragment_list.html" xlink:title="generate_fragment_list">
<polygon fill="#d9534f" stroke="#d9534f" points="344,-1441 208,-1441 208,-1417 344,-1417 344,-1441"/>
<text text-anchor="middle" x="276" y="-1426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">generate_fragment_list</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~generate_fragment_list -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge8" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~generate_fragment_list</title>
<path fill="none" stroke="#ff0000" d="M83.78,-939.12C91.17,-1006.77 130.41,-1337.18 199,-1408 200.07,-1409.11 201.2,-1410.16 202.37,-1411.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="200.48,-1414.11 210.68,-1416.97 204.5,-1408.37 200.48,-1414.11"/>
</g>
<!-- proc~get_nfrags -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node10" class="node">
<title>proc~get_nfrags</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node10"><a xlink:href="../proc/get_nfrags.html" xlink:title="get_nfrags">
<polygon fill="#d94e8f" stroke="#d94e8f" points="310.5,-1357 241.5,-1357 241.5,-1333 310.5,-1333 310.5,-1357"/>
<text text-anchor="middle" x="276" y="-1342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nfrags</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~get_nfrags -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge9" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~get_nfrags</title>
<path fill="none" stroke="#ff0000" d="M82.12,-939.13C81.15,-992.81 84.59,-1211.38 199,-1324 207.77,-1332.63 219.74,-1337.79 231.59,-1340.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="230.93,-1344.29 241.44,-1342.96 232.4,-1337.44 230.93,-1344.29"/>
</g>
<!-- proc~global_coordinator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node11" class="node">
<title>proc~global_coordinator</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node11"><a xlink:href="../proc/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="332.5,-939 219.5,-939 219.5,-915 332.5,-915 332.5,-939"/>
<text text-anchor="middle" x="276" y="-924.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~global_coordinator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge10" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M163.02,-927C178.42,-927 194.38,-927 209.25,-927"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.35,-930.5 219.35,-927 209.35,-923.5 209.35,-930.5"/>
</g>
<!-- proc~node_coordinator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node12" class="node">
<title>proc~node_coordinator</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node12"><a xlink:href="../proc/node_coordinator.html" xlink:title="node_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="329.5,-1315 222.5,-1315 222.5,-1291 329.5,-1291 329.5,-1315"/>
<text text-anchor="middle" x="276" y="-1300.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">node_coordinator</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~node_coordinator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge11" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~node_coordinator</title>
<path fill="none" stroke="#ff0000" d="M88.69,-939.08C116.29,-993 228.39,-1211.96 264.05,-1281.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="261.07,-1283.47 268.74,-1290.77 267.3,-1280.28 261.07,-1283.47"/>
</g>
<!-- proc~node_worker -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node13" class="node">
<title>proc~node_worker</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node13"><a xlink:href="../proc/node_worker.html" xlink:title="node_worker">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-880 235,-880 235,-856 317,-856 317,-880"/>
<text text-anchor="middle" x="276" y="-865.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">node_worker</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~node_worker -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge12" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~node_worker</title>
<path fill="none" stroke="#ff0000" d="M121.92,-914.92C152.02,-905.69 193.69,-892.92 225.95,-883.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="227.1,-886.34 235.63,-880.07 225.05,-879.65 227.1,-886.34"/>
</g>
<!-- proc~serial_fragment_processor -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node14" class="node">
<title>proc~serial_fragment_processor</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node14"><a xlink:href="../proc/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="353,-473 199,-473 199,-449 353,-449 353,-473"/>
<text text-anchor="middle" x="276" y="-458.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;proc~serial_fragment_processor -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge13" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;proc~serial_fragment_processor</title>
<path fill="none" stroke="#ff0000" d="M87.65,-914.54C113.85,-851.1 232.47,-563.97 266.09,-482.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="269.34,-483.87 269.92,-473.29 262.87,-481.19 269.34,-483.87"/>
</g>
<!-- to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node15" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1092,-409 1038,-409 1038,-385 1092,-385 1092,-409"/>
<text text-anchor="middle" x="1065" y="-394.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge14" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M82.55,-914.75C83.17,-829.22 91.38,-321.72 199,-225 315.72,-120.1 778.44,-149.2 905,-242 938.08,-266.26 913.73,-296.35 941,-327 964.78,-353.73 1001.3,-372.7 1028.38,-384.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1027.3,-387.43 1037.89,-387.94 1029.93,-380.94 1027.3,-387.43"/>
</g>
<!-- verbose -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node16" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="1092.5,-997 1037.5,-997 1037.5,-973 1092.5,-973 1092.5,-997"/>
<text text-anchor="middle" x="1065" y="-982.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;verbose -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge15" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;verbose</title>
<path fill="none" stroke="#ff0000" d="M94.73,-914.75C114.56,-895.85 155.88,-860.38 199,-847 264.37,-826.72 284.62,-843.97 353,-847 468.45,-852.12 520.02,-800.03 612,-870 648.27,-897.59 611.15,-939.2 648,-966 707.76,-1009.46 937.3,-995.63 1027.4,-988.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1027.75,-991.77 1037.43,-987.45 1027.17,-984.8 1027.75,-991.77"/>
</g>
<!-- proc~combine -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node25" class="node">
<title>proc~combine</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node25"><a xlink:href="../proc/combine.html" xlink:title="combine">
<polygon fill="#d9534f" stroke="#d9534f" points="530,-1611 471,-1611 471,-1587 530,-1587 530,-1611"/>
<text text-anchor="middle" x="500.5" y="-1596.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">combine</text>
</a>
</g>
</g>
<!-- proc~generate_fragment_list&#45;&gt;proc~combine -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge16" class="edge">
<title>proc~generate_fragment_list&#45;&gt;proc~combine</title>
<path fill="none" stroke="#00ffcb" d="M341.18,-1441.17C345.49,-1443.61 349.51,-1446.52 353,-1450 394.88,-1491.69 345.45,-1538.06 389,-1578 408.18,-1595.59 437.34,-1600.56 460.89,-1601.28"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="460.9,-1604.78 470.92,-1601.34 460.95,-1597.78 460.9,-1604.78"/>
</g>
<!-- proc~binomial -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node23" class="node">
<title>proc~binomial</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node23"><a xlink:href="../proc/binomial.html" xlink:title="binomial">
<polygon fill="#d94e8f" stroke="#d94e8f" points="530,-1569 471,-1569 471,-1545 530,-1545 530,-1569"/>
<text text-anchor="middle" x="500.5" y="-1554.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">binomial</text>
</a>
</g>
</g>
<!-- proc~get_nfrags&#45;&gt;proc~binomial -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge17" class="edge">
<title>proc~get_nfrags&#45;&gt;proc~binomial</title>
<path fill="none" stroke="#00cbff" d="M310.53,-1346.63C325.46,-1349.08 342.08,-1354.47 353,-1366 404.6,-1420.51 336.36,-1477.5 389,-1531 407.54,-1549.85 436.99,-1556.08 460.83,-1557.75"/>
<polygon fill="#00cbff" stroke="#00cbff" points="460.84,-1561.25 470.99,-1558.21 461.16,-1554.26 460.84,-1561.25"/>
</g>
<!-- proc~global_coordinator&#45;&gt;info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge21" class="edge">
<title>proc~global_coordinator&#45;&gt;info</title>
<path fill="none" stroke="#0066ff" d="M315.23,-915C393.09,-889.96 566.56,-831 612,-789 637.98,-764.98 619.49,-738.95 648,-718 741.33,-649.43 810.44,-741.85 905,-675 931.97,-655.94 918.21,-633.9 941,-610 965.99,-583.79 1001.88,-562.98 1028.45,-549.81"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1030.29,-552.81 1037.78,-545.31 1027.25,-546.51 1030.29,-552.81"/>
</g>
<!-- proc~global_coordinator&#45;&gt;to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge30" class="edge">
<title>proc~global_coordinator&#45;&gt;to_char</title>
<path fill="none" stroke="#0066ff" d="M314.79,-914.85C328.36,-908.89 342.81,-900.47 353,-889 384.37,-853.69 354.98,-821.77 389,-789 463.91,-716.84 525.63,-775.96 612,-718 632.7,-704.11 626.14,-686.97 648,-675 749.02,-619.71 817.91,-717.34 905,-642 950.02,-603.06 910.22,-563.95 941,-513 966.03,-471.56 1009.87,-435.37 1037.88,-414.86"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1039.95,-417.69 1046.03,-409.01 1035.87,-412 1039.95,-417.69"/>
</g>
<!-- proc~global_coordinator&#45;&gt;verbose -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge31" class="edge">
<title>proc~global_coordinator&#45;&gt;verbose</title>
<path fill="none" stroke="#0066ff" d="M332.55,-924.32C415.19,-921.3 565.75,-919.8 612,-946 636.78,-960.04 622.84,-985.67 648,-999 748.94,-1052.46 790.89,-1004.01 905,-999 946.91,-997.16 994.86,-992.6 1027.04,-989.18"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1027.75,-992.62 1037.32,-988.07 1027,-985.66 1027.75,-992.62"/>
</g>
<!-- debug -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node17" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="803.5,-957 749.5,-957 749.5,-933 803.5,-933 803.5,-957"/>
<text text-anchor="middle" x="776.5" y="-942.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~global_coordinator&#45;&gt;debug -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge18" class="edge">
<title>proc~global_coordinator&#45;&gt;debug</title>
<path fill="none" stroke="#0066ff" d="M332.7,-918.65C350.63,-916.34 370.62,-914.14 389,-913 487.92,-906.84 513.98,-898.36 612,-913 628.55,-915.47 631.71,-920.19 648,-924 678.53,-931.14 713.72,-936.75 739.39,-940.36"/>
<polygon fill="#0066ff" stroke="#0066ff" points="739.03,-943.85 749.42,-941.74 739.99,-936.91 739.03,-943.85"/>
</g>
<!-- error -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node18" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1092,-1157 1038,-1157 1038,-1133 1092,-1133 1092,-1157"/>
<text text-anchor="middle" x="1065" y="-1142.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~global_coordinator&#45;&gt;error -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge19" class="edge">
<title>proc~global_coordinator&#45;&gt;error</title>
<path fill="none" stroke="#0066ff" d="M332.87,-934.77C340.4,-937.87 347.44,-942.15 353,-948 403.81,-1001.46 332.92,-1062.1 389,-1110 485.56,-1192.48 901.35,-1160.51 1027.55,-1148.66"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1028.2,-1152.11 1037.83,-1147.68 1027.54,-1145.14 1028.2,-1152.11"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node19" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="829.5,-473 723.5,-473 723.5,-449 829.5,-449 829.5,-473"/>
<text text-anchor="middle" x="776.5" y="-458.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~global_coordinator&#45;&gt;get_elapsed_time -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge20" class="edge">
<title>proc~global_coordinator&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#0066ff" d="M318.47,-914.86C331.44,-909.06 344.56,-900.74 353,-889 420.08,-795.72 308.05,-714.54 389,-633 459.59,-561.9 536.07,-665.37 612,-600 653.55,-564.23 606.74,-518.11 648,-482 665.72,-466.49 690.34,-460.17 713.23,-458.11"/>
<polygon fill="#0066ff" stroke="#0066ff" points="713.5,-461.6 723.25,-457.46 713.04,-454.61 713.5,-461.6"/>
</g>
<!-- iprobe -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node20" class="node">
<title>iprobe</title>
<polygon fill="#777777" stroke="#777777" points="527.5,-1295 473.5,-1295 473.5,-1271 527.5,-1271 527.5,-1295"/>
<text text-anchor="middle" x="500.5" y="-1280.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iprobe</text>
</g>
<!-- proc~global_coordinator&#45;&gt;iprobe -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge22" class="edge">
<title>proc~global_coordinator&#45;&gt;iprobe</title>
<path fill="none" stroke="#0066ff" d="M332.65,-933.96C340.41,-937.15 347.57,-941.66 353,-948 442.98,-1052.98 297.02,-1153.77 389,-1257 407.36,-1277.6 438.68,-1283.44 463.3,-1284.51"/>
<polygon fill="#0066ff" stroke="#0066ff" points="463.32,-1288.01 473.39,-1284.71 463.46,-1281.01 463.32,-1288.01"/>
</g>
<!-- irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node21" class="node">
<title>irecv</title>
<polygon fill="#777777" stroke="#777777" points="803.5,-1294 749.5,-1294 749.5,-1270 803.5,-1270 803.5,-1294"/>
<text text-anchor="middle" x="776.5" y="-1279.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">irecv</text>
</g>
<!-- proc~global_coordinator&#45;&gt;irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge23" class="edge">
<title>proc~global_coordinator&#45;&gt;irecv</title>
<path fill="none" stroke="#0066ff" d="M332.83,-934.29C340.46,-937.45 347.54,-941.86 353,-948 422.66,-1026.27 318.79,-1103.21 389,-1181 436.23,-1233.33 652.14,-1266.23 739.08,-1277.57"/>
<polygon fill="#0066ff" stroke="#0066ff" points="738.89,-1281.08 749.26,-1278.88 739.79,-1274.13 738.89,-1281.08"/>
</g>
<!-- isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node22" class="node">
<title>isend</title>
<polygon fill="#777777" stroke="#777777" points="803.5,-1075 749.5,-1075 749.5,-1051 803.5,-1051 803.5,-1075"/>
<text text-anchor="middle" x="776.5" y="-1060.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isend</text>
</g>
<!-- proc~global_coordinator&#45;&gt;isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge24" class="edge">
<title>proc~global_coordinator&#45;&gt;isend</title>
<path fill="none" stroke="#0066ff" d="M332.68,-936.08C340.06,-939.02 347.1,-942.89 353,-948 383.1,-974.05 356.63,-1006.84 389,-1030 444.41,-1069.65 653.69,-1067.24 738.99,-1064.48"/>
<polygon fill="#0066ff" stroke="#0066ff" points="739.35,-1067.97 749.23,-1064.13 739.11,-1060.98 739.35,-1067.97"/>
</g>
<!-- proc~compute_mbe_energy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node26" class="node">
<title>proc~compute_mbe_energy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node26"><a xlink:href="../proc/compute_mbe_energy.html" xlink:title="compute_mbe_energy">
<polygon fill="#d9534f" stroke="#d9534f" points="566.5,-709 434.5,-709 434.5,-685 566.5,-685 566.5,-709"/>
<text text-anchor="middle" x="500.5" y="-694.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_energy</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe_energy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge25" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe_energy</title>
<path fill="none" stroke="#0066ff" d="M316.01,-914.88C329.4,-908.99 343.41,-900.6 353,-889 390.65,-843.45 352.77,-807.69 389,-761 405.9,-739.22 432.46,-723.5 455.31,-713.09"/>
<polygon fill="#0066ff" stroke="#0066ff" points="456.73,-716.28 464.5,-709.08 453.93,-709.87 456.73,-716.28"/>
</g>
<!-- proc~result_irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node29" class="node">
<title>proc~result_irecv</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node29"><a xlink:href="../proc/result_irecv.html" xlink:title="result_irecv">
<polygon fill="#d9534f" stroke="#d9534f" points="537,-1375 464,-1375 464,-1351 537,-1351 537,-1375"/>
<text text-anchor="middle" x="500.5" y="-1360.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">result_irecv</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~result_irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge26" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~result_irecv</title>
<path fill="none" stroke="#0066ff" d="M332.74,-933.88C340.48,-937.09 347.61,-941.62 353,-948 404.29,-1008.77 344.72,-1237.95 389,-1304 404.17,-1326.62 430.94,-1341.23 454.34,-1350.25"/>
<polygon fill="#0066ff" stroke="#0066ff" points="453.18,-1353.56 463.77,-1353.67 455.56,-1346.98 453.18,-1353.56"/>
</g>
<!-- proc~send_fragment_to_node -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node31" class="node">
<title>proc~send_fragment_to_node</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node31"><a xlink:href="../proc/send_fragment_to_node.html" xlink:title="send_fragment_to_node">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-1021 430,-1021 430,-997 571,-997 571,-1021"/>
<text text-anchor="middle" x="500.5" y="-1006.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_node</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_node -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge27" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_node</title>
<path fill="none" stroke="#0066ff" d="M332.54,-938.33C339.7,-940.93 346.71,-944.11 353,-948 373.34,-960.58 368.16,-976.26 389,-988 398.51,-993.36 409.13,-997.37 419.93,-1000.38"/>
<polygon fill="#0066ff" stroke="#0066ff" points="419.32,-1003.84 429.87,-1002.87 421.02,-997.05 419.32,-1003.84"/>
</g>
<!-- proc~send_fragment_to_worker -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node32" class="node">
<title>proc~send_fragment_to_worker</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node32"><a xlink:href="../proc/send_fragment_to_worker.html" xlink:title="send_fragment_to_worker">
<polygon fill="#d9534f" stroke="#d9534f" points="576,-979 425,-979 425,-955 576,-955 576,-979"/>
<text text-anchor="middle" x="500.5" y="-964.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_worker</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge28" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker</title>
<path fill="none" stroke="#0066ff" d="M332.57,-936.99C359.75,-941.88 392.9,-947.84 422.47,-953.15"/>
<polygon fill="#0066ff" stroke="#0066ff" points="421.89,-956.6 432.35,-954.93 423.13,-949.71 421.89,-956.6"/>
</g>
<!-- start -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node34" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="803.5,-515 749.5,-515 749.5,-491 803.5,-491 803.5,-515"/>
<text text-anchor="middle" x="776.5" y="-500.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~global_coordinator&#45;&gt;start -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge29" class="edge">
<title>proc~global_coordinator&#45;&gt;start</title>
<path fill="none" stroke="#0066ff" d="M317.89,-914.9C330.98,-909.08 344.31,-900.74 353,-889 410.13,-811.84 321.9,-744.67 389,-676 459.55,-603.81 536.54,-700.04 612,-633 651.4,-597.99 607.6,-553.85 648,-520 673.04,-499.02 711.11,-496.46 739.13,-498.13"/>
<polygon fill="#0066ff" stroke="#0066ff" points="739.08,-501.64 749.33,-498.95 739.64,-494.66 739.08,-501.64"/>
</g>
<!-- proc~node_coordinator&#45;&gt;to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge39" class="edge">
<title>proc~node_coordinator&#45;&gt;to_char</title>
<path fill="none" stroke="#0000ff" d="M329.78,-1310.09C338.36,-1313.23 346.54,-1317.68 353,-1324 392.8,-1362.94 344.33,-1410.76 389,-1444 481.62,-1512.91 830.19,-1471.92 905,-1384 967.77,-1310.23 900.8,-601.12 941,-513 960.76,-469.68 1004.87,-434.68 1034.53,-414.86"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1036.76,-417.58 1043.23,-409.2 1032.94,-411.72 1036.76,-417.58"/>
</g>
<!-- proc~node_coordinator&#45;&gt;error -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge32" class="edge">
<title>proc~node_coordinator&#45;&gt;error</title>
<path fill="none" stroke="#0000ff" d="M329.82,-1309.52C338.51,-1312.7 346.71,-1317.32 353,-1324 405.66,-1379.9 329.31,-1444.68 389,-1493 433.56,-1529.07 856.77,-1523.99 905,-1493 1022.3,-1417.63 1054.14,-1231.91 1061.8,-1167.46"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1065.31,-1167.54 1062.93,-1157.21 1058.35,-1166.77 1065.31,-1167.54"/>
</g>
<!-- proc~node_coordinator&#45;&gt;iprobe -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge33" class="edge">
<title>proc~node_coordinator&#45;&gt;iprobe</title>
<path fill="none" stroke="#0000ff" d="M329.73,-1298.26C370.9,-1294.56 427.02,-1289.52 463.26,-1286.26"/>
<polygon fill="#0000ff" stroke="#0000ff" points="463.73,-1289.73 473.38,-1285.35 463.1,-1282.76 463.73,-1289.73"/>
</g>
<!-- proc~node_coordinator&#45;&gt;irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge34" class="edge">
<title>proc~node_coordinator&#45;&gt;irecv</title>
<path fill="none" stroke="#0000ff" d="M329.75,-1311.91C338.05,-1314.86 346.13,-1318.78 353,-1324 377.76,-1342.82 361.94,-1368.68 389,-1384 475.25,-1432.83 521.96,-1425.41 612,-1384 634.34,-1373.73 628.44,-1356.9 648,-1342 676.08,-1320.61 713.01,-1304.27 739.89,-1294.09"/>
<polygon fill="#0000ff" stroke="#0000ff" points="741.13,-1297.36 749.3,-1290.61 738.71,-1290.79 741.13,-1297.36"/>
</g>
<!-- proc~node_coordinator&#45;&gt;isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge35" class="edge">
<title>proc~node_coordinator&#45;&gt;isend</title>
<path fill="none" stroke="#0000ff" d="M329.54,-1311.09C413.04,-1322.67 570.84,-1338.98 612,-1304 687.5,-1239.85 577.98,-1154.1 648,-1084 671.51,-1060.46 710.56,-1057.15 739.27,-1058.53"/>
<polygon fill="#0000ff" stroke="#0000ff" points="739.11,-1062.02 749.32,-1059.22 739.59,-1055.04 739.11,-1062.02"/>
</g>
<!-- proc~node_coordinator&#45;&gt;proc~result_irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge36" class="edge">
<title>proc~node_coordinator&#45;&gt;proc~result_irecv</title>
<path fill="none" stroke="#0000ff" d="M322.98,-1315.09C332.92,-1317.88 343.35,-1320.93 353,-1324 369.21,-1329.16 372.69,-1332.15 389,-1337 410.17,-1343.29 433.98,-1349.06 454.06,-1353.55"/>
<polygon fill="#0000ff" stroke="#0000ff" points="453.37,-1356.98 463.89,-1355.72 454.88,-1350.15 453.37,-1356.98"/>
</g>
<!-- proc~result_isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node30" class="node">
<title>proc~result_isend</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node30"><a xlink:href="../proc/result_isend.html" xlink:title="result_isend">
<polygon fill="#d9534f" stroke="#d9534f" points="538.5,-1101 462.5,-1101 462.5,-1077 538.5,-1077 538.5,-1101"/>
<text text-anchor="middle" x="500.5" y="-1086.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">result_isend</text>
</a>
</g>
</g>
<!-- proc~node_coordinator&#45;&gt;proc~result_isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge37" class="edge">
<title>proc~node_coordinator&#45;&gt;proc~result_isend</title>
<path fill="none" stroke="#0000ff" d="M289.6,-1290.88C326.46,-1255.43 434.3,-1151.71 479.35,-1108.38"/>
<polygon fill="#0000ff" stroke="#0000ff" points="481.98,-1110.71 486.76,-1101.25 477.13,-1105.66 481.98,-1110.71"/>
</g>
<!-- recv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node33" class="node">
<title>recv</title>
<polygon fill="#777777" stroke="#777777" points="803.5,-1375 749.5,-1375 749.5,-1351 803.5,-1351 803.5,-1375"/>
<text text-anchor="middle" x="776.5" y="-1360.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">recv</text>
</g>
<!-- proc~node_coordinator&#45;&gt;recv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge38" class="edge">
<title>proc~node_coordinator&#45;&gt;recv</title>
<path fill="none" stroke="#0000ff" d="M329.72,-1310.72C338.21,-1313.79 346.37,-1318.07 353,-1324 385.1,-1352.73 353.33,-1389.85 389,-1414 501.41,-1490.1 674.92,-1415.65 744.79,-1379.84"/>
<polygon fill="#0000ff" stroke="#0000ff" points="746.7,-1382.8 753.95,-1375.07 743.46,-1376.59 746.7,-1382.8"/>
</g>
<!-- proc~node_worker&#45;&gt;irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge40" class="edge">
<title>proc~node_worker&#45;&gt;irecv</title>
<path fill="none" stroke="#6500ff" d="M317.05,-879.79C330.38,-885.62 344.09,-894.06 353,-906 408.05,-979.8 329.79,-1039.5 389,-1110 456.81,-1190.75 516.07,-1147.22 612,-1191 660.96,-1213.34 715.01,-1244.87 747.07,-1264.34"/>
<polygon fill="#6500ff" stroke="#6500ff" points="745.54,-1267.51 755.9,-1269.74 749.19,-1261.54 745.54,-1267.51"/>
</g>
<!-- proc~node_worker&#45;&gt;isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge41" class="edge">
<title>proc~node_worker&#45;&gt;isend</title>
<path fill="none" stroke="#6500ff" d="M317.09,-868.18C383.98,-870.35 520.05,-882.9 612,-946 635.48,-962.11 626.59,-980.23 648,-999 675.04,-1022.7 712.41,-1040.1 739.7,-1050.73"/>
<polygon fill="#6500ff" stroke="#6500ff" points="738.67,-1054.08 749.27,-1054.33 741.15,-1047.53 738.67,-1054.08"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node24" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node24"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="583.5,-591 417.5,-591 417.5,-567 583.5,-567 583.5,-591"/>
<text text-anchor="middle" x="500.5" y="-576.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~node_worker&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge42" class="edge">
<title>proc~node_worker&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#6500ff" d="M278.34,-855.8C283.64,-813.8 306.99,-674.03 389,-605 394.7,-600.2 401.13,-596.25 407.94,-593.01"/>
<polygon fill="#6500ff" stroke="#6500ff" points="409.59,-596.11 417.45,-589.01 406.87,-589.66 409.59,-596.11"/>
</g>
<!-- proc~do_fragment_work -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node27" class="node">
<title>proc~do_fragment_work</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node27"><a xlink:href="../proc/do_fragment_work.html" xlink:title="do_fragment_work">
<polygon fill="#d9534f" stroke="#d9534f" points="556.5,-473 444.5,-473 444.5,-449 556.5,-449 556.5,-473"/>
<text text-anchor="middle" x="500.5" y="-458.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">do_fragment_work</text>
</a>
</g>
</g>
<!-- proc~node_worker&#45;&gt;proc~do_fragment_work -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge43" class="edge">
<title>proc~node_worker&#45;&gt;proc~do_fragment_work</title>
<path fill="none" stroke="#6500ff" d="M279.13,-855.75C287.21,-812 319.04,-660.59 389,-558 411.39,-525.17 447.4,-496.41 472.19,-478.9"/>
<polygon fill="#6500ff" stroke="#6500ff" points="474.22,-481.75 480.45,-473.19 470.24,-475.99 474.22,-481.75"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node28" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node28"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="612,-393 389,-393 389,-369 612,-369 612,-393"/>
<text text-anchor="middle" x="500.5" y="-378.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~node_worker&#45;&gt;proc~fragment_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge44" class="edge">
<title>proc~node_worker&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#6500ff" d="M276.82,-855.94C276.6,-801.45 282.41,-575.05 389,-440 404.61,-420.22 428.72,-406.26 450.44,-396.9"/>
<polygon fill="#6500ff" stroke="#6500ff" points="451.96,-400.07 459.9,-393.05 449.31,-393.59 451.96,-400.07"/>
</g>
<!-- proc~node_worker&#45;&gt;proc~result_isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge45" class="edge">
<title>proc~node_worker&#45;&gt;proc~result_isend</title>
<path fill="none" stroke="#6500ff" d="M315.96,-880.16C329.34,-886.06 343.37,-894.44 353,-906 389.74,-950.08 352.85,-985.43 389,-1030 405.48,-1050.32 430.88,-1064.57 453.17,-1073.97"/>
<polygon fill="#6500ff" stroke="#6500ff" points="451.91,-1077.24 462.5,-1077.71 454.52,-1070.74 451.91,-1077.24"/>
</g>
<!-- proc~node_worker&#45;&gt;recv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge46" class="edge">
<title>proc~node_worker&#45;&gt;recv</title>
<path fill="none" stroke="#6500ff" d="M317.29,-879.61C330.64,-885.43 344.31,-893.9 353,-906 420.54,-1000.03 319.15,-1071.67 389,-1164 454.32,-1250.33 524.66,-1198.03 612,-1262 631.56,-1276.33 628.62,-1288.42 648,-1303 676.2,-1324.22 713.12,-1340.58 739.96,-1350.82"/>
<polygon fill="#6500ff" stroke="#6500ff" points="738.77,-1354.11 749.36,-1354.31 741.21,-1347.55 738.77,-1354.11"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge48" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;info</title>
<path fill="none" stroke="#cc00ff" d="M339.74,-448.95C355.79,-445.95 373.02,-442.79 389,-440 446.44,-429.96 589.88,-402.68 648,-398 761.85,-388.83 797.85,-358.43 905,-398 937.63,-410.05 1010.42,-480.19 1045.03,-514.75"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1042.65,-517.33 1052.19,-521.95 1047.61,-512.39 1042.65,-517.33"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;omp_get_max_threads -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge49" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;omp_get_max_threads</title>
<path fill="none" stroke="#cc00ff" d="M288.4,-448.74C303.55,-432.3 330.98,-402.03 353,-375 369.84,-354.33 366.68,-341.6 389,-327 399.54,-320.11 411.71,-315.03 424.03,-311.3"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="425.2,-314.61 433.92,-308.59 423.35,-307.86 425.2,-314.61"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;omp_set_num_threads -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge50" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;omp_set_num_threads</title>
<path fill="none" stroke="#cc00ff" d="M280.66,-448.89C291.31,-415.82 325.66,-323.54 389,-280 399.48,-272.8 411.77,-267.9 424.28,-264.6"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="425.37,-267.94 434.33,-262.29 423.79,-261.12 425.37,-267.94"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge56" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;to_char</title>
<path fill="none" stroke="#cc00ff" d="M295.09,-448.91C311.08,-437.84 334.64,-420.55 353,-403 371.02,-385.78 366.42,-370.55 389,-360 410.38,-350.01 860.99,-360.24 905,-365 947.69,-369.62 995.94,-380.09 1027.98,-387.8"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1027.24,-391.23 1037.78,-390.2 1028.9,-384.43 1027.24,-391.23"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;get_elapsed_time -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge47" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#cc00ff" d="M329.98,-473.02C348.54,-476.67 369.6,-480.2 389,-482 487.69,-491.17 513.09,-488.33 612,-482 645.61,-479.85 682.88,-475.24 713.33,-470.88"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="713.99,-474.32 723.38,-469.42 712.98,-467.4 713.99,-474.32"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge51" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#cc00ff" d="M288.13,-473.22C306.93,-493.08 347.05,-532.25 389,-553 397.88,-557.39 407.53,-561.06 417.3,-564.12"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="416.52,-567.54 427.1,-566.98 418.48,-560.82 416.52,-567.54"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~compute_mbe_energy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge52" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~compute_mbe_energy</title>
<path fill="none" stroke="#cc00ff" d="M285.65,-473.1C303.64,-497.97 346.96,-556.15 389,-600 417.16,-629.38 453.1,-659.78 476.21,-678.54"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="474.12,-681.36 484.11,-684.9 478.51,-675.9 474.12,-681.36"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~do_fragment_work -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge53" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~do_fragment_work</title>
<path fill="none" stroke="#cc00ff" d="M353.26,-461C379.58,-461 408.8,-461 434.16,-461"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="434.41,-464.5 444.41,-461 434.41,-457.5 434.41,-464.5"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~fragment_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge54" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#cc00ff" d="M298.7,-448.78C320.83,-436.74 356.44,-418.52 389,-407 401.36,-402.62 414.76,-398.77 427.83,-395.45"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="428.85,-398.81 437.73,-393.03 427.18,-392.01 428.85,-398.81"/>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;start -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge55" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;start</title>
<path fill="none" stroke="#cc00ff" d="M304.44,-473.04C326.73,-482.15 359.24,-493.93 389,-499 516.15,-520.66 670.26,-512.05 739.16,-506.41"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="739.8,-509.87 749.47,-505.54 739.21,-502.9 739.8,-509.87"/>
</g>
<!-- proc~combine_util -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node37" class="node">
<title>proc~combine_util</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node37"><a xlink:href="../proc/combine_util.html" xlink:title="combine_util">
<polygon fill="#d9534f" stroke="#d9534f" points="817,-1611 736,-1611 736,-1587 817,-1587 817,-1611"/>
<text text-anchor="middle" x="776.5" y="-1596.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">combine_util</text>
</a>
</g>
</g>
<!-- proc~combine&#45;&gt;proc~combine_util -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge57" class="edge">
<title>proc~combine&#45;&gt;proc~combine_util</title>
<path fill="none" stroke="#00ffa9" d="M530.05,-1599C576.24,-1599 667.97,-1599 725.28,-1599"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="725.56,-1602.5 735.56,-1599 725.56,-1595.5 725.56,-1602.5"/>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge61" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;info</title>
<path fill="none" stroke="#00ffff" d="M566.78,-691.35C582.81,-687.47 599.06,-681.17 612,-671 639.81,-649.13 619.4,-620.83 648,-600 655.73,-594.37 928.37,-553.91 1028.01,-539.27"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1028.53,-542.73 1037.92,-537.81 1027.51,-535.8 1028.53,-542.73"/>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge69" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;to_char</title>
<path fill="none" stroke="#00ffff" d="M566.53,-693.08C583.03,-689.25 599.58,-682.53 612,-671 650.95,-634.86 607.24,-591.08 648,-557 736.35,-483.14 798.97,-568.93 905,-524 964.17,-498.93 1019.53,-445.37 1046.62,-416.46"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1049.29,-418.73 1053.49,-409 1044.14,-413.99 1049.29,-418.73"/>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;debug -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge59" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;debug</title>
<path fill="none" stroke="#00ffff" d="M566.68,-699.69C583.48,-703.48 600.14,-710.48 612,-723 674.42,-788.88 583.38,-860.28 648,-924 671.69,-947.36 710.71,-950.7 739.36,-949.38"/>
<polygon fill="#00ffff" stroke="#00ffff" points="739.65,-952.87 749.4,-948.71 739.19,-945.88 739.65,-952.87"/>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;get_elapsed_time -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge60" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#00ffff" d="M537.32,-684.93C561.93,-674.82 593.4,-657.98 612,-633 653.2,-577.66 597.52,-529.03 648,-482 665.37,-465.82 690.17,-459.42 713.29,-457.49"/>
<polygon fill="#00ffff" stroke="#00ffff" points="713.63,-460.98 723.41,-456.91 713.23,-453.99 713.63,-460.98"/>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;start -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge68" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;start</title>
<path fill="none" stroke="#00ffff" d="M566.69,-693.62C583.29,-689.79 599.84,-682.95 612,-671 658.43,-625.36 600.89,-573.94 648,-529 672.06,-506.05 710.6,-500.89 739.02,-500.66"/>
<polygon fill="#00ffff" stroke="#00ffff" points="739.32,-504.16 749.37,-500.78 739.41,-497.16 739.32,-504.16"/>
</g>
<!-- configuration -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node35" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="818.5,-431 734.5,-431 734.5,-407 818.5,-407 818.5,-431"/>
<text text-anchor="middle" x="776.5" y="-416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;configuration -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge58" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;configuration</title>
<path fill="none" stroke="#00ffff" d="M521.7,-685C546.92,-668.92 589.45,-637.97 612,-600 649.21,-537.33 594.99,-490.02 648,-440 668.09,-421.04 698.36,-415.46 724.36,-414.78"/>
<polygon fill="#00ffff" stroke="#00ffff" points="724.47,-418.28 734.46,-414.75 724.45,-411.28 724.47,-418.28"/>
</g>
<!-- proc~compute_mbe -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node38" class="node">
<title>proc~compute_mbe</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node38"><a xlink:href="../proc/compute_mbe.html" xlink:title="compute_mbe">
<polygon fill="#d94e8f" stroke="#d94e8f" points="821,-751 732,-751 732,-727 821,-727 821,-751"/>
<text text-anchor="middle" x="776.5" y="-736.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;proc~compute_mbe -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge62" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#00ffff" d="M566.78,-707.01C614.07,-714.25 677.23,-723.94 721.64,-730.74"/>
<polygon fill="#00ffff" stroke="#00ffff" points="721.25,-734.22 731.66,-732.28 722.31,-727.31 721.25,-734.22"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node39" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node39"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="905,-633 648,-633 648,-609 905,-609 905,-633"/>
<text text-anchor="middle" x="776.5" y="-618.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge63" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#00ffff" d="M566.73,-685.72C581.93,-681.99 597.81,-677.16 612,-671 629.64,-663.34 630.25,-654.39 648,-647 658.92,-642.45 670.7,-638.68 682.54,-635.55"/>
<polygon fill="#00ffff" stroke="#00ffff" points="683.62,-638.89 692.48,-633.07 681.93,-632.1 683.62,-638.89"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node40" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node40"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="894,-915 659,-915 659,-891 894,-891 894,-915"/>
<text text-anchor="middle" x="776.5" y="-900.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge64" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#00ffff" d="M566.55,-700.17C583.24,-703.98 599.88,-710.87 612,-723 661.67,-772.74 597.6,-828.01 648,-877 651.37,-880.28 655.04,-883.19 658.93,-885.78"/>
<polygon fill="#00ffff" stroke="#00ffff" points="657.38,-888.93 667.78,-890.96 660.91,-882.89 657.38,-888.93"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node41" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node41"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="1189,-895 941,-895 941,-871 1189,-871 1189,-895"/>
<text text-anchor="middle" x="1065" y="-880.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge65" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#00ffff" d="M566.66,-700.78C583.16,-704.62 599.67,-711.37 612,-723 652.81,-761.51 604.64,-808.39 648,-844 669.7,-861.82 817.31,-872.35 930.6,-877.89"/>
<polygon fill="#00ffff" stroke="#00ffff" points="930.6,-881.39 940.76,-878.38 930.94,-874.4 930.6,-881.39"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node42" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node42"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="851.5,-793 701.5,-793 701.5,-769 851.5,-769 851.5,-793"/>
<text text-anchor="middle" x="776.5" y="-778.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge66" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#00ffff" d="M566.63,-705.89C582.14,-709.71 598.19,-715.18 612,-723 631.97,-734.3 627.66,-749.38 648,-760 661.38,-766.98 676.53,-771.75 691.59,-774.98"/>
<polygon fill="#00ffff" stroke="#00ffff" points="690.98,-778.42 701.46,-776.88 692.31,-771.55 690.98,-778.42"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node43" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node43"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="865,-835 688,-835 688,-811 865,-811 865,-835"/>
<text text-anchor="middle" x="776.5" y="-820.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_energy&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge67" class="edge">
<title>proc~compute_mbe_energy&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#00ffff" d="M566.78,-702.22C582.91,-706.09 599.2,-712.5 612,-723 641.83,-747.48 617.36,-778.55 648,-802 656.96,-808.85 667.31,-813.83 678.17,-817.39"/>
<polygon fill="#00ffff" stroke="#00ffff" points="677.24,-820.77 687.82,-820.17 679.18,-814.04 677.24,-820.77"/>
</g>
<!-- proc~do_fragment_work&#45;&gt;configuration -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge70" class="edge">
<title>proc~do_fragment_work&#45;&gt;configuration</title>
<path fill="none" stroke="#00a9ff" d="M556.62,-452.55C605.54,-445.05 676.46,-434.18 724.19,-426.87"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="724.95,-430.29 734.3,-425.31 723.89,-423.37 724.95,-430.29"/>
</g>
<!-- proc~print_fragment_xyz -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node44" class="node">
<title>proc~print_fragment_xyz</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node44"><a xlink:href="../proc/print_fragment_xyz.html" xlink:title="print_fragment_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="834,-275 719,-275 719,-251 834,-251 834,-275"/>
<text text-anchor="middle" x="776.5" y="-260.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_fragment_xyz</text>
</a>
</g>
</g>
<!-- proc~do_fragment_work&#45;&gt;proc~print_fragment_xyz -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge71" class="edge">
<title>proc~do_fragment_work&#45;&gt;proc~print_fragment_xyz</title>
<path fill="none" stroke="#00a9ff" d="M527.86,-448.91C550.84,-437.91 584.67,-420.6 612,-402 667.7,-364.1 726.3,-310.38 755.9,-282.11"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="758.34,-284.62 763.12,-275.17 753.48,-279.57 758.34,-284.62"/>
</g>
<!-- proc~xtb_calc_energy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node45" class="node">
<title>proc~xtb_calc_energy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node45"><a xlink:href="../proc/xtb_calc_energy.html" xlink:title="xtb_method_t%xtb_calc_energy">
<polygon fill="#d9534f" stroke="#d9534f" points="867,-151 686,-151 686,-127 867,-127 867,-151"/>
<text text-anchor="middle" x="776.5" y="-136.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xtb_method_t%xtb_calc_energy</text>
</a>
</g>
</g>
<!-- proc~do_fragment_work&#45;&gt;proc~xtb_calc_energy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge72" class="edge">
<title>proc~do_fragment_work&#45;&gt;proc~xtb_calc_energy</title>
<path fill="none" stroke="#00a9ff" d="M541.92,-448.96C565.77,-439.81 594.61,-424.84 612,-402 656.16,-344.01 609.51,-303.9 648,-242 671.63,-204 714.33,-173.83 743.76,-156.2"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="745.56,-159.2 752.43,-151.13 742.03,-153.15 745.56,-159.2"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node36" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node36"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="891,-66 662,-66 662,-42 891,-42 891,-66"/>
<text text-anchor="middle" x="776.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge73" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#0054ff" d="M543.12,-368.93C566.95,-359.86 595.34,-344.97 612,-322 666.06,-247.47 593.01,-191.84 648,-118 665.32,-94.75 693.45,-79.38 718.89,-69.55"/>
<polygon fill="#0054ff" stroke="#0054ff" points="720.29,-72.76 728.48,-66.04 717.89,-66.19 720.29,-72.76"/>
</g>
<!-- proc~result_irecv&#45;&gt;irecv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge74" class="edge">
<title>proc~result_irecv&#45;&gt;irecv</title>
<path fill="none" stroke="#0000ff" d="M537.05,-1355.52C558.82,-1350.72 587.17,-1344.08 612,-1337 656.5,-1324.31 706.85,-1306.9 739.77,-1295.09"/>
<polygon fill="#0000ff" stroke="#0000ff" points="741.18,-1298.31 749.4,-1291.62 738.81,-1291.72 741.18,-1298.31"/>
</g>
<!-- proc~result_irecv&#45;&gt;recv -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge75" class="edge">
<title>proc~result_irecv&#45;&gt;recv</title>
<path fill="none" stroke="#0000ff" d="M537.04,-1363C589.33,-1363 686.48,-1363 739.2,-1363"/>
<polygon fill="#0000ff" stroke="#0000ff" points="739.44,-1366.5 749.44,-1363 739.44,-1359.5 739.44,-1366.5"/>
</g>
<!-- proc~result_isend&#45;&gt;isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge76" class="edge">
<title>proc~result_isend&#45;&gt;isend</title>
<path fill="none" stroke="#5400ff" d="M538.74,-1085.47C591.44,-1080.47 687.16,-1071.38 739.3,-1066.44"/>
<polygon fill="#5400ff" stroke="#5400ff" points="739.8,-1069.9 749.42,-1065.47 739.14,-1062.93 739.8,-1069.9"/>
</g>
<!-- send -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node46" class="node">
<title>send</title>
<polygon fill="#777777" stroke="#777777" points="803.5,-1117 749.5,-1117 749.5,-1093 803.5,-1093 803.5,-1117"/>
<text text-anchor="middle" x="776.5" y="-1102.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send</text>
</g>
<!-- proc~result_isend&#45;&gt;send -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge77" class="edge">
<title>proc~result_isend&#45;&gt;send</title>
<path fill="none" stroke="#5400ff" d="M538.74,-1091.17C591.44,-1094.25 687.16,-1099.84 739.3,-1102.89"/>
<polygon fill="#5400ff" stroke="#5400ff" points="739.24,-1106.39 749.42,-1103.48 739.64,-1099.4 739.24,-1106.39"/>
</g>
<!-- proc~send_fragment_to_node&#45;&gt;isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge78" class="edge">
<title>proc~send_fragment_to_node&#45;&gt;isend</title>
<path fill="none" stroke="#aa00ff" d="M562.65,-1021.05C616.94,-1031.75 694.43,-1047.02 739.39,-1055.88"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="738.79,-1059.33 749.28,-1057.83 740.14,-1052.46 738.79,-1059.33"/>
</g>
<!-- proc~send_fragment_to_worker&#45;&gt;isend -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge79" class="edge">
<title>proc~send_fragment_to_worker&#45;&gt;isend</title>
<path fill="none" stroke="#ff00ff" d="M576.03,-973.25C588.66,-976.47 601.18,-981.18 612,-988 634.86,-1002.41 625.24,-1022.44 648,-1037 675.3,-1054.47 712.04,-1060.52 739.07,-1062.47"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="739.09,-1065.98 749.27,-1063.05 739.49,-1058.99 739.09,-1065.98"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node54" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node54"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1181.5,-24 948.5,-24 948.5,0 1181.5,0 1181.5,-24"/>
<text text-anchor="middle" x="1065" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge80" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#ff7f00" d="M859.6,-41.96C894.66,-36.82 935.75,-30.8 971.85,-25.51"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="972.5,-28.95 981.89,-24.04 971.49,-22.02 972.5,-28.95"/>
</g>
<!-- proc~combine_util&#45;&gt;proc~combine_util -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge81" class="edge">
<title>proc~combine_util&#45;&gt;proc~combine_util</title>
<path fill="none" stroke="#ffff00" d="M735.74,-1608.68C712.51,-1618.33 726.1,-1629 776.5,-1629 818.24,-1629 834.73,-1621.68 825.97,-1613.69"/>
<polygon fill="#ffff00" stroke="#ffff00" points="827.67,-1610.62 817.26,-1608.68 824.18,-1616.69 827.67,-1610.62"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node56" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node56"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1184,-685 946,-685 946,-661 1184,-661 1184,-685"/>
<text text-anchor="middle" x="1065" y="-670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge82" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#7fff00" d="M821.12,-733.25C846.15,-729.18 877.88,-722.7 905,-713 922.04,-706.91 923.87,-699.82 941,-694 948.28,-691.53 955.91,-689.34 963.65,-687.4"/>
<polygon fill="#7fff00" stroke="#7fff00" points="964.57,-690.78 973.5,-685.07 962.96,-683.96 964.57,-690.78"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node58" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node58"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="1130,-643 1000,-643 1000,-619 1130,-619 1130,-643"/>
<text text-anchor="middle" x="1065" y="-628.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~get_next_combination -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge83" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#7fff00" d="M821.17,-738.79C847.58,-736.68 880.72,-730.31 905,-713 930.63,-694.72 915.08,-669.86 941,-652 955.32,-642.14 972.74,-636.39 989.92,-633.16"/>
<polygon fill="#7fff00" stroke="#7fff00" points="990.67,-636.58 999.99,-631.53 989.56,-629.67 990.67,-636.58"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node59" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node59"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1124,-937 1006,-937 1006,-913 1124,-913 1124,-937"/>
<text text-anchor="middle" x="1065" y="-922.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge84" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#00ff7f" d="M894.03,-911.95C928.55,-914.6 965.21,-917.41 995.62,-919.75"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="995.44,-923.25 1005.68,-920.52 995.97,-916.27 995.44,-923.25"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node47" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="1335.5,-863 1256.5,-863 1256.5,-839 1335.5,-839 1335.5,-863"/>
<text text-anchor="middle" x="1296" y="-848.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge85" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ffff" d="M1151.92,-870.99C1183.77,-866.54 1218.77,-861.65 1246.18,-857.82"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1246.87,-861.26 1256.29,-856.41 1245.9,-854.33 1246.87,-861.26"/>
</g>
<!-- sort -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node61" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="1323,-790 1269,-790 1269,-766 1323,-766 1323,-790"/>
<text text-anchor="middle" x="1296" y="-775.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge86" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#00ffff" d="M1165.85,-870.91C1173.86,-868.46 1181.68,-865.52 1189,-862 1208.3,-852.73 1208.39,-843.51 1225,-830 1239.36,-818.32 1255.96,-805.94 1269.39,-796.19"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1271.64,-798.89 1277.71,-790.2 1267.55,-793.21 1271.64,-798.89"/>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge90" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#007fff" d="M851.73,-779.03C871.1,-782.04 890.56,-788.7 905,-802 953.51,-846.7 895.82,-897.93 941,-946 963.24,-969.67 999.74,-979.04 1027.21,-982.71"/>
<polygon fill="#007fff" stroke="#007fff" points="1026.92,-986.2 1037.25,-983.86 1027.72,-979.25 1026.92,-986.2"/>
</g>
<!-- header -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node48" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="1092,-727 1038,-727 1038,-703 1092,-703 1092,-727"/>
<text text-anchor="middle" x="1065" y="-712.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge87" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#007fff" d="M851.75,-774.21C869.59,-771.1 888.3,-766.58 905,-760 922.89,-752.95 923.13,-743.11 941,-736 968.83,-724.93 1002.47,-719.69 1027.53,-717.22"/>
<polygon fill="#007fff" stroke="#007fff" points="1028.06,-720.68 1037.71,-716.31 1027.44,-713.71 1028.06,-720.68"/>
</g>
<!-- level_name -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node49" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="1102,-769 1028,-769 1028,-745 1102,-745 1102,-769"/>
<text text-anchor="middle" x="1065" y="-754.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge88" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#007fff" d="M851.65,-774.79C904.11,-770.39 972.81,-764.64 1017.66,-760.88"/>
<polygon fill="#007fff" stroke="#007fff" points="1018.01,-764.36 1027.68,-760.04 1017.42,-757.39 1018.01,-764.36"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node57" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node57"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1127,-811 1003,-811 1003,-787 1127,-787 1127,-811"/>
<text text-anchor="middle" x="1065" y="-796.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge89" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#007fff" d="M851.65,-785.66C895.09,-788.39 949.68,-791.82 992.63,-794.52"/>
<polygon fill="#007fff" stroke="#007fff" points="992.52,-798.02 1002.72,-795.15 992.96,-791.03 992.52,-798.02"/>
</g>
<!-- warning -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node62" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="1092.5,-853 1037.5,-853 1037.5,-829 1092.5,-829 1092.5,-853"/>
<text text-anchor="middle" x="1065" y="-838.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge91" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#007fff" d="M851.56,-789.34C869.31,-792.39 888.03,-796.5 905,-802 922.02,-807.52 924,-814.43 941,-820 969.1,-829.2 1002.21,-834.56 1026.99,-837.56"/>
<polygon fill="#007fff" stroke="#007fff" points="1026.73,-841.05 1037.06,-838.7 1027.52,-834.1 1026.73,-841.05"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge93" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#0000ff" d="M865.15,-822.92C879.99,-819.15 894.09,-812.67 905,-802 967.07,-741.29 891.88,-681.59 941,-610 962.09,-579.26 1000.1,-558.61 1028.3,-546.69"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1029.87,-549.83 1037.82,-542.84 1027.24,-543.34 1029.87,-549.83"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge92" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#0000ff" d="M826.93,-835.06C853.52,-843.92 884.89,-858.6 905,-882 942.41,-925.52 913.31,-955.73 941,-1006 967.89,-1054.81 1014.57,-1101.1 1042.04,-1126.01"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1039.79,-1128.69 1049.58,-1132.74 1044.45,-1123.47 1039.79,-1128.69"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge94" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#0000ff" d="M865.02,-815.67C905.95,-812.24 954.09,-808.21 992.76,-804.97"/>
<polygon fill="#0000ff" stroke="#0000ff" points="993.21,-808.44 1002.88,-804.12 992.63,-801.47 993.21,-808.44"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge95" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#0000ff" d="M865.02,-828.5C919.51,-831.92 986.76,-836.15 1027.46,-838.7"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1027.26,-842.2 1037.46,-839.33 1027.7,-835.21 1027.26,-842.2"/>
</g>
<!-- proc~print_fragment_xyz&#45;&gt;info -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge96" class="edge">
<title>proc~print_fragment_xyz&#45;&gt;info</title>
<path fill="none" stroke="#7f00ff" d="M834.27,-261.92C858.81,-264.37 886.15,-271.45 905,-289 948.56,-329.57 910.22,-367.05 941,-418 966.03,-459.44 1009.87,-495.63 1037.88,-516.14"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1035.87,-519 1046.03,-521.99 1039.95,-513.31 1035.87,-519"/>
</g>
<!-- proc~print_fragment_xyz&#45;&gt;to_char -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge99" class="edge">
<title>proc~print_fragment_xyz&#45;&gt;to_char</title>
<path fill="none" stroke="#7f00ff" d="M834.04,-267.05C857.16,-270.56 883.47,-277.05 905,-289 925.34,-300.29 922.69,-312.65 941,-327 968.38,-348.47 1003.11,-367.6 1028.67,-380.42"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1027.13,-383.56 1037.65,-384.85 1030.23,-377.28 1027.13,-383.56"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node55" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node55"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1146.5,-318 983.5,-318 983.5,-294 1146.5,-294 1146.5,-318"/>
<text text-anchor="middle" x="1065" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_fragment_xyz&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge97" class="edge">
<title>proc~print_fragment_xyz&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#7f00ff" d="M834.1,-271.5C873.98,-277.48 928.22,-285.62 973.99,-292.49"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="973.52,-295.96 983.92,-293.98 974.55,-289.04 973.52,-295.96"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node60" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node60"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1104.5,-276 1025.5,-276 1025.5,-252 1104.5,-252 1104.5,-276"/>
<text text-anchor="middle" x="1065" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~print_fragment_xyz&#45;&gt;proc~to_angstrom -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge98" class="edge">
<title>proc~print_fragment_xyz&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#7f00ff" d="M834.1,-263.2C886.93,-263.38 964.95,-263.65 1015.13,-263.83"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1015.38,-267.33 1025.39,-263.87 1015.4,-260.33 1015.38,-267.33"/>
</g>
<!-- new -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node50" class="node">
<title>new</title>
<polygon fill="#777777" stroke="#777777" points="1092,-66 1038,-66 1038,-42 1092,-42 1092,-66"/>
<text text-anchor="middle" x="1065" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~xtb_calc_energy&#45;&gt;new -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge100" class="edge">
<title>proc~xtb_calc_energy&#45;&gt;new</title>
<path fill="none" stroke="#ff00ff" d="M803.55,-126.88C835.35,-112.55 891.07,-88.88 941,-75 969.67,-67.03 1002.99,-61.57 1027.71,-58.21"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1028.28,-61.67 1037.74,-56.91 1027.38,-54.73 1028.28,-61.67"/>
</g>
<!-- new_gfn1_calculator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node51" class="node">
<title>new_gfn1_calculator</title>
<polygon fill="#777777" stroke="#777777" points="1126,-234 1004,-234 1004,-210 1126,-210 1126,-234"/>
<text text-anchor="middle" x="1065" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_gfn1_calculator</text>
</g>
<!-- proc~xtb_calc_energy&#45;&gt;new_gfn1_calculator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge101" class="edge">
<title>proc~xtb_calc_energy&#45;&gt;new_gfn1_calculator</title>
<path fill="none" stroke="#ff00ff" d="M863.11,-151.09C877.57,-155 892.08,-160.17 905,-167 924.45,-177.29 921.31,-191.17 941,-201 957.12,-209.05 975.75,-214.08 993.56,-217.21"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="993.5,-220.75 1003.92,-218.84 994.59,-213.83 993.5,-220.75"/>
</g>
<!-- new_gfn2_calculator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node52" class="node">
<title>new_gfn2_calculator</title>
<polygon fill="#777777" stroke="#777777" points="1126,-192 1004,-192 1004,-168 1126,-168 1126,-192"/>
<text text-anchor="middle" x="1065" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_gfn2_calculator</text>
</g>
<!-- proc~xtb_calc_energy&#45;&gt;new_gfn2_calculator -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge102" class="edge">
<title>proc~xtb_calc_energy&#45;&gt;new_gfn2_calculator</title>
<path fill="none" stroke="#ff00ff" d="M861.52,-151.02C903.53,-157.04 953.79,-164.23 993.73,-169.94"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="993.25,-173.41 1003.65,-171.36 994.24,-166.48 993.25,-173.41"/>
</g>
<!-- new_wavefunction -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node53" class="node">
<title>new_wavefunction</title>
<polygon fill="#777777" stroke="#777777" points="1120.5,-150 1009.5,-150 1009.5,-126 1120.5,-126 1120.5,-150"/>
<text text-anchor="middle" x="1065" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_wavefunction</text>
</g>
<!-- proc~xtb_calc_energy&#45;&gt;new_wavefunction -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge103" class="edge">
<title>proc~xtb_calc_energy&#45;&gt;new_wavefunction</title>
<path fill="none" stroke="#ff00ff" d="M867.36,-138.69C910.15,-138.54 960.34,-138.36 999.31,-138.23"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="999.49,-141.73 1009.47,-138.19 999.46,-134.73 999.49,-141.73"/>
</g>
<!-- xtb_singlepoint -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node63" class="node">
<title>xtb_singlepoint</title>
<polygon fill="#777777" stroke="#777777" points="1111.5,-108 1018.5,-108 1018.5,-84 1111.5,-84 1111.5,-108"/>
<text text-anchor="middle" x="1065" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xtb_singlepoint</text>
</g>
<!-- proc~xtb_calc_energy&#45;&gt;xtb_singlepoint -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge104" class="edge">
<title>proc~xtb_calc_energy&#45;&gt;xtb_singlepoint</title>
<path fill="none" stroke="#ff00ff" d="M857.69,-126.96C905.66,-119.77 965.41,-110.8 1008.25,-104.37"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1008.84,-107.82 1018.21,-102.87 1007.8,-100.9 1008.84,-107.82"/>
</g>
<!-- proc~cgto_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node65" class="node">
<title>proc~cgto_destroy</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node65"><a xlink:href="../proc/cgto_destroy.html" xlink:title="cgto_type%cgto_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1367,-24 1225,-24 1225,0 1367,0 1367,-24"/>
<text text-anchor="middle" x="1296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cgto_type%cgto_destroy</text>
</a>
</g>
</g>
<!-- proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge105" class="edge">
<title>proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy</title>
<path fill="none" stroke="#00ff78" d="M1181.51,-12C1192.71,-12 1203.9,-12 1214.65,-12"/>
<polygon fill="#00ff78" stroke="#00ff78" points="1214.81,-15.5 1224.81,-12 1214.81,-8.5 1214.81,-15.5"/>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge106" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00d1ff" d="M1175.92,-685.02C1180.56,-687.59 1184.96,-690.56 1189,-694 1226.58,-725.96 1195.89,-759.17 1225,-799 1235.19,-812.94 1250.18,-824.77 1263.69,-833.62"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="1261.95,-836.66 1272.28,-838.99 1265.66,-830.72 1261.95,-836.66"/>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge108" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#00d1ff" d="M1164.03,-685.08C1172.64,-687.53 1181.09,-690.47 1189,-694 1223.83,-709.54 1257.14,-739.18 1276.83,-758.77"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="1274.42,-761.31 1283.93,-765.98 1279.41,-756.4 1274.42,-761.31"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_node64" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~run_fragmented_calculation~~CallsGraph_node64"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1360,-685 1232,-685 1232,-661 1360,-661 1360,-685"/>
<text text-anchor="middle" x="1296" y="-670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~run_fragmented_calculation~~CallsGraph_edge107" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#00d1ff" d="M1184.19,-673C1196.88,-673 1209.5,-673 1221.45,-673"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="1221.75,-676.5 1231.75,-673 1221.75,-669.5 1221.75,-676.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocrun_fragmented_calculationCallsGraph = svgPanZoom('#procrun_fragmented_calculationCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~run_fragmented_calculation~~CalledByGraph Pages: 1 -->
<svg id="procrun_fragmented_calculationCalledByGraph" width="391pt" height="32pt"
 viewBox="0.00 0.00 391.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~run_fragmented_calculation~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~run_fragmented_calculation~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 387,-28 387,4 -4,4"/>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~run_fragmented_calculation~~CalledByGraph_node1" class="node">
<title>proc~run_fragmented_calculation</title>
<polygon fill="none" stroke="black" points="383,-24 220,-24 220,0 383,0 383,-24"/>
<text text-anchor="middle" x="301.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">run_fragmented_calculation</text>
</g>
<!-- proc~run_calculation -->
<g id="proc~~run_fragmented_calculation~~CalledByGraph_node2" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~run_fragmented_calculation~~CalledByGraph_node2"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="184,-24 90,-24 90,0 184,0 184,-24"/>
<text text-anchor="middle" x="137" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~run_fragmented_calculation~~CalledByGraph_edge1" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M184.13,-12C192.24,-12 200.94,-12 209.78,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.8,-15.5 219.8,-12 209.8,-8.5 209.8,-15.5"/>
</g>
<!-- program~main -->
<g id="proc~~run_fragmented_calculation~~CalledByGraph_node3" class="node">
<title>program~main</title>
<g id="a_proc~~run_fragmented_calculation~~CalledByGraph_node3"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~run_fragmented_calculation~~CalledByGraph_edge2" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M54.14,-12C61.95,-12 70.81,-12 79.77,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.86,-15.5 89.86,-12 79.86,-8.5 79.86,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-all_node_leader_ranks"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>all_node_leader_ranks</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                <p>Node leader status for all ranks</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-global_node_rank"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>global_node_rank</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Global rank if this process leads a node, -1 otherwise</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~14"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Loop counters</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~5"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Loop counters</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-monomers"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>monomers</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                <p>Temporary monomer list for fragment generation</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_expected_frags"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_expected_frags</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Expected number of fragments based on combinatorics (int64 to handle large systems)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_rows"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_rows</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Number of rows needed for polymers array (int64 to handle large systems)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_leader_ranks"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>node_leader_ranks</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                <p>Ranks of processes that lead each node</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-num_nodes"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>num_nodes</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Number of compute nodes</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~4"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                <p>Fragment composition array (fragment, monomer_indices)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_fragments"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_fragments</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>Total number of fragments generated (int64 to handle large systems)</p>
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">run_fragmented_calculation</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">matrix_size</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Handle fragmented calculation (nlevel &gt; 0)</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! Generates fragments, distributes work across MPI processes organized in nodes,</span>
<span class="w">      </span><span class="c">!! and coordinates many-body expansion calculation using hierarchical parallelism.</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span><span class="w">  </span><span class="c">!! Global MPI communicator</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">node_comm</span><span class="w">   </span><span class="c">!! Node-local MPI communicator</span>
<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">method</span><span class="w">  </span><span class="c">!! Quantum chemistry method (gfn1/gfn2)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span><span class="w">  </span><span class="c">!! System geometry and fragment info</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">max_level</span><span class="w">    </span><span class="c">!! Maximum fragment level for MBE</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">matrix_size</span><span class="w">  </span><span class="c">!! Size of gradient matrix (natoms*3)</span>

<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_fragments</span><span class="w">  </span><span class="c">!! Total number of fragments generated (int64 to handle large systems)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! Fragment composition array (fragment, monomer_indices)</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_nodes</span><span class="w">   </span><span class="c">!! Number of compute nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">        </span><span class="c">!! Loop counters</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">node_leader_ranks</span><span class="p">(:)</span><span class="w">  </span><span class="c">!! Ranks of processes that lead each node</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">monomers</span><span class="p">(:)</span><span class="w">     </span><span class="c">!! Temporary monomer list for fragment generation</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_expected_frags</span><span class="w">  </span><span class="c">!! Expected number of fragments based on combinatorics (int64 to handle large systems)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_rows</span><span class="w">      </span><span class="c">!! Number of rows needed for polymers array (int64 to handle large systems)</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">global_node_rank</span><span class="w">  </span><span class="c">!! Global rank if this process leads a node, -1 otherwise</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">all_node_leader_ranks</span><span class="p">(:)</span><span class="w">  </span><span class="c">!! Node leader status for all ranks</span>

<span class="w">      </span><span class="c">! Generate fragments</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">         </span><span class="c">! Calculate expected number of fragments</span>
<span class="w">         </span><span class="n">n_expected_frags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_nfrags</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">n_monomers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span>
<span class="w">         </span><span class="n">n_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_expected_frags</span>

<span class="w">         </span><span class="c">! Allocate monomer list and polymers array</span>
<span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">monomers</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">n_monomers</span><span class="p">))</span>
<span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">))</span>
<span class="w">         </span><span class="n">polymers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">         </span><span class="c">! Create monomer list [1, 2, 3, ..., n_monomers]</span>
<span class="w">         </span><span class="k">call </span><span class="n">create_monomer_list</span><span class="p">(</span><span class="n">monomers</span><span class="p">)</span>

<span class="w">         </span><span class="c">! Generate all fragments (includes monomers in polymers array)</span>
<span class="w">         </span><span class="n">total_fragments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0_int64</span>

<span class="w">         </span><span class="c">! First add monomers</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">n_monomers</span>
<span class="w">            </span><span class="n">total_fragments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_fragments</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1_int64</span>
<span class="w">            </span><span class="n">polymers</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">         </span><span class="k">end do</span>

<span class="w">         </span><span class="c">! Then add n-mers for n &gt;= 2</span>
<span class="w">         </span><span class="k">call </span><span class="n">generate_fragment_list</span><span class="p">(</span><span class="n">monomers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span>

<span class="w">         </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">monomers</span><span class="p">)</span>

<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated fragments:&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Total fragments: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">))</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Max level: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Broadcast total_fragments to all ranks</span>
<span class="w">      </span><span class="k">call </span><span class="n">bcast</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Determine node leaders</span>
<span class="w">      </span><span class="n">global_node_rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">global_node_rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">world_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">()</span>

<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">all_node_leader_ranks</span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()))</span>
<span class="w">      </span><span class="k">call </span><span class="n">allgather</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">global_node_rank</span><span class="p">,</span><span class="w"> </span><span class="n">all_node_leader_ranks</span><span class="p">)</span>

<span class="w">      </span><span class="n">num_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">all_node_leader_ranks</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running with &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; node(s)&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      allocate</span><span class="w"> </span><span class="p">(</span><span class="n">node_leader_ranks</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">))</span>
<span class="w">      </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">all_node_leader_ranks</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">node_leader_ranks</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">all_node_leader_ranks</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">         </span><span class="k">end if</span>
<span class="k">      end do</span>
<span class="k">      deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">all_node_leader_ranks</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Execute appropriate role</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">         </span><span class="c">! Single rank: process fragments serially</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running in serial mode (single MPI rank)&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">serial_fragment_processor</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">leader</span><span class="p">()</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">leader</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="w">         </span><span class="c">! Global coordinator (rank 0, node leader on node 0)</span>
<span class="w">         </span><span class="k">call </span><span class="n">omp_set_num_threads</span><span class="p">(</span><span class="n">omp_get_max_threads</span><span class="p">())</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Rank 0: Acting as global coordinator&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">global_coordinator</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">node_leader_ranks</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">leader</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="w">         </span><span class="c">! Node coordinator (node leader on other nodes)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Rank &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot;: Acting as node coordinator&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">node_coordinator</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span><span class="c">! Worker</span>
<span class="w">         </span><span class="k">call </span><span class="n">omp_set_num_threads</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Rank &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot;: Acting as worker&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">node_worker</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">world_comm</span><span class="p">%</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">polymers</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">polymers</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">node_leader_ranks</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">node_leader_ranks</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">   end subroutine </span><span class="n">run_fragmented_calculation</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-12-26 00:43 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>