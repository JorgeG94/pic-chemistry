<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>compute_mbe &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>compute_mbe
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 2.8% of total for procedures.">246 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe.f90.html'>mqc_mbe.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe.html'>mqc_mbe</a></li>
            <li class="breadcrumb-item active" aria-current="page">compute_mbe</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_dipole">compute_dipole</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_dipole_derivs">compute_dipole_derivs</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_grad">compute_grad</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_hess">compute_hess</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-current_log_level~5">current_log_level</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_e~2">delta_E</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_dipole_derivs~2">delta_dipole_derivs</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_dipoles~2">delta_dipoles</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_energies~2">delta_energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_gradients~2">delta_gradients</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_hessians~2">delta_hessians</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-do_detailed_print">do_detailed_print</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-energies~2">energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-fragment_size~9">fragment_size</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-hess_dim~3">hess_dim</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-i~40">i</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-ir_intensities">ir_intensities</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-lookup~7">lookup</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-nlevel~3">nlevel</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-sum_by_level~2">sum_by_level</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/compute_mbe.html#src">compute_mbe</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine compute_mbe(polymers, fragment_count, max_level, results, mbe_result, sys_geom, bonds, world_comm)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/mqc_config_parser.html'>mqc_config_parser</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_error.html'>mqc_error</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_result_types.html'>mqc_result_types</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~UsesGraph Pages: 1 -->
<svg id="proccompute_mbeUsesGraph" width="497pt" height="265pt"
 viewBox="0.00 0.00 497.00 265.03" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 261.03)">
<title>proc~~compute_mbe~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-261.03 493,-261.03 493,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~UsesGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="489,-188 400,-188 400,-164 489,-164 489,-188"/>
<text text-anchor="middle" x="444.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_node2" class="node">
<title>module~mqc_config_parser</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node2"><a xlink:href="../module/mqc_config_parser.html" xlink:title="mqc_config_parser">
<polygon fill="#337ab7" stroke="#337ab7" points="364,-125 250,-125 250,-101 364,-101 364,-125"/>
<text text-anchor="middle" x="307" y="-110.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_config_parser</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_config_parser</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M417.37,-163.85C396.29,-154.05 366.41,-140.16 343.21,-129.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.59,-126.15 334.05,-125.11 341.64,-132.5 344.59,-126.15"/>
</g>
<!-- module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_node3" class="node">
<title>module~mqc_error</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node3"><a xlink:href="../module/mqc_error.html" xlink:title="mqc_error">
<polygon fill="#337ab7" stroke="#337ab7" points="189.5,-188 122.5,-188 122.5,-164 189.5,-164 189.5,-188"/>
<text text-anchor="middle" x="156" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_error</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.99,-176C345.83,-176 253.93,-176 200.01,-176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.76,-172.5 189.76,-176 199.76,-179.5 199.76,-172.5"/>
</g>
<!-- module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_node4" class="node">
<title>module~mqc_result_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node4"><a xlink:href="../module/mqc_result_types.html" xlink:title="mqc_result_types">
<polygon fill="#337ab7" stroke="#337ab7" points="359,-229 255,-229 255,-205 359,-205 359,-229"/>
<text text-anchor="middle" x="307" y="-214.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_result_types</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge3" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_result_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.58,-188.08C389.23,-192.42 372.88,-197.37 357.8,-201.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="356.66,-198.62 348.1,-204.87 358.69,-205.32 356.66,-198.62"/>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge5" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.84,-125.11C262.48,-133.79 236.89,-145.57 214,-155 209.25,-156.96 204.24,-158.93 199.24,-160.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.84,-157.63 189.72,-164.43 200.31,-164.18 197.84,-157.63"/>
</g>
<!-- module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_node5" class="node">
<title>module~mqc_calc_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node5"><a xlink:href="../module/mqc_calc_types.html" xlink:title="mqc_calc_types">
<polygon fill="#337ab7" stroke="#337ab7" points="204.5,-24 107.5,-24 107.5,0 204.5,0 204.5,-24"/>
<text text-anchor="middle" x="156" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_calc_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge4" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_calc_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.4,-100.94C276.38,-85.09 244.63,-57.03 214,-38 208.54,-34.61 202.57,-31.4 196.61,-28.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.87,-25.19 187.33,-24.1 194.89,-31.53 197.87,-25.19"/>
</g>
<!-- module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_node6" class="node">
<title>module~mqc_geometry</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node6"><a xlink:href="../module/mqc_geometry.html" xlink:title="mqc_geometry">
<polygon fill="#337ab7" stroke="#337ab7" points="202.5,-146 109.5,-146 109.5,-122 202.5,-122 202.5,-146"/>
<text text-anchor="middle" x="156" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_geometry</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_edge6" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-120.94C237.57,-122.65 224.78,-124.45 212.7,-126.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.16,-122.69 202.75,-127.55 213.14,-129.62 212.16,-122.69"/>
</g>
<!-- module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_node7" class="node">
<title>module~mqc_method_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node7"><a xlink:href="../module/mqc_method_types.html" xlink:title="mqc_method_types">
<polygon fill="#337ab7" stroke="#337ab7" points="214,-104 98,-104 98,-80 214,-80 214,-104"/>
<text text-anchor="middle" x="156" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_method_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge7" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_method_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-105.06C241.47,-103.9 232.95,-102.7 224.56,-101.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="224.79,-98.02 214.4,-100.09 223.81,-104.95 224.79,-98.02"/>
</g>
<!-- pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_node9" class="node">
<title>pic_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62,-104 0,-104 0,-80 62,-80 62,-104"/>
<text text-anchor="middle" x="31" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_types</text>
</g>
<!-- module~mqc_config_parser&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge8" class="edge">
<title>module~mqc_config_parser&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.05,-100.85C267.98,-90.6 240.25,-76.71 214,-71 163.62,-60.04 148.95,-63.09 98,-71 89.37,-72.34 80.33,-74.61 71.81,-77.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="70.55,-73.9 62.09,-80.28 72.68,-80.57 70.55,-73.9"/>
</g>
<!-- module~mqc_result_types&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge9" class="edge">
<title>module~mqc_result_types&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M262.1,-204.92C242.36,-199.49 219.16,-193.1 199.58,-187.72"/>
<polygon fill="#0000ff" stroke="#0000ff" points="200.28,-184.28 189.71,-185 198.42,-191.03 200.28,-184.28"/>
</g>
<!-- pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_node8" class="node">
<title>pic_mpi_lib</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192,-230 120,-230 120,-206 192,-206 192,-230"/>
<text text-anchor="middle" x="156" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_mpi_lib</text>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_edge10" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_mpi_lib</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M254.72,-217.34C237.87,-217.46 219.26,-217.58 202.84,-217.69"/>
<polygon fill="#0000ff" stroke="#0000ff" points="202.39,-214.2 192.41,-217.76 202.43,-221.2 202.39,-214.2"/>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge11" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M280.9,-229.12C239.26,-247.3 154.85,-275.8 98,-239 55.17,-211.28 39.87,-148.44 34.61,-114.6"/>
<polygon fill="#0000ff" stroke="#0000ff" points="38.02,-113.75 33.18,-104.33 31.09,-114.71 38.02,-113.75"/>
</g>
<!-- module~mqc_calc_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge12" class="edge">
<title>module~mqc_calc_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.66,-24.09C115.82,-28.08 106.31,-32.83 98,-38 81.71,-48.14 65,-61.86 52.47,-72.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.97,-70.46 44.88,-79.75 54.65,-75.66 49.97,-70.46"/>
</g>
<!-- module~mqc_geometry&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge13" class="edge">
<title>module~mqc_geometry&#45;&gt;pic_types</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M119.75,-121.96C104.85,-116.87 87.4,-110.92 72.02,-105.66"/>
<polygon fill="#cbff00" stroke="#cbff00" points="72.84,-102.25 62.25,-102.33 70.58,-108.87 72.84,-102.25"/>
</g>
<!-- module~mqc_method_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge14" class="edge">
<title>module~mqc_method_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M97.82,-92C89.18,-92 80.42,-92 72.23,-92"/>
<polygon fill="#00ff66" stroke="#00ff66" points="72.22,-88.5 62.22,-92 72.22,-95.5 72.22,-88.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


    <p>Compute many-body expansion (MBE) energy with optional gradient, hessian, and dipole</p>
<p>This is the core routine that handles all MBE computations.
The caller pre-allocates desired components in mbe_result before calling:
  - mbe_result%gradient allocated: compute gradient (requires sys_geom)
  - mbe_result%hessian allocated: compute hessian (requires sys_geom)
  - mbe_result%dipole allocated: compute total dipole moment</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~13"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_count~2"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_count</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~12"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results~7"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mbe_result~2"></span>
              type(<a href='../type/mbe_result_t.html'>mbe_result_t</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mbe_result</strong></td>
            <td>
                <p>Pre-allocated by caller</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~34"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                <p>Required for gradient/hessian</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~21"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                <p>Bond info for H-cap handling</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~13"></span>
              type(comm_t),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                <p>MPI communicator for abort</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CallsGraph Pages: 1 -->
<svg id="proccompute_mbeCallsGraph" width="641pt" height="891pt"
 viewBox="0.00 0.00 641.00 891.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CallsGraph" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 2375.6)">
<title>proc~~compute_mbe~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2375.6 1707,-2375.6 1707,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="89,-1474.6 0,-1474.6 0,-1450.6 89,-1450.6 89,-1474.6"/>
<text text-anchor="middle" x="44.5" y="-1460.2" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_node2" class="node">
<title>abort_comm</title>
<polygon fill="#777777" stroke="#777777" points="870,-2009.6 790,-2009.6 790,-1985.6 870,-1985.6 870,-2009.6"/>
<text text-anchor="middle" x="830" y="-1995.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abort_comm</text>
</g>
<!-- proc~compute_mbe&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;abort_comm</title>
<path fill="none" stroke="#ff0000" d="M45.29,-1474.85C44.35,-1547.89 43.49,-1925.36 125,-1996.6 221.85,-2081.26 635.35,-2027.38 779.33,-2005.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="780.27,-2008.95 789.63,-2003.97 779.21,-2002.03 780.27,-2008.95"/>
</g>
<!-- cart_disp -->
<g id="proc~~compute_mbe~~CallsGraph_node3" class="node">
<title>cart_disp</title>
<polygon fill="#777777" stroke="#777777" points="284,-2140.6 223,-2140.6 223,-2116.6 284,-2116.6 284,-2140.6"/>
<text text-anchor="middle" x="253.5" y="-2126.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cart_disp</text>
</g>
<!-- proc~compute_mbe&#45;&gt;cart_disp -->
<g id="proc~~compute_mbe~~CallsGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;cart_disp</title>
<path fill="none" stroke="#ff0000" d="M46.16,-1474.64C50.87,-1558.56 80.47,-2054.48 125,-2102.6 146.93,-2126.31 184.12,-2131.65 212.7,-2131.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.85,-2135.24 222.79,-2131.56 212.73,-2128.24 212.85,-2135.24"/>
</g>
<!-- configuration -->
<g id="proc~~compute_mbe~~CallsGraph_node4" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="872,-1445.6 788,-1445.6 788,-1421.6 872,-1421.6 872,-1445.6"/>
<text text-anchor="middle" x="830" y="-1431.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge3" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#ff0000" d="M89.24,-1460.95C100.86,-1460.51 113.41,-1460.04 125,-1459.6 369.4,-1450.48 661.53,-1439.75 777.71,-1435.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="777.87,-1438.98 787.74,-1435.12 777.62,-1431.99 777.87,-1438.98"/>
</g>
<!-- error -->
<g id="proc~~compute_mbe~~CallsGraph_node5" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1435.5,-1443.6 1381.5,-1443.6 1381.5,-1419.6 1435.5,-1419.6 1435.5,-1443.6"/>
<text text-anchor="middle" x="1408.5" y="-1429.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge4" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M89.03,-1452.03C100.65,-1449.56 113.25,-1447.19 125,-1445.6 490.45,-1396.45 585.34,-1404.89 954,-1412.6 1109.38,-1415.86 1294.51,-1425.38 1371.33,-1429.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1371.26,-1433.08 1381.44,-1430.13 1371.65,-1426.09 1371.26,-1433.08"/>
</g>
<!-- fc_mdyne -->
<g id="proc~~compute_mbe~~CallsGraph_node6" class="node">
<title>fc_mdyne</title>
<polygon fill="#777777" stroke="#777777" points="285.5,-1945.6 221.5,-1945.6 221.5,-1921.6 285.5,-1921.6 285.5,-1945.6"/>
<text text-anchor="middle" x="253.5" y="-1931.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fc_mdyne</text>
</g>
<!-- proc~compute_mbe&#45;&gt;fc_mdyne -->
<g id="proc~~compute_mbe~~CallsGraph_edge5" class="edge">
<title>proc~compute_mbe&#45;&gt;fc_mdyne</title>
<path fill="none" stroke="#ff0000" d="M45.82,-1474.86C47.81,-1540.4 60.54,-1848.89 125,-1912.6 147.21,-1934.56 182.97,-1938.85 210.97,-1938.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.45,-1941.67 221.28,-1937.72 211.13,-1934.68 211.45,-1941.67"/>
</g>
<!-- force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node7" class="node">
<title>force_constants</title>
<polygon fill="#777777" stroke="#777777" points="301.5,-1903.6 205.5,-1903.6 205.5,-1879.6 301.5,-1879.6 301.5,-1903.6"/>
<text text-anchor="middle" x="253.5" y="-1889.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">force_constants</text>
</g>
<!-- proc~compute_mbe&#45;&gt;force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge6" class="edge">
<title>proc~compute_mbe&#45;&gt;force_constants</title>
<path fill="none" stroke="#ff0000" d="M46.07,-1474.93C49.18,-1536.88 66.24,-1813.54 125,-1870.6 143.39,-1888.46 170.76,-1894.56 195.43,-1895.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.36,-1899.34 205.45,-1896.12 195.55,-1892.35 195.36,-1899.34"/>
</g>
<!-- frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_node8" class="node">
<title>frequencies</title>
<polygon fill="#777777" stroke="#777777" points="291,-1861.6 216,-1861.6 216,-1837.6 291,-1837.6 291,-1861.6"/>
<text text-anchor="middle" x="253.5" y="-1847.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">frequencies</text>
</g>
<!-- proc~compute_mbe&#45;&gt;frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_edge7" class="edge">
<title>proc~compute_mbe&#45;&gt;frequencies</title>
<path fill="none" stroke="#ff0000" d="M46.35,-1474.8C50.65,-1532.58 71.86,-1778.09 125,-1828.6 146.19,-1848.75 178.86,-1853.83 205.82,-1853.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.9,-1857.45 215.84,-1853.78 205.78,-1850.45 205.9,-1857.45"/>
</g>
<!-- get_message -->
<g id="proc~~compute_mbe~~CallsGraph_node9" class="node">
<title>get_message</title>
<polygon fill="#777777" stroke="#777777" points="295,-1819.6 212,-1819.6 212,-1795.6 295,-1795.6 295,-1819.6"/>
<text text-anchor="middle" x="253.5" y="-1805.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_message</text>
</g>
<!-- proc~compute_mbe&#45;&gt;get_message -->
<g id="proc~~compute_mbe~~CallsGraph_edge8" class="edge">
<title>proc~compute_mbe&#45;&gt;get_message</title>
<path fill="none" stroke="#ff0000" d="M46.72,-1474.82C52.34,-1528.49 77.5,-1742.64 125,-1786.6 145.35,-1805.44 175.77,-1810.98 201.79,-1811.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="201.87,-1815.18 211.89,-1811.72 201.9,-1808.18 201.87,-1815.18"/>
</g>
<!-- has_error -->
<g id="proc~~compute_mbe~~CallsGraph_node10" class="node">
<title>has_error</title>
<polygon fill="#777777" stroke="#777777" points="285,-1777.6 222,-1777.6 222,-1753.6 285,-1753.6 285,-1777.6"/>
<text text-anchor="middle" x="253.5" y="-1763.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">has_error</text>
</g>
<!-- proc~compute_mbe&#45;&gt;has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge9" class="edge">
<title>proc~compute_mbe&#45;&gt;has_error</title>
<path fill="none" stroke="#ff0000" d="M47.2,-1474.88C54.3,-1524.2 83.1,-1707.14 125,-1744.6 148.28,-1765.42 183.95,-1769.81 211.64,-1769.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.94,-1772.97 221.82,-1769.15 211.71,-1765.97 211.94,-1772.97"/>
</g>
<!-- info -->
<g id="proc~~compute_mbe~~CallsGraph_node11" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="857,-511.6 803,-511.6 803,-487.6 857,-487.6 857,-511.6"/>
<text text-anchor="middle" x="830" y="-497.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge10" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M45.54,-1450.36C45.99,-1341.64 51.8,-543.94 125,-471.6 211.2,-386.42 550.11,-433.9 670,-451.6 713.37,-458.01 761.31,-473.74 793.09,-485.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="792.23,-488.87 802.82,-489.1 794.68,-482.31 792.23,-488.87"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_node12" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node12"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="615,-2207.6 473,-2207.6 473,-2183.6 615,-2183.6 615,-2207.6"/>
<text text-anchor="middle" x="544" y="-2193.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_edge11" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#ff0000" d="M46.01,-1474.71C49.8,-1562.53 74.98,-2099.87 125,-2149.6 219.56,-2243.63 391.97,-2226.9 483.01,-2209.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="483.76,-2213.02 492.9,-2207.65 482.41,-2206.15 483.76,-2213.02"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_node13" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node13"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-1735.6 193,-1735.6 193,-1711.6 314,-1711.6 314,-1735.6"/>
<text text-anchor="middle" x="253.5" y="-1721.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_edge12" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#ff0000" d="M45.45,-1474.66C45.98,-1514.28 53.42,-1641.44 125,-1702.6 140.9,-1716.19 162.14,-1722.67 182.71,-1725.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.41,-1728.9 192.72,-1726.47 183.15,-1721.94 182.41,-1728.9"/>
</g>
<!-- proc~compute_mbe_dipole -->
<g id="proc~~compute_mbe~~CallsGraph_node14" class="node">
<title>proc~compute_mbe_dipole</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node14"><a xlink:href="../proc/compute_mbe_dipole.html" xlink:title="compute_mbe_dipole">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-1987.6 190,-1987.6 190,-1963.6 317,-1963.6 317,-1987.6"/>
<text text-anchor="middle" x="253.5" y="-1973.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_dipole</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole -->
<g id="proc~~compute_mbe~~CallsGraph_edge13" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole</title>
<path fill="none" stroke="#ff0000" d="M45.62,-1474.62C46.56,-1543.15 54.75,-1884.14 125,-1954.6 139.36,-1969.01 159.55,-1975.85 179.63,-1978.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.45,-1982.17 189.77,-1979.77 180.21,-1975.21 179.45,-1982.17"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_node15" class="node">
<title>proc~compute_mbe_dipole_derivatives</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node15"><a xlink:href="../proc/compute_mbe_dipole_derivatives.html" xlink:title="compute_mbe_dipole_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="349,-1693.6 158,-1693.6 158,-1669.6 349,-1669.6 349,-1693.6"/>
<text text-anchor="middle" x="253.5" y="-1679.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_dipole_derivatives</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge14" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole_derivatives</title>
<path fill="none" stroke="#ff0000" d="M46.4,-1474.77C49.7,-1509.87 64.32,-1611.93 125,-1660.6 131.99,-1666.21 139.91,-1670.58 148.29,-1673.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="147.33,-1677.34 157.93,-1677.38 149.67,-1670.74 147.33,-1677.34"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node16" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node16"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="323,-1609.6 184,-1609.6 184,-1585.6 323,-1585.6 323,-1609.6"/>
<text text-anchor="middle" x="253.5" y="-1595.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge15" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#ff0000" d="M50.88,-1474.94C61.49,-1497.75 87.43,-1546.39 125,-1570.6 139.55,-1579.98 156.78,-1586.16 173.8,-1590.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.26,-1593.69 183.78,-1592.38 174.74,-1586.85 173.26,-1593.69"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node17" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node17"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="321,-1651.6 186,-1651.6 186,-1627.6 321,-1627.6 321,-1651.6"/>
<text text-anchor="middle" x="253.5" y="-1637.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge16" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#ff0000" d="M47.81,-1474.77C54.18,-1504.67 74.94,-1582 125,-1618.6 139.67,-1629.33 157.82,-1635.37 175.78,-1638.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.3,-1642.08 185.71,-1640.15 176.36,-1635.17 175.3,-1642.08"/>
</g>
<!-- proc~compute_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_node18" class="node">
<title>proc~compute_thermochemistry</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node18"><a xlink:href="../proc/compute_thermochemistry.html" xlink:title="compute_thermochemistry">
<polygon fill="#d9534f" stroke="#d9534f" points="622.5,-797.6 465.5,-797.6 465.5,-773.6 622.5,-773.6 622.5,-797.6"/>
<text text-anchor="middle" x="544" y="-783.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_thermochemistry</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_edge17" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M45.71,-1450.46C47.14,-1379.6 57.69,-1019.8 125,-937.6 206.39,-838.21 358.52,-803.81 455.08,-791.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="455.6,-795.37 465.12,-790.72 454.78,-788.42 455.6,-795.37"/>
</g>
<!-- proc~compute_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_node19" class="node">
<title>proc~compute_vibrational_analysis</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node19"><a xlink:href="../proc/compute_vibrational_analysis.html" xlink:title="compute_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="629,-1285.6 459,-1285.6 459,-1261.6 629,-1261.6 629,-1285.6"/>
<text text-anchor="middle" x="544" y="-1271.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_edge18" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M46.96,-1450.42C51.56,-1418.11 68.94,-1330.09 125,-1292.6 235.66,-1218.61 402.07,-1240.81 487.72,-1259.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="486.98,-1262.83 497.5,-1261.59 488.51,-1256 486.98,-1262.83"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_node20" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node20"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="321.5,-1367.6 185.5,-1367.6 185.5,-1343.6 321.5,-1343.6 321.5,-1367.6"/>
<text text-anchor="middle" x="253.5" y="-1353.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge19" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#ff0000" d="M53.69,-1450.51C66.6,-1432.45 93.49,-1398.73 125,-1381.6 140.35,-1373.26 158.06,-1367.59 175.3,-1363.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.28,-1367.1 185.37,-1361.66 174.88,-1360.24 176.28,-1367.1"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node21" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node21"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-1325.6 125,-1325.6 125,-1301.6 382,-1301.6 382,-1325.6"/>
<text text-anchor="middle" x="253.5" y="-1311.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge20" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#ff0000" d="M49.26,-1450.3C57.93,-1424.22 81.94,-1363.38 125,-1334.6 127.32,-1333.05 129.72,-1331.6 132.19,-1330.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.93,-1333.29 141.36,-1325.74 130.84,-1327.01 133.93,-1333.29"/>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_node22" class="node">
<title>proc~map_fragment_to_system_dipole_derivatives</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node22"><a xlink:href="../proc/map_fragment_to_system_dipole_derivatives.html" xlink:title="map_fragment_to_system_dipole_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="670,-1693.6 418,-1693.6 418,-1669.6 670,-1669.6 670,-1693.6"/>
<text text-anchor="middle" x="544" y="-1679.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_dipole_derivatives</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge21" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_dipole_derivatives</title>
<path fill="none" stroke="#ff0000" d="M55.1,-1474.67C68.77,-1490.92 95.47,-1519.44 125,-1533.6 229.41,-1583.7 290.93,-1505.07 382,-1576.6 413.94,-1601.7 386.07,-1635.5 418,-1660.6 419.62,-1661.88 421.29,-1663.09 423.01,-1664.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="421.51,-1667.42 431.91,-1669.47 425.06,-1661.39 421.51,-1667.42"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node23" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node23"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="644,-1607.6 444,-1607.6 444,-1583.6 644,-1583.6 644,-1607.6"/>
<text text-anchor="middle" x="544" y="-1593.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge22" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#ff0000" d="M89.19,-1462.47C154.54,-1463.46 280.89,-1470.08 382,-1503.6 434.01,-1520.85 488.03,-1555.83 518.39,-1577.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="516.51,-1580.29 526.67,-1583.29 520.59,-1574.61 516.51,-1580.29"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node24" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node24"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="642,-1651.6 446,-1651.6 446,-1627.6 642,-1627.6 642,-1651.6"/>
<text text-anchor="middle" x="544" y="-1637.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#ff0000" d="M68.93,-1474.72C84.47,-1482.29 105.52,-1491.7 125,-1497.6 235.98,-1531.21 289.38,-1472.83 382,-1542.6 411.21,-1564.61 388.88,-1594.47 418,-1616.6 423.61,-1620.87 429.76,-1624.42 436.23,-1627.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="435.34,-1630.8 445.92,-1631.31 437.96,-1624.31 435.34,-1630.8"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node25" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node25"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="619,-1104.6 469,-1104.6 469,-1080.6 619,-1080.6 619,-1104.6"/>
<text text-anchor="middle" x="544" y="-1090.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#ff0000" d="M46.19,-1450.38C48.98,-1412.96 62.45,-1298.75 125,-1236.6 215.75,-1146.44 365.53,-1112.64 458.99,-1100.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="459.51,-1103.49 468.98,-1098.74 458.61,-1096.55 459.51,-1103.49"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_node26" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node26"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="632.5,-343.6 455.5,-343.6 455.5,-319.6 632.5,-319.6 632.5,-343.6"/>
<text text-anchor="middle" x="544" y="-329.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_edge25" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#ff0000" d="M45.47,-1450.32C45.3,-1335.91 46.59,-458.93 125,-377.6 146.82,-354.98 328.48,-341.97 445.03,-335.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.24,-339.38 455.05,-335.37 444.88,-332.39 445.24,-339.38"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node27" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node27"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="630.5,-484.6 457.5,-484.6 457.5,-460.6 630.5,-460.6 630.5,-484.6"/>
<text text-anchor="middle" x="544" y="-470.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge26" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#ff0000" d="M45.81,-1450.39C48.51,-1349.89 68.94,-661.22 125,-590.6 201.19,-494.64 349.08,-472.96 446.94,-469.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="447.23,-473.42 457.14,-469.67 447.05,-466.42 447.23,-473.42"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_node28" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node28"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="615,-404.6 473,-404.6 473,-380.6 615,-380.6 615,-404.6"/>
<text text-anchor="middle" x="544" y="-390.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_edge27" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#ff0000" d="M45.48,-1450.41C45.44,-1338.68 47.67,-494.87 125,-418.6 171.01,-373.23 354.68,-378.33 462.64,-385.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="462.62,-389.2 472.84,-386.41 463.11,-382.22 462.62,-389.2"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_node29" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node29"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="327.5,-623.6 179.5,-623.6 179.5,-599.6 327.5,-599.6 327.5,-623.6"/>
<text text-anchor="middle" x="253.5" y="-609.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_edge28" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M45.31,-1450.26C44.63,-1384.87 45.88,-1072.94 125,-835.6 151.99,-754.65 209.53,-670 237.12,-632.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="240.04,-634.02 243.15,-623.89 234.4,-629.87 240.04,-634.02"/>
</g>
<!-- proc~print_vibrational_json_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_node30" class="node">
<title>proc~print_vibrational_json_mbe</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node30"><a xlink:href="../proc/print_vibrational_json_mbe.html" xlink:title="print_vibrational_json_mbe">
<polygon fill="#d9534f" stroke="#d9534f" points="331.5,-252.6 175.5,-252.6 175.5,-228.6 331.5,-228.6 331.5,-252.6"/>
<text text-anchor="middle" x="253.5" y="-238.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_json_mbe</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_json_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_edge29" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_json_mbe</title>
<path fill="none" stroke="#ff0000" d="M45.57,-1450.3C46.35,-1331.77 54.7,-394.97 125,-295.6 138.4,-276.66 159.75,-264.19 181.18,-256"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.41,-259.27 190.67,-252.64 180.07,-252.68 182.41,-259.27"/>
</g>
<!-- reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_node31" class="node">
<title>reduced_masses</title>
<polygon fill="#777777" stroke="#777777" points="304,-328.6 203,-328.6 203,-304.6 304,-304.6 304,-328.6"/>
<text text-anchor="middle" x="253.5" y="-314.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduced_masses</text>
</g>
<!-- proc~compute_mbe&#45;&gt;reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_edge30" class="edge">
<title>proc~compute_mbe&#45;&gt;reduced_masses</title>
<path fill="none" stroke="#ff0000" d="M45.49,-1450.34C45.49,-1334.19 48.02,-430.33 125,-342.6 141.7,-323.58 168.21,-316.23 192.74,-313.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="192.99,-317.47 202.74,-313.32 192.53,-310.48 192.99,-317.47"/>
</g>
<!-- to_char -->
<g id="proc~~compute_mbe~~CallsGraph_node32" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1435.5,-745.6 1381.5,-745.6 1381.5,-721.6 1435.5,-721.6 1435.5,-745.6"/>
<text text-anchor="middle" x="1408.5" y="-731.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M45.55,-1450.3C46.11,-1327.66 52.91,-327.64 125,-219.6 239.95,-47.32 335.89,-13.6 543,-13.6 543,-13.6 543,-13.6 831,-13.6 1022.58,-13.6 1116.41,45.61 1256,-85.6 1350.73,-174.65 1395.99,-607.92 1405.55,-711.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1402.06,-711.71 1406.45,-721.35 1409.03,-711.07 1402.06,-711.71"/>
</g>
<!-- warning -->
<g id="proc~~compute_mbe~~CallsGraph_node33" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="1150.5,-963.6 1095.5,-963.6 1095.5,-939.6 1150.5,-939.6 1150.5,-963.6"/>
<text text-anchor="middle" x="1123" y="-949.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~compute_mbe&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge32" class="edge">
<title>proc~compute_mbe&#45;&gt;warning</title>
<path fill="none" stroke="#ff0000" d="M46.55,-1450.59C51.65,-1394.72 75.72,-1161 125,-1110.6 311.07,-920.31 442.43,-1002.51 706,-965.6 844.81,-946.17 1012.08,-948.15 1085,-950.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1084.96,-953.75 1095.06,-950.56 1085.18,-946.75 1084.96,-953.75"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge40" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#1fff00" d="M615.4,-2186.28C726.29,-2170.93 931.44,-2139.53 954,-2114.6 1010.03,-2052.7 932.33,-1800.99 990,-1740.6 1072.48,-1654.24 1174.76,-1790.14 1256,-1702.6 1296.45,-1659.02 1282.32,-1227.28 1292,-1168.6 1318.62,-1007.17 1378.96,-818.81 1400.05,-755.56"/>
<polygon fill="#1fff00" stroke="#1fff00" points="1403.44,-756.47 1403.31,-745.87 1396.81,-754.24 1403.44,-756.47"/>
</g>
<!-- debug -->
<g id="proc~~compute_mbe~~CallsGraph_node37" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="857,-2051.6 803,-2051.6 803,-2027.6 857,-2027.6 857,-2051.6"/>
<text text-anchor="middle" x="830" y="-2037.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge33" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#1fff00" d="M565.44,-2183.58C595.87,-2165.76 654.99,-2131.44 706,-2103.6 736.17,-2087.15 770.94,-2069.14 795.8,-2056.43"/>
<polygon fill="#1fff00" stroke="#1fff00" points="797.49,-2059.5 804.81,-2051.84 794.31,-2053.26 797.49,-2059.5"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_node39" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="883,-2207.6 777,-2207.6 777,-2183.6 883,-2183.6 883,-2207.6"/>
<text text-anchor="middle" x="830" y="-2193.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_edge34" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#1fff00" d="M615.2,-2195.6C661.68,-2195.6 722.09,-2195.6 766.83,-2195.6"/>
<polygon fill="#1fff00" stroke="#1fff00" points="766.98,-2199.1 776.98,-2195.6 766.98,-2192.1 766.98,-2199.1"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_node58" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node58"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1200,-1773.6 1046,-1773.6 1046,-1749.6 1200,-1749.6 1200,-1773.6"/>
<text text-anchor="middle" x="1123" y="-1759.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_edge35" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#1fff00" d="M567.65,-2207.61C598.1,-2223 654.38,-2248.87 706,-2258.6 760.16,-2268.82 913.59,-2296.08 954,-2258.6 1031.79,-2186.48 918.14,-1860.64 990,-1782.6 1001.89,-1769.69 1018.28,-1762.58 1035.48,-1758.96"/>
<polygon fill="#1fff00" stroke="#1fff00" points="1036.4,-1762.35 1045.66,-1757.22 1035.22,-1755.45 1036.4,-1762.35"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_node60" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node60"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1192.5,-1483.6 1053.5,-1483.6 1053.5,-1459.6 1192.5,-1459.6 1192.5,-1483.6"/>
<text text-anchor="middle" x="1123" y="-1469.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge36" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#1fff00" d="M580.78,-2183.51C613.39,-2172.52 662.9,-2155.87 706,-2141.6 816.08,-2105.17 882.98,-2152.26 954,-2060.6 1031.46,-1960.63 904.89,-1586.16 990,-1492.6 1003.63,-1477.63 1023.3,-1470.42 1043.31,-1467.43"/>
<polygon fill="#1fff00" stroke="#1fff00" points="1043.93,-1470.88 1053.46,-1466.25 1043.12,-1463.93 1043.93,-1470.88"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_node63" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node63"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="947.5,-2371.6 712.5,-2371.6 712.5,-2347.6 947.5,-2347.6 947.5,-2371.6"/>
<text text-anchor="middle" x="830" y="-2357.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_edge37" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#1fff00" d="M554.38,-2207.65C577.04,-2235.78 637.92,-2305.92 706,-2338.6 710.35,-2340.69 714.87,-2342.58 719.5,-2344.28"/>
<polygon fill="#1fff00" stroke="#1fff00" points="718.56,-2347.65 729.15,-2347.51 720.78,-2341.01 718.56,-2347.65"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_node64" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node64"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-2329.6 706,-2329.6 706,-2305.6 954,-2305.6 954,-2329.6"/>
<text text-anchor="middle" x="830" y="-2315.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_edge38" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#1fff00" d="M560.98,-2207.61C588.9,-2227.99 649.03,-2269.31 706,-2291.6 717.63,-2296.15 730.2,-2299.97 742.72,-2303.15"/>
<polygon fill="#1fff00" stroke="#1fff00" points="742.18,-2306.62 752.72,-2305.57 743.82,-2299.82 742.18,-2306.62"/>
</g>
<!-- start -->
<g id="proc~~compute_mbe~~CallsGraph_node75" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="857,-2249.6 803,-2249.6 803,-2225.6 857,-2225.6 857,-2249.6"/>
<text text-anchor="middle" x="830" y="-2235.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~compute_mbe~~CallsGraph_edge39" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#1fff00" d="M615.2,-2205.99C671.47,-2214.31 748.14,-2225.65 792.73,-2232.24"/>
<polygon fill="#1fff00" stroke="#1fff00" points="792.41,-2235.73 802.81,-2233.73 793.43,-2228.81 792.41,-2235.73"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge41" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff0f" d="M314.32,-1719.91C338.1,-1721.6 364.03,-1727.86 382,-1744.6 432.48,-1791.63 369.44,-1846.6 418,-1895.6 468.61,-1946.69 681.87,-1979.26 779.64,-1991.78"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="779.5,-1995.29 789.86,-1993.07 780.38,-1988.35 779.5,-1995.29"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge42" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#00ff0f" d="M314.14,-1720.5C337.75,-1722.3 363.6,-1728.5 382,-1744.6 423.26,-1780.72 373.93,-1829.98 418,-1862.6 455.42,-1890.31 1220.56,-1885.8 1256,-1855.6 1323.08,-1798.45 1263.87,-1744.13 1292,-1660.6 1319.12,-1580.08 1369.99,-1492.36 1394.13,-1452.92"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="1397.38,-1454.31 1399.66,-1443.96 1391.43,-1450.63 1397.38,-1454.31"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_node62" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node62"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="663,-1853.6 425,-1853.6 425,-1829.6 663,-1829.6 663,-1853.6"/>
<text text-anchor="middle" x="544" y="-1839.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge43" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff0f" d="M314.32,-1721.98C337.41,-1724.12 362.83,-1730.16 382,-1744.6 411.85,-1767.1 388.19,-1798.06 418,-1820.6 419.85,-1822.01 421.77,-1823.33 423.73,-1824.57"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="422.22,-1827.74 432.66,-1829.57 425.64,-1821.63 422.22,-1827.74"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_node67" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node67"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="609,-1811.6 479,-1811.6 479,-1787.6 609,-1787.6 609,-1811.6"/>
<text text-anchor="middle" x="544" y="-1797.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge44" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff0f" d="M314.09,-1727.03C336.15,-1729.93 360.91,-1735.17 382,-1744.6 400.75,-1753 399.43,-1764.82 418,-1773.6 433.75,-1781.05 451.6,-1786.37 468.79,-1790.18"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="468.31,-1793.65 478.81,-1792.24 469.73,-1786.8 468.31,-1793.65"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge45" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff3f" d="M317.08,-1978C432.21,-1982.41 675.38,-1991.72 779.73,-1995.72"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="779.86,-1999.23 789.98,-1996.11 780.12,-1992.23 779.86,-1999.23"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge46" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;error</title>
<path fill="none" stroke="#00ff3f" d="M277.58,-1987.72C399.19,-2049.73 970.7,-2318.09 1256,-2041.6 1317.07,-1982.42 1268.44,-1742.32 1292,-1660.6 1315.64,-1578.61 1368.61,-1491.05 1393.75,-1452.2"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1396.68,-1454.11 1399.23,-1443.83 1390.83,-1450.28 1396.68,-1454.11"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge47" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff3f" d="M317.32,-1970.93C338.43,-1967.89 361.75,-1962.87 382,-1954.6 438.06,-1931.72 493.71,-1886.32 522.61,-1860.58"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="524.96,-1863.17 530.04,-1853.87 520.27,-1857.98 524.96,-1863.17"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge48" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff3f" d="M317.02,-1978.81C339.95,-1976.79 364.54,-1970.41 382,-1954.6 427.71,-1913.22 372.35,-1862.07 418,-1820.6 431.88,-1808 450.36,-1801.46 468.85,-1798.34"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="469.36,-1801.8 478.79,-1796.98 468.41,-1794.87 469.36,-1801.8"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives&#45;&gt;proc~map_fragment_to_system_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge51" class="edge">
<title>proc~compute_mbe_dipole_derivatives&#45;&gt;proc~map_fragment_to_system_dipole_derivatives</title>
<path fill="none" stroke="#00ff6f" d="M349.37,-1681.6C368.12,-1681.6 388.14,-1681.6 407.94,-1681.6"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="407.94,-1685.1 417.94,-1681.6 407.94,-1678.1 407.94,-1685.1"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge49" class="edge">
<title>proc~compute_mbe_dipole_derivatives&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff6f" d="M349.06,-1684.88C361.13,-1688.67 372.55,-1694.33 382,-1702.6 423.26,-1738.72 376.8,-1784.43 418,-1820.6 419.34,-1821.78 420.71,-1822.9 422.12,-1823.97"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="420.31,-1826.96 430.58,-1829.55 424.16,-1821.12 420.31,-1826.96"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge50" class="edge">
<title>proc~compute_mbe_dipole_derivatives&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff6f" d="M349.12,-1686.82C360.91,-1690.37 372.23,-1695.44 382,-1702.6 410.54,-1723.52 389.91,-1752.1 418,-1773.6 432.63,-1784.8 450.93,-1791.47 468.99,-1795.37"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="468.49,-1798.84 478.96,-1797.26 469.79,-1791.96 468.49,-1798.84"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge52" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff9f" d="M323.31,-1595.44C344.25,-1598.08 365.95,-1604.59 382,-1618.6 422.98,-1654.39 377.12,-1699.7 418,-1735.6 503.37,-1810.58 580.76,-1708.28 670,-1778.6 701.9,-1803.75 684.02,-1828.45 706,-1862.6 735.55,-1908.51 780.99,-1953.74 807.58,-1978.43"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="805.46,-1981.23 815.19,-1985.41 810.19,-1976.07 805.46,-1981.23"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge53" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;error</title>
<path fill="none" stroke="#00ff9f" d="M323.11,-1596.57C343.8,-1599.31 365.4,-1605.6 382,-1618.6 413.97,-1643.65 385.62,-1678.09 418,-1702.6 508.06,-1770.79 572.18,-1679.12 670,-1735.6 692.79,-1748.76 683.32,-1769.26 706,-1782.6 719.75,-1790.7 974.09,-1823.44 990,-1824.6 1107.9,-1833.28 1163.88,-1898.7 1256,-1824.6 1314.15,-1777.84 1267,-1730.92 1292,-1660.6 1320.47,-1580.54 1370.67,-1492.6 1394.39,-1453.01"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="1397.64,-1454.39 1399.82,-1444.02 1391.65,-1450.77 1397.64,-1454.39"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge56" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#00ff9f" d="M323.24,-1597.13C356.22,-1596.9 396.54,-1596.62 433.59,-1596.36"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="433.97,-1599.86 443.95,-1596.29 433.92,-1592.86 433.97,-1599.86"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge54" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff9f" d="M323.03,-1594.15C344.46,-1596.6 366.51,-1603.32 382,-1618.6 446.9,-1682.66 353.2,-1756.44 418,-1820.6 418.97,-1821.56 419.96,-1822.49 420.98,-1823.38"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="419.14,-1826.37 429.23,-1829.58 423.34,-1820.78 419.14,-1826.37"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge55" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff9f" d="M323.24,-1594.7C344.43,-1597.24 366.28,-1603.88 382,-1618.6 433.61,-1666.96 367.42,-1724.18 418,-1773.6 431.64,-1786.93 450.23,-1794.24 468.9,-1798.07"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="468.5,-1801.55 478.95,-1799.81 469.7,-1794.65 468.5,-1801.55"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge59" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#00ffcf" d="M321.05,-1639.6C355.04,-1639.6 397.23,-1639.6 435.67,-1639.6"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="435.88,-1643.1 445.88,-1639.6 435.88,-1636.1 435.88,-1643.1"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge57" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ffcf" d="M321.32,-1636.41C343.12,-1638.77 365.85,-1645.36 382,-1660.6 435.01,-1710.63 365.07,-1770.5 418,-1820.6 419.12,-1821.67 420.28,-1822.69 421.47,-1823.67"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="419.53,-1826.59 429.7,-1829.56 423.6,-1820.89 419.53,-1826.59"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge58" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ffcf" d="M321.25,-1637.3C342.79,-1639.78 365.37,-1646.23 382,-1660.6 421.88,-1695.07 378.85,-1738.31 418,-1773.6 432.02,-1786.25 450.56,-1793.36 469.04,-1797.21"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="468.52,-1800.68 478.98,-1798.99 469.75,-1793.79 468.52,-1800.68"/>
</g>
<!-- proc~compute_electronic_entropy -->
<g id="proc~~compute_mbe~~CallsGraph_node45" class="node">
<title>proc~compute_electronic_entropy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node45"><a xlink:href="../proc/compute_electronic_entropy.html" xlink:title="compute_electronic_entropy">
<polygon fill="#d9534f" stroke="#d9534f" points="911.5,-881.6 748.5,-881.6 748.5,-857.6 911.5,-857.6 911.5,-881.6"/>
<text text-anchor="middle" x="830" y="-867.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_electronic_entropy</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_electronic_entropy -->
<g id="proc~~compute_mbe~~CallsGraph_edge60" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_electronic_entropy</title>
<path fill="none" stroke="#00ffff" d="M570.93,-797.66C602.29,-811.78 656.98,-834.98 706,-848.6 716.39,-851.49 727.38,-854.05 738.36,-856.3"/>
<polygon fill="#00ffff" stroke="#00ffff" points="737.93,-859.78 748.42,-858.27 739.28,-852.91 737.93,-859.78"/>
</g>
<!-- proc~compute_moments_of_inertia -->
<g id="proc~~compute_mbe~~CallsGraph_node48" class="node">
<title>proc~compute_moments_of_inertia</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node48"><a xlink:href="../proc/compute_moments_of_inertia.html" xlink:title="compute_moments_of_inertia">
<polygon fill="#d9534f" stroke="#d9534f" points="915.5,-1041.6 744.5,-1041.6 744.5,-1017.6 915.5,-1017.6 915.5,-1041.6"/>
<text text-anchor="middle" x="830" y="-1027.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_moments_of_inertia</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_moments_of_inertia -->
<g id="proc~~compute_mbe~~CallsGraph_edge61" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_moments_of_inertia</title>
<path fill="none" stroke="#00ffff" d="M557.66,-797.74C584.46,-823.31 649.16,-884.35 706,-932.6 739.38,-960.94 779.43,-992.01 804.55,-1011.16"/>
<polygon fill="#00ffff" stroke="#00ffff" points="802.7,-1014.15 812.78,-1017.41 806.94,-1008.57 802.7,-1014.15"/>
</g>
<!-- proc~compute_partition_functions -->
<g id="proc~~compute_mbe~~CallsGraph_node49" class="node">
<title>proc~compute_partition_functions</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node49"><a xlink:href="../proc/compute_partition_functions.html" xlink:title="compute_partition_functions">
<polygon fill="#d9534f" stroke="#d9534f" points="912,-839.6 748,-839.6 748,-815.6 912,-815.6 912,-839.6"/>
<text text-anchor="middle" x="830" y="-825.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partition_functions</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_partition_functions -->
<g id="proc~~compute_mbe~~CallsGraph_edge62" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_partition_functions</title>
<path fill="none" stroke="#00ffff" d="M622.6,-797.08C658.03,-802.32 700.25,-808.56 737.24,-814.03"/>
<polygon fill="#00ffff" stroke="#00ffff" points="737.12,-817.55 747.52,-815.56 738.14,-810.63 737.12,-817.55"/>
</g>
<!-- proc~compute_rotational_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node51" class="node">
<title>proc~compute_rotational_constants</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node51"><a xlink:href="../proc/compute_rotational_constants.html" xlink:title="compute_rotational_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="916,-755.6 744,-755.6 744,-731.6 916,-731.6 916,-755.6"/>
<text text-anchor="middle" x="830" y="-741.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_rotational_constants</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge63" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_constants</title>
<path fill="none" stroke="#00ffff" d="M622.6,-774.13C658.03,-768.89 700.25,-762.65 737.24,-757.18"/>
<polygon fill="#00ffff" stroke="#00ffff" points="738.14,-760.58 747.52,-755.65 737.12,-753.66 738.14,-760.58"/>
</g>
<!-- proc~compute_rotational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_node52" class="node">
<title>proc~compute_rotational_thermo</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node52"><a xlink:href="../proc/compute_rotational_thermo.html" xlink:title="compute_rotational_thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="910,-713.6 750,-713.6 750,-689.6 910,-689.6 910,-713.6"/>
<text text-anchor="middle" x="830" y="-699.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_rotational_thermo</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_edge64" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_thermo</title>
<path fill="none" stroke="#00ffff" d="M570.93,-773.55C602.29,-759.43 656.98,-736.23 706,-722.6 716.82,-719.6 728.29,-716.95 739.72,-714.64"/>
<polygon fill="#00ffff" stroke="#00ffff" points="740.58,-718.03 749.73,-712.69 739.25,-711.16 740.58,-718.03"/>
</g>
<!-- proc~compute_translational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_node53" class="node">
<title>proc~compute_translational_thermo</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node53"><a xlink:href="../proc/compute_translational_thermo.html" xlink:title="compute_translational_thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="918,-671.6 742,-671.6 742,-647.6 918,-647.6 918,-671.6"/>
<text text-anchor="middle" x="830" y="-657.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_translational_thermo</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_translational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_edge65" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_translational_thermo</title>
<path fill="none" stroke="#00ffff" d="M558.97,-773.58C585.61,-751.36 646.35,-703.98 706,-680.6 714.29,-677.35 723.1,-674.61 732.03,-672.28"/>
<polygon fill="#00ffff" stroke="#00ffff" points="732.87,-675.68 741.76,-669.92 731.22,-668.88 732.87,-675.68"/>
</g>
<!-- proc~compute_vibrational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_node55" class="node">
<title>proc~compute_vibrational_thermo</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node55"><a xlink:href="../proc/compute_vibrational_thermo.html" xlink:title="compute_vibrational_thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="913,-923.6 747,-923.6 747,-899.6 913,-899.6 913,-923.6"/>
<text text-anchor="middle" x="830" y="-909.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_thermo</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_vibrational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_edge66" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_vibrational_thermo</title>
<path fill="none" stroke="#00ffff" d="M558.97,-797.63C585.61,-819.85 646.35,-867.23 706,-890.6 715.71,-894.41 726.11,-897.52 736.6,-900.08"/>
<polygon fill="#00ffff" stroke="#00ffff" points="736.15,-903.56 746.67,-902.35 737.69,-896.73 736.15,-903.56"/>
</g>
<!-- proc~compute_zpe -->
<g id="proc~~compute_mbe~~CallsGraph_node56" class="node">
<title>proc~compute_zpe</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node56"><a xlink:href="../proc/compute_zpe.html" xlink:title="compute_zpe">
<polygon fill="#d9534f" stroke="#d9534f" points="872,-591.6 788,-591.6 788,-567.6 872,-567.6 872,-591.6"/>
<text text-anchor="middle" x="830" y="-577.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_zpe</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_zpe -->
<g id="proc~~compute_mbe~~CallsGraph_edge67" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_zpe</title>
<path fill="none" stroke="#00ffff" d="M556.1,-773.25C580.91,-746.19 643.56,-680.74 706,-638.6 731.74,-621.24 763.37,-606.19 788.11,-595.63"/>
<polygon fill="#00ffff" stroke="#00ffff" points="789.7,-598.76 797.57,-591.67 786.99,-592.3 789.7,-598.76"/>
</g>
<!-- proc~compute_cartesian_displacements -->
<g id="proc~~compute_mbe~~CallsGraph_node44" class="node">
<title>proc~compute_cartesian_displacements</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node44"><a xlink:href="../proc/compute_cartesian_displacements.html" xlink:title="compute_cartesian_displacements">
<polygon fill="#d9534f" stroke="#d9534f" points="1221.5,-1365.6 1024.5,-1365.6 1024.5,-1341.6 1221.5,-1341.6 1221.5,-1365.6"/>
<text text-anchor="middle" x="1123" y="-1351.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_cartesian_displacements</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements -->
<g id="proc~~compute_mbe~~CallsGraph_edge68" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements</title>
<path fill="none" stroke="#00cfff" d="M629.21,-1285.28C734.46,-1299.87 914.22,-1324.8 1025.09,-1340.17"/>
<polygon fill="#00cfff" stroke="#00cfff" points="1024.88,-1343.67 1035.27,-1341.58 1025.84,-1336.74 1024.88,-1343.67"/>
</g>
<!-- proc~compute_force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node46" class="node">
<title>proc~compute_force_constants</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node46"><a xlink:href="../proc/compute_force_constants.html" xlink:title="compute_force_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="904,-1365.6 756,-1365.6 756,-1341.6 904,-1341.6 904,-1365.6"/>
<text text-anchor="middle" x="830" y="-1351.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_force_constants</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge69" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants</title>
<path fill="none" stroke="#00cfff" d="M577.35,-1285.68C609.62,-1297.44 660.77,-1315.28 706,-1327.6 721.78,-1331.9 738.87,-1335.91 755.14,-1339.44"/>
<polygon fill="#00cfff" stroke="#00cfff" points="754.63,-1342.91 765.14,-1341.56 756.09,-1336.06 754.63,-1342.91"/>
</g>
<!-- proc~compute_ir_intensities -->
<g id="proc~~compute_mbe~~CallsGraph_node47" class="node">
<title>proc~compute_ir_intensities</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node47"><a xlink:href="../proc/compute_ir_intensities.html" xlink:title="compute_ir_intensities">
<polygon fill="#d9534f" stroke="#d9534f" points="1189,-1159.6 1057,-1159.6 1057,-1135.6 1189,-1135.6 1189,-1159.6"/>
<text text-anchor="middle" x="1123" y="-1145.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ir_intensities</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_ir_intensities -->
<g id="proc~~compute_mbe~~CallsGraph_edge70" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_ir_intensities</title>
<path fill="none" stroke="#00cfff" d="M569.73,-1261.55C600.79,-1246.93 656.09,-1222.63 706,-1209.6 813.59,-1181.52 844.51,-1196.02 954,-1176.6 970.14,-1173.74 973.9,-1171.67 990,-1168.6 1008.36,-1165.11 1028.23,-1161.73 1046.84,-1158.75"/>
<polygon fill="#00cfff" stroke="#00cfff" points="1047.41,-1162.2 1056.74,-1157.18 1046.31,-1155.29 1047.41,-1162.2"/>
</g>
<!-- proc~compute_reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_node50" class="node">
<title>proc~compute_reduced_masses</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node50"><a xlink:href="../proc/compute_reduced_masses.html" xlink:title="compute_reduced_masses">
<polygon fill="#d9534f" stroke="#d9534f" points="1200,-1201.6 1046,-1201.6 1046,-1177.6 1200,-1177.6 1200,-1201.6"/>
<text text-anchor="middle" x="1123" y="-1187.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_reduced_masses</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_edge71" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses</title>
<path fill="none" stroke="#00cfff" d="M627.67,-1261.57C736.15,-1245.78 925.65,-1218.19 1035.84,-1202.15"/>
<polygon fill="#00cfff" stroke="#00cfff" points="1036.53,-1205.58 1045.92,-1200.68 1035.52,-1198.66 1036.53,-1205.58"/>
</g>
<!-- proc~compute_vibrational_frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_node54" class="node">
<title>proc~compute_vibrational_frequencies</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node54"><a xlink:href="../proc/compute_vibrational_frequencies.html" xlink:title="compute_vibrational_frequencies">
<polygon fill="#d9534f" stroke="#d9534f" points="925,-1285.6 735,-1285.6 735,-1261.6 925,-1261.6 925,-1285.6"/>
<text text-anchor="middle" x="830" y="-1271.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_frequencies</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_edge72" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies</title>
<path fill="none" stroke="#00cfff" d="M629.06,-1273.6C659.09,-1273.6 693.3,-1273.6 724.83,-1273.6"/>
<polygon fill="#00cfff" stroke="#00cfff" points="724.96,-1277.1 734.96,-1273.6 724.96,-1270.1 724.96,-1277.1"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_node69" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node69"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619.5,-1367.6 468.5,-1367.6 468.5,-1343.6 619.5,-1343.6 619.5,-1367.6"/>
<text text-anchor="middle" x="544" y="-1353.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge73" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#009fff" d="M321.78,-1355.6C362.39,-1355.6 414.53,-1355.6 457.98,-1355.6"/>
<polygon fill="#009fff" stroke="#009fff" points="458.25,-1359.1 468.25,-1355.6 458.25,-1352.1 458.25,-1359.1"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_node43" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node43"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="913,-1647.6 747,-1647.6 747,-1623.6 913,-1623.6 913,-1647.6"/>
<text text-anchor="middle" x="830" y="-1633.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge74" class="edge">
<title>proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#003fff" d="M619.25,-1669.58C657.73,-1663.35 704.88,-1655.71 744.73,-1649.25"/>
<polygon fill="#003fff" stroke="#003fff" points="745.38,-1652.69 754.69,-1647.64 744.26,-1645.78 745.38,-1652.69"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node61" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node61"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="941.5,-1731.6 718.5,-1731.6 718.5,-1707.6 941.5,-1707.6 941.5,-1731.6"/>
<text text-anchor="middle" x="830" y="-1717.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge75" class="edge">
<title>proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#003fff" d="M634.86,-1693.63C664.79,-1697.63 698.31,-1702.12 728.96,-1706.22"/>
<polygon fill="#003fff" stroke="#003fff" points="728.86,-1709.74 739.24,-1707.59 729.79,-1702.8 728.86,-1709.74"/>
</g>
<!-- proc~redistribute_cap_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_node71" class="node">
<title>proc~redistribute_cap_dipole_derivatives</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node71"><a xlink:href="../proc/redistribute_cap_dipole_derivatives.html" xlink:title="redistribute_cap_dipole_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="930,-1773.6 730,-1773.6 730,-1749.6 930,-1749.6 930,-1773.6"/>
<text text-anchor="middle" x="830" y="-1759.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_dipole_derivatives</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~redistribute_cap_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge76" class="edge">
<title>proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~redistribute_cap_dipole_derivatives</title>
<path fill="none" stroke="#003fff" d="M633.13,-1693.68C645.88,-1697.2 658.56,-1701.74 670,-1707.6 689.32,-1717.5 686.51,-1731.06 706,-1740.6 710.56,-1742.84 715.32,-1744.84 720.21,-1746.64"/>
<polygon fill="#003fff" stroke="#003fff" points="719.13,-1749.97 729.73,-1749.83 721.36,-1743.33 719.13,-1749.97"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge77" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#000fff" d="M644.2,-1601.52C653.84,-1605.53 662.72,-1611.06 670,-1618.6 746.12,-1697.48 659.04,-1763.55 706,-1862.6 729.24,-1911.63 776.36,-1955.43 805.06,-1979.09"/>
<polygon fill="#000fff" stroke="#000fff" points="803,-1981.92 812.98,-1985.49 807.4,-1976.48 803,-1981.92"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge78" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#000fff" d="M555.3,-1583.54C578.97,-1556.68 640.26,-1491.76 706,-1459.6 728.19,-1448.75 754.8,-1442.41 777.58,-1438.72"/>
<polygon fill="#000fff" stroke="#000fff" points="778.38,-1442.14 787.75,-1437.2 777.34,-1435.22 778.38,-1442.14"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge80" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#000fff" d="M559.39,-1583.35C586.23,-1561.22 646.64,-1514.81 706,-1492.6 735.88,-1481.43 958.25,-1453.67 990,-1450.6 1130.43,-1437.06 1298.38,-1433.13 1371.04,-1432.02"/>
<polygon fill="#000fff" stroke="#000fff" points="1371.11,-1435.52 1381.06,-1431.88 1371.01,-1428.52 1371.11,-1435.52"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge79" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#000fff" d="M644.03,-1600.85C653.82,-1604.96 662.79,-1610.7 670,-1618.6 730.13,-1684.55 645.44,-1953.04 706,-2018.6 727.57,-2041.96 764.83,-2045.44 792.7,-2044.15"/>
<polygon fill="#000fff" stroke="#000fff" points="793.13,-2047.63 802.87,-2043.46 792.66,-2040.65 793.13,-2047.63"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge81" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#000fff" d="M630.21,-1607.61C663.82,-1612.34 702.51,-1617.79 736.77,-1622.61"/>
<polygon fill="#000fff" stroke="#000fff" points="736.39,-1626.1 746.78,-1624.02 737.36,-1619.16 736.39,-1626.1"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_node59" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node59"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="910.5,-1525.6 749.5,-1525.6 749.5,-1501.6 910.5,-1501.6 910.5,-1525.6"/>
<text text-anchor="middle" x="830" y="-1511.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_edge82" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#000fff" d="M572.1,-1583.49C603.67,-1569.81 657.69,-1547.75 706,-1534.6 716.75,-1531.68 728.15,-1529.08 739.5,-1526.8"/>
<polygon fill="#000fff" stroke="#000fff" points="740.29,-1530.21 749.44,-1524.87 738.95,-1523.34 740.29,-1530.21"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge83" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#000fff" d="M644.08,-1602.72C748.88,-1608.24 905.66,-1610.12 954,-1576.6 987.38,-1553.46 957.96,-1517.57 990,-1492.6 1005.2,-1480.76 1024.42,-1474.4 1043.46,-1471.19"/>
<polygon fill="#000fff" stroke="#000fff" points="1043.97,-1474.66 1053.38,-1469.8 1042.99,-1467.73 1043.97,-1474.66"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge84" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#000fff" d="M644.16,-1604.36C653.45,-1607.9 662.27,-1612.55 670,-1618.6 700.68,-1642.66 675.16,-1674.75 706,-1698.6 707.81,-1700.01 709.68,-1701.33 711.6,-1702.57"/>
<polygon fill="#000fff" stroke="#000fff" points="709.92,-1705.64 720.34,-1707.56 713.39,-1699.56 709.92,-1705.64"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_node72" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node72"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="907,-1567.6 753,-1567.6 753,-1543.6 907,-1543.6 907,-1567.6"/>
<text text-anchor="middle" x="830" y="-1553.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_edge85" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#000fff" d="M630.21,-1583.6C665.75,-1578.6 706.98,-1572.79 742.65,-1567.77"/>
<polygon fill="#000fff" stroke="#000fff" points="743.13,-1571.23 752.55,-1566.37 742.16,-1564.3 743.13,-1571.23"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge86" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#1f00ff" d="M642.34,-1638.23C672.92,-1637.8 706.58,-1637.33 736.8,-1636.9"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="736.96,-1640.4 746.91,-1636.76 736.86,-1633.4 736.96,-1640.4"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge87" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#1f00ff" d="M642.28,-1649.49C651.94,-1652.36 661.36,-1656 670,-1660.6 690.53,-1671.54 685.48,-1687.64 706,-1698.6 709.71,-1700.59 713.56,-1702.39 717.51,-1704.03"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="716.31,-1707.31 726.9,-1707.56 718.78,-1700.76 716.31,-1707.31"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node73" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node73"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="902,-1689.6 758,-1689.6 758,-1665.6 902,-1665.6 902,-1689.6"/>
<text text-anchor="middle" x="830" y="-1675.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge88" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#1f00ff" d="M634.86,-1651.63C670.95,-1656.46 712.26,-1661.98 747.46,-1666.7"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="747.33,-1670.21 757.7,-1668.06 748.25,-1663.27 747.33,-1670.21"/>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge93" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#4f00ff" d="M562.93,-1080.59C591.74,-1061.91 650.73,-1026.22 706,-1008.6 776.58,-986.11 997.29,-963.41 1085.27,-955"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="1085.69,-958.48 1095.32,-954.05 1085.03,-951.51 1085.69,-958.48"/>
</g>
<!-- header -->
<g id="proc~~compute_mbe~~CallsGraph_node40" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="857,-1167.6 803,-1167.6 803,-1143.6 857,-1143.6 857,-1167.6"/>
<text text-anchor="middle" x="830" y="-1153.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~compute_mbe~~CallsGraph_edge89" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#4f00ff" d="M587.13,-1104.66C619.48,-1113.65 665.34,-1125.85 706,-1134.6 735.09,-1140.87 768.38,-1146.46 792.98,-1150.29"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="792.54,-1153.77 802.96,-1151.83 793.61,-1146.85 792.54,-1153.77"/>
</g>
<!-- level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node42" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="867,-1125.6 793,-1125.6 793,-1101.6 867,-1101.6 867,-1125.6"/>
<text text-anchor="middle" x="830" y="-1111.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge90" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#4f00ff" d="M619.25,-1098.09C670.98,-1101.92 738.38,-1106.9 782.63,-1110.18"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="782.58,-1113.68 792.81,-1110.93 783.09,-1106.7 782.58,-1113.68"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node66" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node66"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="892,-797.6 768,-797.6 768,-773.6 892,-773.6 892,-797.6"/>
<text text-anchor="middle" x="830" y="-783.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge91" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#4f00ff" d="M547.88,-1080.3C559.1,-1035.23 604.44,-878.13 706,-806.6 721.02,-796.03 739.58,-790.15 757.7,-787.03"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="758.3,-790.48 767.69,-785.56 757.29,-783.55 758.3,-790.48"/>
</g>
<!-- verbose -->
<g id="proc~~compute_mbe~~CallsGraph_node76" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="857.5,-1083.6 802.5,-1083.6 802.5,-1059.6 857.5,-1059.6 857.5,-1083.6"/>
<text text-anchor="middle" x="830" y="-1069.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~compute_mbe~~CallsGraph_edge92" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#4f00ff" d="M619.25,-1087.11C674.82,-1083.01 748.47,-1077.56 792.08,-1074.33"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="792.52,-1077.81 802.23,-1073.58 792,-1070.83 792.52,-1077.81"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge98" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#7f00ff" d="M598.86,-343.62C630.05,-350.34 670.13,-358.55 706,-364.6 760.82,-373.86 907.92,-366.5 954,-397.6 1179.67,-549.94 1173.71,-671.07 1256,-930.6 1305.13,-1085.57 1228.77,-1144.84 1292,-1294.6 1312.73,-1343.69 1357.42,-1388.42 1384.73,-1412.65"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1382.76,-1415.58 1392.61,-1419.5 1387.36,-1410.29 1382.76,-1415.58"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge99" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#7f00ff" d="M620.51,-343.67C638.52,-349.6 656.43,-358.43 670,-371.6 704.49,-405.09 669.85,-441.91 706,-473.6 729.69,-494.38 765.76,-499.99 792.73,-500.94"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="792.89,-504.44 802.94,-501.09 792.99,-497.44 792.89,-504.44"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge104" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#7f00ff" d="M594.79,-343.63C618.29,-350.28 646.3,-359.64 670,-371.6 687.62,-380.5 688.41,-388.66 706,-397.6 809.35,-450.18 870.97,-397.67 954,-478.6 1088.15,-609.36 1115.46,-854.04 1120.77,-929.12"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1117.29,-929.55 1121.43,-939.3 1124.28,-929.1 1117.29,-929.55"/>
</g>
<!-- add -->
<g id="proc~~compute_mbe~~CallsGraph_node34" class="node">
<title>add</title>
<polygon fill="#777777" stroke="#777777" points="857,-271.6 803,-271.6 803,-247.6 857,-247.6 857,-271.6"/>
<text text-anchor="middle" x="830" y="-257.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add</text>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;add -->
<g id="proc~~compute_mbe~~CallsGraph_edge94" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;add</title>
<path fill="none" stroke="#7f00ff" d="M578.23,-319.6C610.52,-308.28 661.12,-291.49 706,-280.6 734.92,-273.59 768.22,-268.06 792.87,-264.44"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="793.47,-267.89 802.87,-263 792.48,-260.96 793.47,-267.89"/>
</g>
<!-- create_array -->
<g id="proc~~compute_mbe~~CallsGraph_node35" class="node">
<title>create_array</title>
<polygon fill="#777777" stroke="#777777" points="870,-355.6 790,-355.6 790,-331.6 870,-331.6 870,-355.6"/>
<text text-anchor="middle" x="830" y="-341.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_array</text>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;create_array -->
<g id="proc~~compute_mbe~~CallsGraph_edge95" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;create_array</title>
<path fill="none" stroke="#7f00ff" d="M632.53,-335.3C680.95,-337.35 739.34,-339.82 779.82,-341.53"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="779.83,-345.03 789.97,-341.96 780.13,-338.04 779.83,-345.03"/>
</g>
<!-- create_object -->
<g id="proc~~compute_mbe~~CallsGraph_node36" class="node">
<title>create_object</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-229.6 787.5,-229.6 787.5,-205.6 872.5,-205.6 872.5,-229.6"/>
<text text-anchor="middle" x="830" y="-215.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_object</text>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;create_object -->
<g id="proc~~compute_mbe~~CallsGraph_edge96" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;create_object</title>
<path fill="none" stroke="#7f00ff" d="M561.41,-319.45C589.49,-299.28 649.22,-259.1 706,-238.6 728.71,-230.41 754.95,-225.37 777.35,-222.29"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="777.87,-225.75 787.34,-221.01 776.98,-218.81 777.87,-225.75"/>
</g>
<!-- destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node38" class="node">
<title>destroy</title>
<polygon fill="#777777" stroke="#777777" points="857,-187.6 803,-187.6 803,-163.6 857,-163.6 857,-187.6"/>
<text text-anchor="middle" x="830" y="-173.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">destroy</text>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge97" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;destroy</title>
<path fill="none" stroke="#7f00ff" d="M563.8,-319.55C589.17,-302.86 635.2,-271.09 670,-238.6 687.97,-221.83 684.61,-208.73 706,-196.6 732.5,-181.58 767,-176.73 792.72,-175.4"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="792.94,-178.9 802.8,-175.04 792.68,-171.9 792.94,-178.9"/>
</g>
<!-- initialize -->
<g id="proc~~compute_mbe~~CallsGraph_node41" class="node">
<title>initialize</title>
<polygon fill="#777777" stroke="#777777" points="858.5,-145.6 801.5,-145.6 801.5,-121.6 858.5,-121.6 858.5,-145.6"/>
<text text-anchor="middle" x="830" y="-131.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initialize</text>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;initialize -->
<g id="proc~~compute_mbe~~CallsGraph_edge100" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;initialize</title>
<path fill="none" stroke="#7f00ff" d="M568.2,-319.39C595.74,-303.87 641.52,-274.7 670,-238.6 695.16,-206.72 674.1,-179.75 706,-154.6 729.96,-135.72 764.77,-131.26 791.25,-131.06"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="791.27,-134.57 801.31,-131.19 791.36,-127.57 791.27,-134.57"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_node65" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node65"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="875.5,-103.6 784.5,-103.6 784.5,-79.6 875.5,-79.6 875.5,-103.6"/>
<text text-anchor="middle" x="830" y="-89.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_edge101" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#7f00ff" d="M569.75,-319.58C598.13,-304.53 644.09,-276.1 670,-238.6 703.11,-190.69 662.63,-151.48 706,-112.6 724.34,-96.17 750.64,-90.19 774.22,-88.62"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="774.63,-92.1 784.48,-88.19 774.34,-85.11 774.63,-92.1"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge102" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#7f00ff" d="M629.02,-343.69C644.75,-349.68 659.52,-358.54 670,-371.6 724.89,-440.01 646.44,-700.23 706,-764.6 719.28,-778.96 738.49,-785.8 757.79,-788.64"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="757.53,-792.14 767.86,-789.79 758.32,-785.18 757.53,-792.14"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_node68" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node68"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="904.5,-313.6 755.5,-313.6 755.5,-289.6 904.5,-289.6 904.5,-313.6"/>
<text text-anchor="middle" x="830" y="-299.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_edge103" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#7f00ff" d="M632.53,-322.36C668.28,-318.58 709.45,-314.23 744.85,-310.49"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="745.57,-313.94 755.15,-309.41 744.84,-306.98 745.57,-313.94"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge105" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#af00ff" d="M630.59,-480.74C684.83,-485.9 752.18,-492.3 792.81,-496.16"/>
<polygon fill="#af00ff" stroke="#af00ff" points="792.51,-499.65 802.79,-497.11 793.17,-492.68 792.51,-499.65"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge106" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#df00ff" d="M615.02,-397.31C634.07,-401.12 653.88,-407.62 670,-418.6 694.14,-435.06 681.88,-457.11 706,-473.6 731.49,-491.04 766.39,-497.14 792.5,-499.12"/>
<polygon fill="#df00ff" stroke="#df00ff" points="792.55,-502.63 802.74,-499.72 792.96,-495.64 792.55,-502.63"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge107" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#df00ff" d="M602.88,-404.61C624.01,-409 648.09,-414.01 670,-418.6 938.37,-474.86 1021.72,-469.12 1256,-611.6 1306.95,-642.59 1359.69,-688.87 1387.51,-714.61"/>
<polygon fill="#df00ff" stroke="#df00ff" points="1385.3,-717.33 1395,-721.59 1390.07,-712.21 1385.3,-717.33"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge108" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;info</title>
<path fill="none" stroke="#ff00ef" d="M311.92,-599.57C343.24,-593.13 382.7,-585.18 418,-578.6 529.7,-557.81 559.12,-560.4 670,-535.6 686.21,-531.98 689.87,-529.55 706,-525.6 735.13,-518.49 768.41,-511.52 793.01,-506.6"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="793.85,-510 802.98,-504.61 792.49,-503.13 793.85,-510"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_edge109" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff00ef" d="M274.79,-623.84C325.07,-654.17 455.59,-732.89 514,-768.12"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="512.36,-771.22 522.74,-773.38 515.98,-765.22 512.36,-771.22"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge112" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;warning</title>
<path fill="none" stroke="#ff00ef" d="M327.79,-610.36C496.52,-608.08 901.95,-606.09 954,-638.6 1062.58,-706.43 1105.53,-870.06 1117.9,-929.53"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="1114.47,-930.25 1119.86,-939.37 1121.34,-928.88 1114.47,-930.25"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_node57" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node57"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1490,-1243.6 1327,-1243.6 1327,-1219.6 1490,-1219.6 1490,-1243.6"/>
<text text-anchor="middle" x="1408.5" y="-1229.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge110" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#ff00ef" d="M327.8,-610.08C411.51,-607.07 552.1,-598.12 670,-571.6 686.6,-567.87 689.24,-561.54 706,-558.6 814.57,-539.6 854.49,-511.21 954,-558.6 1146.27,-650.17 1172.11,-734.87 1256,-930.6 1280.71,-988.27 1248.81,-1165.11 1292,-1210.6 1299.05,-1218.03 1307.78,-1223.35 1317.27,-1227.11"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="1316.37,-1230.5 1326.97,-1230.36 1318.6,-1223.86 1316.37,-1230.5"/>
</g>
<!-- proc~print_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_node70" class="node">
<title>proc~print_thermochemistry</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node70"><a xlink:href="../proc/print_thermochemistry.html" xlink:title="print_thermochemistry">
<polygon fill="#d9534f" stroke="#d9534f" points="611,-526.6 477,-526.6 477,-502.6 611,-502.6 611,-526.6"/>
<text text-anchor="middle" x="544" y="-512.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_thermochemistry</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~print_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_edge111" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~print_thermochemistry</title>
<path fill="none" stroke="#ff00ef" d="M278.01,-599.57C309.26,-584 366.53,-556.94 418,-540.6 433.57,-535.66 450.54,-531.41 466.8,-527.86"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="467.76,-531.24 476.82,-525.74 466.32,-524.39 467.76,-531.24"/>
</g>
<!-- proc~write_vibrational_json_impl -->
<g id="proc~~compute_mbe~~CallsGraph_node74" class="node">
<title>proc~write_vibrational_json_impl</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node74"><a xlink:href="../proc/write_vibrational_json_impl.html" xlink:title="write_vibrational_json_impl">
<polygon fill="#d9534f" stroke="#d9534f" points="622.5,-229.6 465.5,-229.6 465.5,-205.6 622.5,-205.6 622.5,-229.6"/>
<text text-anchor="middle" x="544" y="-215.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_vibrational_json_impl</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_json_mbe&#45;&gt;proc~write_vibrational_json_impl -->
<g id="proc~~compute_mbe~~CallsGraph_edge113" class="edge">
<title>proc~print_vibrational_json_mbe&#45;&gt;proc~write_vibrational_json_impl</title>
<path fill="none" stroke="#ff00bf" d="M331.81,-234.44C369.89,-231.41 415.97,-227.73 455.35,-224.59"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="455.78,-228.07 465.47,-223.79 455.23,-221.09 455.78,-228.07"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_edge118" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#bdff00" d="M913.08,-1640.96C927.38,-1644.26 941.63,-1649.22 954,-1656.6 976.29,-1669.91 969.55,-1686.62 990,-1702.6 1014.66,-1721.88 1046.61,-1736.38 1072.9,-1746.18"/>
<polygon fill="#bdff00" stroke="#bdff00" points="1071.71,-1749.47 1082.31,-1749.57 1074.09,-1742.88 1071.71,-1749.47"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge119" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#bdff00" d="M913.26,-1630.78C928.21,-1626.62 942.64,-1619.98 954,-1609.6 994.17,-1572.91 948.92,-1528.28 990,-1492.6 1004.7,-1479.84 1023.93,-1473.19 1043.16,-1470.01"/>
<polygon fill="#bdff00" stroke="#bdff00" points="1043.75,-1473.46 1053.19,-1468.65 1042.81,-1466.53 1043.75,-1473.46"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node79" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node79"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1182,-1609.6 1064,-1609.6 1064,-1585.6 1182,-1585.6 1182,-1609.6"/>
<text text-anchor="middle" x="1123" y="-1595.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge114" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#bdff00" d="M913.22,-1624.87C957.63,-1619.07 1011.8,-1611.99 1053.84,-1606.51"/>
<polygon fill="#bdff00" stroke="#bdff00" points="1054.51,-1609.95 1063.97,-1605.18 1053.6,-1603.01 1054.51,-1609.95"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_node82" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node82"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1207.5,-1693.6 1038.5,-1693.6 1038.5,-1669.6 1207.5,-1669.6 1207.5,-1693.6"/>
<text text-anchor="middle" x="1123" y="-1679.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_edge115" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#bdff00" d="M907.08,-1647.63C946.59,-1653.88 995.03,-1661.53 1035.91,-1668"/>
<polygon fill="#bdff00" stroke="#bdff00" points="1035.44,-1671.46 1045.86,-1669.57 1036.53,-1664.55 1035.44,-1671.46"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_node83" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node83"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1191.5,-1525.6 1054.5,-1525.6 1054.5,-1501.6 1191.5,-1501.6 1191.5,-1525.6"/>
<text text-anchor="middle" x="1123" y="-1511.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_edge116" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#bdff00" d="M913.05,-1629.14C927.76,-1625.08 942.16,-1618.91 954,-1609.6 983.08,-1586.77 960.35,-1556.7 990,-1534.6 1005.61,-1522.97 1025.16,-1516.71 1044.39,-1513.54"/>
<polygon fill="#bdff00" stroke="#bdff00" points="1044.97,-1517 1054.4,-1512.16 1044.01,-1510.06 1044.97,-1517"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node84" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node84"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1187,-1567.6 1059,-1567.6 1059,-1543.6 1187,-1543.6 1187,-1567.6"/>
<text text-anchor="middle" x="1123" y="-1553.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge117" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#bdff00" d="M913.17,-1624.62C927.25,-1620.97 941.38,-1616.09 954,-1609.6 973.3,-1599.68 970.45,-1586.04 990,-1576.6 1008.14,-1567.84 1029.17,-1562.61 1049.03,-1559.52"/>
<polygon fill="#bdff00" stroke="#bdff00" points="1049.55,-1562.98 1058.97,-1558.13 1048.58,-1556.05 1049.55,-1562.98"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_node87" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node87"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1256,-1651.6 990,-1651.6 990,-1627.6 1256,-1627.6 1256,-1651.6"/>
<text text-anchor="middle" x="1123" y="-1637.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_edge120" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#bdff00" d="M913.22,-1636.74C934.01,-1637.02 956.94,-1637.34 979.76,-1637.65"/>
<polygon fill="#bdff00" stroke="#bdff00" points="979.84,-1641.15 989.88,-1637.79 979.93,-1634.15 979.84,-1641.15"/>
</g>
<!-- proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_node85" class="node">
<title>proc~element_mass</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node85"><a xlink:href="../proc/element_mass.html" xlink:title="element_mass">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1453.5,-1201.6 1363.5,-1201.6 1363.5,-1177.6 1453.5,-1177.6 1453.5,-1201.6"/>
<text text-anchor="middle" x="1408.5" y="-1187.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_mass</text>
</a>
</g>
</g>
<!-- proc~compute_cartesian_displacements&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge121" class="edge">
<title>proc~compute_cartesian_displacements&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#9aff00" d="M1172.13,-1341.59C1199.68,-1332.59 1233.19,-1317.77 1256,-1294.6 1284.5,-1265.66 1260.24,-1235.92 1292,-1210.6 1309.12,-1196.96 1332.21,-1191.07 1353.25,-1188.83"/>
<polygon fill="#9aff00" stroke="#9aff00" points="1353.69,-1192.3 1363.37,-1188 1353.12,-1185.33 1353.69,-1192.3"/>
</g>
<!-- proc~compute_ir_intensities&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge122" class="edge">
<title>proc~compute_ir_intensities&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#2fff00" d="M1189.04,-1157.24C1238.84,-1164.62 1306.72,-1174.67 1353.53,-1181.61"/>
<polygon fill="#2fff00" stroke="#2fff00" points="1353.08,-1185.08 1363.48,-1183.08 1354.1,-1178.16 1353.08,-1185.08"/>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge125" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;to_char</title>
<path fill="none" stroke="#0bff00" d="M915.7,-1026.62C1023.19,-1021.43 1201.22,-1007.68 1256,-972.6 1338.69,-919.65 1384.61,-803.69 1400.77,-755.39"/>
<polygon fill="#0bff00" stroke="#0bff00" points="1404.18,-756.24 1403.93,-745.65 1397.52,-754.08 1404.18,-756.24"/>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge126" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;warning</title>
<path fill="none" stroke="#0bff00" d="M906.91,-1017.53C922.75,-1013.92 939.13,-1009.34 954,-1003.6 971.28,-996.94 972.79,-989.46 990,-982.6 1020.98,-970.25 1058.11,-962.08 1085.08,-957.24"/>
<polygon fill="#0bff00" stroke="#0bff00" points="1085.99,-960.63 1095.25,-955.49 1084.8,-953.74 1085.99,-960.63"/>
</g>
<!-- pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_node78" class="node">
<title>pic_syev</title>
<polygon fill="#777777" stroke="#777777" points="1152,-1113.6 1094,-1113.6 1094,-1089.6 1152,-1089.6 1152,-1113.6"/>
<text text-anchor="middle" x="1123" y="-1099.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_syev</text>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_edge123" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;pic_syev</title>
<path fill="none" stroke="#0bff00" d="M915.68,-1041.2C928.64,-1043.8 941.77,-1046.91 954,-1050.6 970.76,-1055.67 973.49,-1060.79 990,-1066.6 1020.99,-1077.52 1057.12,-1086.88 1083.73,-1093.16"/>
<polygon fill="#0bff00" stroke="#0bff00" points="1083.26,-1096.65 1093.8,-1095.5 1084.85,-1089.83 1083.26,-1096.65"/>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge124" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#0bff00" d="M915.86,-1027.51C1003.86,-1028.11 1144,-1036.96 1256,-1080.6 1309.31,-1101.38 1361.15,-1145.35 1388.19,-1170.64"/>
<polygon fill="#0bff00" stroke="#0bff00" points="1385.79,-1173.18 1395.45,-1177.54 1390.62,-1168.11 1385.79,-1173.18"/>
</g>
<!-- proc~compute_reduced_masses&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge127" class="edge">
<title>proc~compute_reduced_masses&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#00ff3b" d="M1200.35,-1189.6C1248.63,-1189.6 1309.88,-1189.6 1353.21,-1189.6"/>
<polygon fill="#00ff3b" stroke="#00ff3b" points="1353.28,-1193.1 1363.28,-1189.6 1353.28,-1186.1 1353.28,-1193.1"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge128" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;error</title>
<path fill="none" stroke="#00ffc9" d="M921.1,-1285.61C1043.52,-1302 1248.2,-1329.68 1256,-1332.6 1306.66,-1351.58 1357.71,-1389.82 1385.71,-1412.82"/>
<polygon fill="#00ffc9" stroke="#00ffc9" points="1383.71,-1415.71 1393.63,-1419.43 1388.2,-1410.34 1383.71,-1415.71"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge132" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;warning</title>
<path fill="none" stroke="#00ffc9" d="M853.13,-1261.33C880.37,-1245.18 926.41,-1214.38 954,-1176.6 980.88,-1139.81 965.11,-1118.77 990,-1080.6 1019.79,-1034.92 1068.31,-992.96 1097.49,-969.97"/>
<polygon fill="#00ffc9" stroke="#00ffc9" points="1099.78,-972.63 1105.53,-963.73 1095.49,-967.1 1099.78,-972.63"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_edge129" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;pic_syev</title>
<path fill="none" stroke="#00ffc9" d="M849.4,-1261.53C874.66,-1244.44 920.72,-1211.38 954,-1176.6 972.93,-1156.82 966.9,-1141.31 990,-1126.6 1018,-1108.78 1055.66,-1103.04 1083.59,-1101.47"/>
<polygon fill="#00ffc9" stroke="#00ffc9" points="1083.93,-1104.96 1093.78,-1101.05 1083.65,-1097.96 1083.93,-1104.96"/>
</g>
<!-- proc~mass_weight_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node88" class="node">
<title>proc~mass_weight_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node88"><a xlink:href="../proc/mass_weight_hessian.html" xlink:title="mass_weight_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1186.5,-1243.6 1059.5,-1243.6 1059.5,-1219.6 1186.5,-1219.6 1186.5,-1243.6"/>
<text text-anchor="middle" x="1123" y="-1229.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mass_weight_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge130" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian</title>
<path fill="none" stroke="#00ffc9" d="M914.39,-1261.57C957.06,-1255.41 1008.5,-1247.99 1049.5,-1242.07"/>
<polygon fill="#00ffc9" stroke="#00ffc9" points="1050.02,-1245.53 1059.42,-1240.64 1049.02,-1238.6 1050.02,-1245.53"/>
</g>
<!-- proc~project_translation_rotation -->
<g id="proc~~compute_mbe~~CallsGraph_node90" class="node">
<title>proc~project_translation_rotation</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node90"><a xlink:href="../proc/project_translation_rotation.html" xlink:title="project_translation_rotation">
<polygon fill="#d9534f" stroke="#d9534f" points="1202,-1285.6 1044,-1285.6 1044,-1261.6 1202,-1261.6 1202,-1285.6"/>
<text text-anchor="middle" x="1123" y="-1271.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">project_translation_rotation</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation -->
<g id="proc~~compute_mbe~~CallsGraph_edge131" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation</title>
<path fill="none" stroke="#00ffc9" d="M925.08,-1273.6C959.99,-1273.6 999.44,-1273.6 1033.8,-1273.6"/>
<polygon fill="#00ffc9" stroke="#00ffc9" points="1033.82,-1277.1 1043.82,-1273.6 1033.82,-1270.1 1033.82,-1277.1"/>
</g>
<!-- proc~compute_zpe&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge133" class="edge">
<title>proc~compute_zpe&#45;&gt;to_char</title>
<path fill="none" stroke="#00edff" d="M872.16,-587.59C896.12,-592.42 926.87,-598.92 954,-605.6 1110.6,-644.21 1294.96,-699.27 1371.45,-722.54"/>
<polygon fill="#00edff" stroke="#00edff" points="1370.5,-725.91 1381.08,-725.48 1372.54,-719.22 1370.5,-725.91"/>
</g>
<!-- proc~compute_zpe&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge134" class="edge">
<title>proc~compute_zpe&#45;&gt;warning</title>
<path fill="none" stroke="#00edff" d="M872.19,-579.4C898.1,-581.27 930.87,-587.52 954,-605.6 1063.92,-691.54 1106.33,-867.71 1118.2,-929.55"/>
<polygon fill="#00edff" stroke="#00edff" points="1114.76,-930.21 1120.02,-939.41 1121.65,-928.94 1114.76,-930.21"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge135" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#0082ff" d="M910.52,-1502.13C951.87,-1496.16 1002.24,-1488.89 1043.46,-1482.94"/>
<polygon fill="#0082ff" stroke="#0082ff" points="1044.05,-1486.39 1053.45,-1481.5 1043.05,-1479.46 1044.05,-1486.39"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node81" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node81"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1237.5,-1815.6 1008.5,-1815.6 1008.5,-1791.6 1237.5,-1791.6 1237.5,-1815.6"/>
<text text-anchor="middle" x="1123" y="-1801.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge136" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#003bff" d="M934.24,-1731.62C941.12,-1734.11 947.78,-1737.08 954,-1740.6 975.39,-1752.73 968.54,-1770.6 990,-1782.6 993.34,-1784.47 996.79,-1786.18 1000.33,-1787.75"/>
<polygon fill="#003bff" stroke="#003bff" points="999.3,-1791.11 1009.89,-1791.59 1001.91,-1784.62 999.3,-1791.11"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_node77" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="1162.5,-1952.6 1083.5,-1952.6 1083.5,-1928.6 1162.5,-1928.6 1162.5,-1952.6"/>
<text text-anchor="middle" x="1123" y="-1938.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge137" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#0017ff" d="M615.17,-1853.65C733.79,-1874 970.97,-1914.69 1073.23,-1932.24"/>
<polygon fill="#0017ff" stroke="#0017ff" points="1072.83,-1935.72 1083.28,-1933.96 1074.02,-1928.82 1072.83,-1935.72"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node80" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node80"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="894,-1853.6 766,-1853.6 766,-1829.6 894,-1829.6 894,-1853.6"/>
<text text-anchor="middle" x="830" y="-1839.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge138" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#0017ff" d="M663.39,-1841.6C694.7,-1841.6 727.59,-1841.6 755.73,-1841.6"/>
<polygon fill="#0017ff" stroke="#0017ff" points="755.87,-1845.1 765.87,-1841.6 755.87,-1838.1 755.87,-1845.1"/>
</g>
<!-- sort -->
<g id="proc~~compute_mbe~~CallsGraph_node91" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="1150,-2032.6 1096,-2032.6 1096,-2008.6 1150,-2008.6 1150,-2032.6"/>
<text text-anchor="middle" x="1123" y="-2018.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge139" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#0017ff" d="M573.18,-1853.63C605.08,-1867.01 658.74,-1888.82 706,-1904.6 778.42,-1928.8 998.95,-1987.93 1086.06,-2011.08"/>
<polygon fill="#0017ff" stroke="#0017ff" points="1085.19,-2014.48 1095.76,-2013.66 1086.99,-2007.71 1085.19,-2014.48"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node89" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node89"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1182,-2371.6 1064,-2371.6 1064,-2347.6 1182,-2347.6 1182,-2371.6"/>
<text text-anchor="middle" x="1123" y="-2357.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge140" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#0b00ff" d="M947.68,-2359.6C983.64,-2359.6 1022.04,-2359.6 1053.62,-2359.6"/>
<polygon fill="#0b00ff" stroke="#0b00ff" points="1053.63,-2363.1 1063.63,-2359.6 1053.63,-2356.1 1053.63,-2363.1"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge141" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#2f00ff" d="M936.18,-2305.51C942.78,-2301.81 948.83,-2297.23 954,-2291.6 1042.42,-2195.27 912.27,-2104.75 990,-1999.6 1009.82,-1972.79 1044.61,-1957.92 1073.5,-1949.81"/>
<polygon fill="#2f00ff" stroke="#2f00ff" points="1074.65,-1953.13 1083.44,-1947.22 1072.88,-1946.36 1074.65,-1953.13"/>
</g>
<!-- proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_node86" class="node">
<title>proc~error_set</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node86"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1461,-2093.6 1356,-2093.6 1356,-2069.6 1461,-2069.6 1461,-2093.6"/>
<text text-anchor="middle" x="1408.5" y="-2079.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_edge142" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#2f00ff" d="M901.33,-2305.59C918.75,-2301.83 937.22,-2297.18 954,-2291.6 1119.86,-2236.46 1305.52,-2138.06 1377.1,-2098.63"/>
<polygon fill="#2f00ff" stroke="#2f00ff" points="1378.98,-2101.59 1386.04,-2093.69 1375.59,-2095.46 1378.98,-2101.59"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge143" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#2f00ff" d="M931.01,-2305.52C939.3,-2301.9 947.13,-2297.34 954,-2291.6 986.45,-2264.53 969.5,-2240.55 990,-2203.6 1025.07,-2140.4 1078.16,-2073.24 1105.07,-2040.66"/>
<polygon fill="#2f00ff" stroke="#2f00ff" points="1107.92,-2042.71 1111.63,-2032.78 1102.54,-2038.23 1107.92,-2042.71"/>
</g>
<!-- proc~print_thermochemistry&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge144" class="edge">
<title>proc~print_thermochemistry&#45;&gt;info</title>
<path fill="none" stroke="#ff00f9" d="M611.23,-511.11C667.79,-508.12 747.05,-503.93 792.7,-501.52"/>
<polygon fill="#ff00f9" stroke="#ff00f9" points="792.93,-505.01 802.73,-500.99 792.56,-498.02 792.93,-505.01"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge148" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;error</title>
<path fill="none" stroke="#ff006a" d="M553.32,-205.33C574.52,-175.29 634.01,-98.53 706,-70.6 808.76,-30.75 853.75,-24.78 954,-70.6 1140.56,-155.88 1180.45,-228.9 1256,-419.6 1327.68,-600.53 1221.48,-1113.22 1292,-1294.6 1311.29,-1344.22 1356.39,-1388.71 1384.18,-1412.77"/>
<polygon fill="#ff006a" stroke="#ff006a" points="1381.98,-1415.48 1391.87,-1419.28 1386.5,-1410.14 1381.98,-1415.48"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge149" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;info</title>
<path fill="none" stroke="#ff006a" d="M565.28,-229.61C591.49,-245.78 637.59,-276.48 670,-310.6 689.86,-331.52 688.24,-341.88 706,-364.6 739.98,-408.07 784.59,-454.82 809.68,-480.3"/>
<polygon fill="#ff006a" stroke="#ff006a" points="807.29,-482.86 816.81,-487.5 812.26,-477.94 807.29,-482.86"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;add -->
<g id="proc~~compute_mbe~~CallsGraph_edge145" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;add</title>
<path fill="none" stroke="#ff006a" d="M622.6,-229.08C678.13,-237.29 750.33,-247.97 792.97,-254.28"/>
<polygon fill="#ff006a" stroke="#ff006a" points="792.48,-257.74 802.89,-255.74 793.51,-250.82 792.48,-257.74"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;create_object -->
<g id="proc~~compute_mbe~~CallsGraph_edge146" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;create_object</title>
<path fill="none" stroke="#ff006a" d="M622.6,-217.6C671.87,-217.6 734.25,-217.6 777.47,-217.6"/>
<polygon fill="#ff006a" stroke="#ff006a" points="777.48,-221.1 787.48,-217.6 777.48,-214.1 777.48,-221.1"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge147" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;destroy</title>
<path fill="none" stroke="#ff006a" d="M622.6,-206.13C678.13,-197.92 750.33,-187.24 792.97,-180.93"/>
<polygon fill="#ff006a" stroke="#ff006a" points="793.51,-184.39 802.89,-179.47 792.48,-177.47 793.51,-184.39"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;initialize -->
<g id="proc~~compute_mbe~~CallsGraph_edge150" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;initialize</title>
<path fill="none" stroke="#ff006a" d="M570.93,-205.55C602.29,-191.43 656.98,-168.23 706,-154.6 734.13,-146.79 766.72,-141.38 791.29,-138.02"/>
<polygon fill="#ff006a" stroke="#ff006a" points="791.83,-141.47 801.29,-136.7 790.92,-134.53 791.83,-141.47"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_edge151" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#ff006a" d="M558.97,-205.58C585.61,-183.36 646.35,-135.98 706,-112.6 727.5,-104.18 752.43,-99.13 774.2,-96.1"/>
<polygon fill="#ff006a" stroke="#ff006a" points="774.8,-99.55 784.28,-94.81 773.91,-92.61 774.8,-99.55"/>
</g>
<!-- proc~write_vibrational_json_impl&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_edge152" class="edge">
<title>proc~write_vibrational_json_impl&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#ff006a" d="M570.93,-229.66C602.29,-243.78 656.98,-266.98 706,-280.6 718.56,-284.09 732.01,-287.1 745.23,-289.67"/>
<polygon fill="#ff006a" stroke="#ff006a" points="744.82,-293.15 755.29,-291.54 746.1,-286.27 744.82,-293.15"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node93" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node93"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1525,-1815.6 1292,-1815.6 1292,-1791.6 1525,-1791.6 1525,-1815.6"/>
<text text-anchor="middle" x="1408.5" y="-1801.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge153" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#65ff00" d="M1237.68,-1803.6C1252.2,-1803.6 1267.12,-1803.6 1281.82,-1803.6"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1281.95,-1807.1 1291.95,-1803.6 1281.95,-1800.1 1281.95,-1807.1"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_node94" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node94"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1448,-1693.6 1369,-1693.6 1369,-1669.6 1448,-1669.6 1448,-1693.6"/>
<text text-anchor="middle" x="1408.5" y="-1679.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_edge154" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff00" d="M1207.53,-1681.6C1256.76,-1681.6 1317.34,-1681.6 1358.84,-1681.6"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1358.96,-1685.1 1368.96,-1681.6 1358.96,-1678.1 1358.96,-1685.1"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge155" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ff66" d="M1191.78,-1505.81C1212.59,-1502.62 1235.43,-1498.3 1256,-1492.6 1297.55,-1481.09 1343.18,-1461.74 1373.4,-1447.92"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1375.03,-1451.02 1382.64,-1443.64 1372.09,-1444.66 1375.03,-1451.02"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge158" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ff66" d="M1191.75,-1518.57C1215.15,-1516.61 1239.58,-1509.81 1256,-1492.6 1306,-1440.19 1278.67,-1239.81 1292,-1168.6 1322.11,-1007.79 1380.23,-819.03 1400.4,-755.62"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1403.8,-756.5 1403.51,-745.91 1397.13,-754.37 1403.8,-756.5"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge156" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ff66" d="M1191.74,-1518.2C1215,-1516.16 1239.34,-1509.42 1256,-1492.6 1331.93,-1416 1216.92,-1330.04 1292,-1252.6 1299.08,-1245.31 1307.78,-1240.06 1317.21,-1236.33"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1318.47,-1239.6 1326.84,-1233.09 1316.25,-1232.96 1318.47,-1239.6"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_edge157" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ff66" d="M1191.63,-1508.75C1215.02,-1510.73 1239.47,-1517.5 1256,-1534.6 1301.13,-1581.3 1274.49,-1762.07 1292,-1824.6 1317.75,-1916.6 1371.43,-2017.79 1395.44,-2060.62"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1392.51,-2062.55 1400.48,-2069.53 1398.6,-2059.11 1392.51,-2062.55"/>
</g>
<!-- proc~mass_weight_hessian&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge159" class="edge">
<title>proc~mass_weight_hessian&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#6500ff" d="M1186.57,-1222.34C1236.39,-1214.95 1305.44,-1204.72 1353.02,-1197.68"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1353.75,-1201.11 1363.13,-1196.18 1352.73,-1194.18 1353.75,-1201.11"/>
</g>
<!-- proc~project_translation_rotation&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge161" class="edge">
<title>proc~project_translation_rotation&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ff00cb" d="M1202.07,-1270.38C1220.59,-1267.18 1239.7,-1261.72 1256,-1252.6 1277.46,-1240.6 1270.68,-1222.84 1292,-1210.6 1310.45,-1200.02 1333.05,-1194.57 1353.36,-1191.84"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1353.89,-1195.3 1363.42,-1190.67 1353.08,-1188.34 1353.89,-1195.3"/>
</g>
<!-- pic_gesvd -->
<g id="proc~~compute_mbe~~CallsGraph_node92" class="node">
<title>pic_gesvd</title>
<polygon fill="#777777" stroke="#777777" points="1441,-1285.6 1376,-1285.6 1376,-1261.6 1441,-1261.6 1441,-1285.6"/>
<text text-anchor="middle" x="1408.5" y="-1271.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_gesvd</text>
</g>
<!-- proc~project_translation_rotation&#45;&gt;pic_gesvd -->
<g id="proc~~compute_mbe~~CallsGraph_edge160" class="edge">
<title>proc~project_translation_rotation&#45;&gt;pic_gesvd</title>
<path fill="none" stroke="#ff00cb" d="M1202.22,-1273.6C1255.06,-1273.6 1322.75,-1273.6 1365.64,-1273.6"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1365.72,-1277.1 1375.72,-1273.6 1365.72,-1270.1 1365.72,-1277.1"/>
</g>
<!-- proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node95" class="node">
<title>proc~cgto_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node95"><a xlink:href="../proc/cgto_destroy.html" xlink:title="cgto_type%cgto_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1703,-1815.6 1561,-1815.6 1561,-1791.6 1703,-1791.6 1703,-1815.6"/>
<text text-anchor="middle" x="1632" y="-1801.2" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cgto_type%cgto_destroy</text>
</a>
</g>
</g>
<!-- proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge162" class="edge">
<title>proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy</title>
<path fill="none" stroke="#00ff00" d="M1525.12,-1803.6C1533.77,-1803.6 1542.38,-1803.6 1550.74,-1803.6"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1550.79,-1807.1 1560.79,-1803.6 1550.79,-1800.1 1550.79,-1807.1"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCallsGraph = svgPanZoom('#proccompute_mbeCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CalledByGraph Pages: 1 -->
<svg id="proccompute_mbeCalledByGraph" width="641pt" height="72pt"
 viewBox="0.00 0.00 641.00 72.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CalledByGraph" class="graph" transform="scale(0.62 0.62) rotate(0) translate(4 112)">
<title>proc~~compute_mbe~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 1025,-112 1025,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="1021,-66 932,-66 932,-42 1021,-42 1021,-66"/>
<text text-anchor="middle" x="976.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node2" class="node">
<title>proc~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node2"><a xlink:href="../proc/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="875.5,-87 762.5,-87 762.5,-63 875.5,-63 875.5,-87"/>
<text text-anchor="middle" x="819" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M875.7,-67.48C890.71,-65.45 906.92,-63.26 921.82,-61.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="922.45,-64.7 931.89,-59.89 921.51,-57.76 922.45,-64.7"/>
</g>
<!-- proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node3" class="node">
<title>proc~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node3"><a xlink:href="../proc/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="896,-45 742,-45 742,-21 896,-21 896,-45"/>
<text text-anchor="middle" x="819" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge2" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M896.38,-43.32C904.92,-44.47 913.47,-45.62 921.64,-46.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="921.36,-50.22 931.74,-48.09 922.3,-43.28 921.36,-50.22"/>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node4" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node4"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="685.5,-87 572.5,-87 572.5,-63 685.5,-63 685.5,-87"/>
<text text-anchor="middle" x="629" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge3" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M685.64,-75C706.58,-75 730.58,-75 752.35,-75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="752.5,-78.5 762.5,-75 752.5,-71.5 752.5,-78.5"/>
</g>
<!-- interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node5" class="node">
<title>interface~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node5"><a xlink:href="../interface/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#a7506f" stroke="#a7506f" points="706,-45 552,-45 552,-21 706,-21 706,-45"/>
<text text-anchor="middle" x="629" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge4" class="edge">
<title>interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M706.2,-33C714.52,-33 723.03,-33 731.47,-33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="731.7,-36.5 741.7,-33 731.7,-29.5 731.7,-36.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node6" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node6"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="516,-66 353,-66 353,-42 516,-42 516,-66"/>
<text text-anchor="middle" x="434.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge5" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M516.02,-62.78C531.42,-64.46 547.38,-66.21 562.25,-67.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.03,-71.32 572.35,-68.93 562.79,-64.37 562.03,-71.32"/>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge6" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" d="M516.02,-45.22C524.54,-44.29 533.22,-43.34 541.8,-42.4"/>
<polygon fill="#00ffff" stroke="#00ffff" points="542.24,-45.88 551.8,-41.31 541.48,-38.92 542.24,-45.88"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node7" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node7"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-66 223,-66 223,-42 317,-42 317,-66"/>
<text text-anchor="middle" x="270" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge7" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M317.13,-54C325.24,-54 333.94,-54 342.78,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.8,-57.5 352.8,-54 342.8,-50.5 342.8,-57.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~compute_mbe~~CalledByGraph_node8" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node8"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="176.5,-108 10.5,-108 10.5,-84 176.5,-84 176.5,-108"/>
<text text-anchor="middle" x="93.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge8" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M148.85,-83.92C161.39,-81.06 174.67,-77.98 187,-75 195.32,-72.99 204.09,-70.81 212.69,-68.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.82,-71.96 222.65,-66.11 212.1,-65.18 213.82,-71.96"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~compute_mbe~~CalledByGraph_node9" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node9"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="187,-66 0,-66 0,-42 187,-42 187,-66"/>
<text text-anchor="middle" x="93.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge9" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M187.11,-54C195.83,-54 204.48,-54 212.7,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.87,-57.5 222.87,-54 212.87,-50.5 212.87,-57.5"/>
</g>
<!-- program~main -->
<g id="proc~~compute_mbe~~CalledByGraph_node10" class="node">
<title>program~main</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node10"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="120.5,-24 66.5,-24 66.5,0 120.5,0 120.5,-24"/>
<text text-anchor="middle" x="93.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge10" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M120.86,-17.78C139.39,-21.9 164.75,-27.63 187,-33 195.32,-35.01 204.09,-37.19 212.69,-39.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.1,-42.82 222.65,-41.89 213.82,-36.04 212.1,-42.82"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCalledByGraph = svgPanZoom('#proccompute_mbeCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_dipole"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_dipole</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_dipole_derivs"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_dipole_derivs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_grad"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_grad</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_hess"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_hess</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_log_level~5"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_log_level</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_e~2"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>delta_E</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_dipole_derivs~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_dipole_derivs</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                <p>(3, 3*total_atoms, fragment_count)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_dipoles~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_dipoles</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                <p>(3, fragment_count)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_gradients~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_gradients</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_hessians~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_hessians</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-do_detailed_print"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>do_detailed_print</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_size~9"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_size</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hess_dim~3"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>hess_dim</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~40"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ir_intensities"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>ir_intensities</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                <p>IR intensities in km/mol</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lookup~7"></span>
              type(<a href='../type/fragment_lookup_t.html'>fragment_lookup_t</a>),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lookup</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nlevel~3"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nlevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sum_by_level~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sum_by_level</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Compute many-body expansion (MBE) energy with optional gradient, hessian, and dipole</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! This is the core routine that handles all MBE computations.</span>
<span class="w">      </span><span class="c">!! The caller pre-allocates desired components in mbe_result before calling:</span>
<span class="w">      </span><span class="c">!!   - mbe_result%gradient allocated: compute gradient (requires sys_geom)</span>
<span class="w">      </span><span class="c">!!   - mbe_result%hessian allocated: compute hessian (requires sys_geom)</span>
<span class="w">      </span><span class="c">!!   - mbe_result%dipole allocated: compute total dipole moment</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_result_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculation_result_t</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result_t</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_config_parser</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">bond_t</span>

<span class="w">      </span><span class="c">! Required arguments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">mbe_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_result</span><span class="w">  </span><span class="c">!! Pre-allocated by caller</span>

<span class="w">      </span><span class="c">! Optional arguments</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span><span class="w">  </span><span class="c">!! Required for gradient/hessian</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span><span class="w">             </span><span class="c">!! Bond info for H-cap handling</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span><span class="w">           </span><span class="c">!! MPI communicator for abort</span>

<span class="w">      </span><span class="c">! Local variables</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(:),</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(:),</span><span class="w"> </span><span class="n">energies</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_dipoles</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! (3, fragment_count)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! (3, 3*total_atoms, fragment_count)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ir_intensities</span><span class="p">(:)</span><span class="w">  </span><span class="c">!! IR intensities in km/mol</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">do_detailed_print</span><span class="p">,</span><span class="w"> </span><span class="n">compute_grad</span><span class="p">,</span><span class="w"> </span><span class="n">compute_hess</span><span class="p">,</span><span class="w"> </span><span class="n">compute_dipole</span><span class="p">,</span><span class="w"> </span><span class="n">compute_dipole_derivs</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">fragment_lookup_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lookup</span>

<span class="w">      </span><span class="c">! Determine what to compute based on allocated components in mbe_result</span>
<span class="w">      </span><span class="n">compute_grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_hess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">! Will be set true if all fragments have dipole_derivatives</span>

<span class="w">      </span><span class="c">! Validate inputs for gradient computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_gradient</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have gradient!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Missing gradient in compute_mbe_internal&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Validate inputs for hessian computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_hessian</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have Hessian!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Missing Hessian in compute_mbe_internal&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">hess_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Validate inputs for dipole computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have dipole - skipping dipole MBE&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="n">compute_dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">               </span><span class="k">exit</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Check if dipole derivatives are available (for IR intensities)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">compute_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_dipole_derivatives</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">compute_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">               </span><span class="k">exit</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Get logger configuration</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">configuration</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="n">do_detailed_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">current_log_level</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">verbose_level</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Allocate energy arrays (always needed)</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="n">sum_by_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="n">delta_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">      </span><span class="c">! Extract total energies from results</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">         </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">energy</span><span class="p">%</span><span class="n">total</span><span class="p">()</span>
<span class="w">      </span><span class="k">end do</span>

<span class="w">      </span><span class="c">! Allocate gradient delta arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_gradients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate hessian delta arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">(</span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_hessians</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate dipole delta arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipoles</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_dipoles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate dipole derivative delta arrays if needed (for IR intensities)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipole_derivs</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">))</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Build hash table for fast fragment lookups</span>
<span class="w">      </span><span class="k">block</span>
<span class="k">         use </span><span class="n">mqc_error</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">error_t</span>
<span class="w">         </span><span class="k">type</span><span class="p">(</span><span class="n">error_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lookup_error</span>
<span class="w">         </span><span class="k">call </span><span class="n">build_mbe_lookup_table</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="n">lookup_error</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lookup_error</span><span class="p">%</span><span class="n">has_error</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to build lookup table: &quot;</span><span class="o">//</span><span class="n">lookup_error</span><span class="p">%</span><span class="n">get_message</span><span class="p">())</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               error stop</span><span class="w"> </span><span class="s2">&quot;Failed to build lookup table&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">      end block</span>

<span class="w">      </span><span class="c">! Bottom-up computation: process fragments by size (1-body, then 2-body, etc.)</span>
<span class="w">      </span><span class="c">! This makes the algorithm independent of input fragment order</span>
<span class="w">      </span><span class="c">! We process by n-mer level to ensure all subsets are computed before they&#39;re needed</span>
<span class="w">      </span><span class="k">do </span><span class="n">nlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Only process fragments of the current nlevel</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! 1-body: delta = value (no subsets to subtract)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_gradient</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                      </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_hessian</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                   </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! For 1-body, delta dipole is just the fragment dipole</span>
<span class="w">                  </span><span class="n">delta_dipoles</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">dipole</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! For 1-body, delta dipole derivatives are just the fragment values mapped to system</span>
<span class="w">                  </span><span class="k">call </span><span class="n">map_fragment_to_system_dipole_derivatives</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">dipole_derivatives</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">            else if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! n-body: delta = value - sum(all subset deltas)</span>
<span class="w">               </span><span class="n">delta_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_mbe_delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_E</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_gradient</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_hessian</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_dipole</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                          </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dipoles</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_dipole_derivatives</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                      </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end do</span>

<span class="w">      </span><span class="c">! Clean up lookup table</span>
<span class="w">      </span><span class="k">call </span><span class="n">lookup</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>

<span class="w">      </span><span class="c">! Compute totals and set status flags</span>
<span class="w">      </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">)</span>
<span class="w">      </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_dipoles</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_dipole_derivatives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print energy breakdown (always)</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_mbe_energy_breakdown</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Print gradient info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_mbe_gradient_info</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print hessian info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MBE Hessian computation completed&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Total Hessian Frobenius norm: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span>

<span class="w">         </span><span class="c">! Compute and print full vibrational analysis with thermochemistry</span>
<span class="w">         </span><span class="k">block</span>
<span class="k">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">frequencies</span><span class="p">(:),</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">(:),</span><span class="w"> </span><span class="n">force_constants</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">(:)</span>
<span class="w">            </span><span class="k">type</span><span class="p">(</span><span class="n">thermochemistry_result_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">thermo_result</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_at</span><span class="p">,</span><span class="w"> </span><span class="n">n_modes</span>

<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Computing vibrational analysis (projecting trans/rot modes)...&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">compute_vibrational_analysis</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">project_trans_rot</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">dipole_derivatives</span><span class="o">=</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">ir_intensities</span><span class="o">=</span><span class="n">ir_intensities</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               call </span><span class="n">compute_vibrational_analysis</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">project_trans_rot</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">frequencies</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! Compute thermochemistry</span>
<span class="w">               </span><span class="n">n_at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">)</span>
<span class="w">               </span><span class="n">n_modes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">compute_thermochemistry</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">n_at</span><span class="p">,</span><span class="w"> </span><span class="n">n_modes</span><span class="p">,</span><span class="w"> </span><span class="n">thermo_result</span><span class="p">)</span>

<span class="w">               </span><span class="c">! Print vibrational analysis to log</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ir_intensities</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">print_vibrational_analysis</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">ir_intensities</span><span class="o">=</span><span class="n">ir_intensities</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">electronic_energy</span><span class="o">=</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="p">)</span>
<span class="w">                  </span><span class="c">! Write vibrational/thermochemistry JSON</span>
<span class="w">                  </span><span class="k">call </span><span class="n">print_vibrational_json_mbe</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">thermo_result</span><span class="p">,</span><span class="w"> </span><span class="n">ir_intensities</span><span class="p">)</span>
<span class="w">                  </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">ir_intensities</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  call </span><span class="n">print_vibrational_analysis</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">electronic_energy</span><span class="o">=</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="p">)</span>
<span class="w">                  </span><span class="c">! Write vibrational/thermochemistry JSON</span>
<span class="w">                  </span><span class="k">call </span><span class="n">print_vibrational_json_mbe</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">thermo_result</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">               deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end block</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print dipole info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         block</span>
<span class="k">            </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dipole_line</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dipole_magnitude</span>
<span class="w">            </span><span class="n">dipole_magnitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="p">)</span><span class="o">*</span><span class="mf">2.541746_dp</span><span class="w">  </span><span class="c">! Convert e*Bohr to Debye</span>
<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MBE Dipole moment:&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">dipole_line</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,3f15.8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;  Dipole (e*Bohr): &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span>
<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">dipole_line</span><span class="p">))</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">dipole_line</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,f15.8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;  Dipole magnitude (Debye): &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dipole_magnitude</span>
<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">dipole_line</span><span class="p">))</span>
<span class="w">         </span><span class="k">end block</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print detailed breakdown if requested</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">do_detailed_print</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Write JSON output (skip if we already wrote vibrational JSON for Hessian calculations)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_dipoles</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipoles</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_dipole_derivs</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipole_derivs</span><span class="p">)</span>

<span class="w">   </span><span class="k">end subroutine </span><span class="n">compute_mbe</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-11 12:14 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>