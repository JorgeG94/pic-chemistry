<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>compute_mbe &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>compute_mbe
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.8% of total for procedures.">124 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe.f90.html'>mqc_mbe.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe.html'>mqc_mbe</a></li>
            <li class="breadcrumb-item active" aria-current="page">compute_mbe</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_grad">compute_grad</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_hess">compute_hess</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-current_log_level~5">current_log_level</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_e~2">delta_E</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_energies~2">delta_energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_gradients~2">delta_gradients</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_hessians~2">delta_hessians</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-do_detailed_print">do_detailed_print</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-energies~2">energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-fragment_size~3">fragment_size</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-hess_dim~4">hess_dim</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-i~11">i</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-lookup~5">lookup</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-nlevel~2">nlevel</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-sum_by_level~2">sum_by_level</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/compute_mbe.html#src">compute_mbe</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine compute_mbe(polymers, fragment_count, max_level, results, total_energy, sys_geom, total_gradient, total_hessian, bonds)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/mqc_result_types.html'>mqc_result_types</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_config_parser.html'>mqc_config_parser</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~UsesGraph Pages: 1 -->
<svg id="proccompute_mbeUsesGraph" width="497pt" height="262pt"
 viewBox="0.00 0.00 497.00 262.49" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 258.49)">
<title>proc~~compute_mbe~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-258.49 493,-258.49 493,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~UsesGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="489,-88.49 400,-88.49 400,-64.49 489,-64.49 489,-88.49"/>
<text text-anchor="middle" x="444.5" y="-74.09" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_node2" class="node">
<title>module~mqc_config_parser</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node2"><a xlink:href="../module/mqc_config_parser.html" xlink:title="mqc_config_parser">
<polygon fill="#337ab7" stroke="#337ab7" points="364,-149.49 250,-149.49 250,-125.49 364,-125.49 364,-149.49"/>
<text text-anchor="middle" x="307" y="-135.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_config_parser</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_config_parser</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M416.73,-88.55C395.94,-97.9 366.92,-110.97 344.08,-121.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.4,-118.17 334.71,-125.47 345.27,-124.55 342.4,-118.17"/>
</g>
<!-- module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_node3" class="node">
<title>module~mqc_result_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node3"><a xlink:href="../module/mqc_result_types.html" xlink:title="mqc_result_types">
<polygon fill="#337ab7" stroke="#337ab7" points="359,-48.49 255,-48.49 255,-24.49 359,-24.49 359,-48.49"/>
<text text-anchor="middle" x="307" y="-34.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_result_types</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_result_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.85,-64.49C389.04,-60.42 373.43,-55.81 358.93,-51.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="359.68,-48.1 349.09,-48.62 357.69,-54.81 359.68,-48.1"/>
</g>
<!-- module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_node4" class="node">
<title>module~mqc_calc_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node4"><a xlink:href="../module/mqc_calc_types.html" xlink:title="mqc_calc_types">
<polygon fill="#337ab7" stroke="#337ab7" points="204.5,-254.49 107.5,-254.49 107.5,-230.49 204.5,-230.49 204.5,-254.49"/>
<text text-anchor="middle" x="156" y="-240.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_calc_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge3" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_calc_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295.55,-149.66C279.59,-167.58 247.45,-201.15 214,-221.49 211.21,-223.19 208.25,-224.79 205.22,-226.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.65,-223.15 195.97,-230.45 206.52,-229.53 203.65,-223.15"/>
</g>
<!-- module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_node5" class="node">
<title>module~mqc_error</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node5"><a xlink:href="../module/mqc_error.html" xlink:title="mqc_error">
<polygon fill="#337ab7" stroke="#337ab7" points="189.5,-212.49 122.5,-212.49 122.5,-188.49 189.5,-188.49 189.5,-212.49"/>
<text text-anchor="middle" x="156" y="-198.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_error</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge4" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.84,-149.6C262.48,-158.28 236.89,-170.07 214,-179.49 209.25,-181.45 204.24,-183.42 199.24,-185.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.84,-182.12 189.72,-188.92 200.31,-188.67 197.84,-182.12"/>
</g>
<!-- module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_node6" class="node">
<title>module~mqc_geometry</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node6"><a xlink:href="../module/mqc_geometry.html" xlink:title="mqc_geometry">
<polygon fill="#337ab7" stroke="#337ab7" points="202.5,-170.49 109.5,-170.49 109.5,-146.49 202.5,-146.49 202.5,-170.49"/>
<text text-anchor="middle" x="156" y="-156.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_geometry</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_edge5" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-145.43C237.57,-147.14 224.78,-148.94 212.7,-150.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.16,-147.18 202.75,-152.05 213.14,-154.12 212.16,-147.18"/>
</g>
<!-- module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_node7" class="node">
<title>module~mqc_method_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node7"><a xlink:href="../module/mqc_method_types.html" xlink:title="mqc_method_types">
<polygon fill="#337ab7" stroke="#337ab7" points="214,-128.49 98,-128.49 98,-104.49 214,-104.49 214,-128.49"/>
<text text-anchor="middle" x="156" y="-114.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_method_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge6" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_method_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-129.55C241.47,-128.4 232.95,-127.2 224.56,-126.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="224.79,-122.51 214.4,-124.58 223.81,-129.44 224.79,-122.51"/>
</g>
<!-- pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_node9" class="node">
<title>pic_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62,-128.49 0,-128.49 0,-104.49 62,-104.49 62,-128.49"/>
<text text-anchor="middle" x="31" y="-114.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_types</text>
</g>
<!-- module~mqc_config_parser&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge7" class="edge">
<title>module~mqc_config_parser&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.05,-125.34C267.98,-115.09 240.25,-101.2 214,-95.49 163.62,-84.54 148.95,-87.58 98,-95.49 89.37,-96.83 80.33,-99.1 71.81,-101.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="70.55,-98.39 62.09,-104.77 72.68,-105.06 70.55,-98.39"/>
</g>
<!-- pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_node8" class="node">
<title>pic_mpi_lib</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192,-48.49 120,-48.49 120,-24.49 192,-24.49 192,-48.49"/>
<text text-anchor="middle" x="156" y="-34.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_mpi_lib</text>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_edge8" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_mpi_lib</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M254.72,-36.49C237.87,-36.49 219.26,-36.49 202.84,-36.49"/>
<polygon fill="#00ffff" stroke="#00ffff" points="202.41,-32.99 192.41,-36.49 202.41,-39.99 202.41,-32.99"/>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge9" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.47,-24.36C236.72,-7.93 156.1,15.94 98,-15.49 67.05,-32.24 48.3,-70.5 39.06,-94.83"/>
<polygon fill="#00ffff" stroke="#00ffff" points="35.75,-93.71 35.68,-104.3 42.34,-96.06 35.75,-93.71"/>
</g>
<!-- module~mqc_calc_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge10" class="edge">
<title>module~mqc_calc_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.51,-230.46C107.33,-227.98 102.34,-225.01 98,-221.49 70.32,-199.05 50.84,-161.74 40.53,-138.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="43.66,-136.56 36.56,-128.69 37.2,-139.27 43.66,-136.56"/>
</g>
<!-- module~mqc_geometry&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge11" class="edge">
<title>module~mqc_geometry&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M119.75,-146.46C104.85,-141.37 87.4,-135.41 72.02,-130.16"/>
<polygon fill="#00ff00" stroke="#00ff00" points="72.84,-126.74 62.25,-126.82 70.58,-133.37 72.84,-126.74"/>
</g>
<!-- module~mqc_method_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge12" class="edge">
<title>module~mqc_method_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M97.82,-116.49C89.18,-116.49 80.42,-116.49 72.23,-116.49"/>
<polygon fill="#00ffff" stroke="#00ffff" points="72.22,-112.99 62.22,-116.49 72.22,-119.99 72.22,-112.99"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


    <p>Compute many-body expansion (MBE) energy with optional gradient and/or hessian</p>
<p>This is the core routine that handles all MBE computations.
Optional arguments control what derivatives are computed:
  - If sys_geom and total_gradient are present: compute gradient
  - If total_hessian is also present: compute hessian</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_count~2"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_count</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results~6"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_energy~4"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_energy</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~9"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_gradient~4"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_gradient</strong>(:,:)</td>
            <td>
                <p>(3, total_atoms)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_hessian~3"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_hessian</strong>(:,:)</td>
            <td>
                <p>(3<em>total_atoms, 3</em>total_atoms)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~8"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CallsGraph Pages: 1 -->
<svg id="proccompute_mbeCallsGraph" width="641pt" height="381pt"
 viewBox="0.00 0.00 641.00 381.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CallsGraph" class="graph" transform="scale(0.38 0.38) rotate(0) translate(4 996.52)">
<title>proc~~compute_mbe~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-996.52 1678,-996.52 1678,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="89,-459 0,-459 0,-435 89,-435 89,-459"/>
<text text-anchor="middle" x="44.5" y="-444.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- configuration -->
<g id="proc~~compute_mbe~~CallsGraph_node2" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="855.5,-684 771.5,-684 771.5,-660 855.5,-660 855.5,-684"/>
<text text-anchor="middle" x="813.5" y="-669.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#ff0000" d="M45.86,-459.01C47.66,-495.61 58.62,-606.11 125,-653 226.8,-724.92 619.81,-692.17 761.34,-677.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="761.9,-681.1 771.48,-676.59 761.17,-674.14 761.9,-681.1"/>
</g>
<!-- error -->
<g id="proc~~compute_mbe~~CallsGraph_node3" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1406.5,-522 1352.5,-522 1352.5,-498 1406.5,-498 1406.5,-522"/>
<text text-anchor="middle" x="1379.5" y="-507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M46.35,-459.39C50.75,-520.47 72.85,-789.08 125,-851 250.76,-1000.31 345.78,-992 541,-992 541,-992 541,-992 814.5,-992 1025.72,-992 1081.51,-909.12 1227,-756 1295.25,-684.16 1348.39,-576.7 1369.09,-531.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1372.31,-532.76 1373.22,-522.2 1365.92,-529.88 1372.31,-532.76"/>
</g>
<!-- info -->
<g id="proc~~compute_mbe~~CallsGraph_node4" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="569,-64 515,-64 515,-40 569,-40 569,-64"/>
<text text-anchor="middle" x="542" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge3" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M46.15,-434.73C49.57,-375.48 67.53,-119.8 125,-71 181.52,-23 414.56,-39.72 504.94,-48.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="504.7,-51.76 514.99,-49.24 505.37,-44.79 504.7,-51.76"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_node5" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node5"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="324.5,-842 182.5,-842 182.5,-818 324.5,-818 324.5,-842"/>
<text text-anchor="middle" x="253.5" y="-827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_edge4" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#ff0000" d="M47.73,-459.15C54.79,-495.54 78.92,-606.06 125,-686 154.14,-736.55 202.91,-785.19 230.93,-810.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="228.82,-813.79 238.58,-817.91 233.53,-808.6 228.82,-813.79"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_node6" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node6"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-644 193,-644 193,-620 314,-620 314,-644"/>
<text text-anchor="middle" x="253.5" y="-629.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_edge5" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#ff0000" d="M47.52,-459.31C53.31,-490.37 73.02,-572.19 125,-611 141.45,-623.29 162.44,-629.47 182.62,-632.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.41,-635.85 192.75,-633.53 183.23,-628.89 182.41,-635.85"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node7" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node7"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="323,-602 184,-602 184,-578 323,-578 323,-602"/>
<text text-anchor="middle" x="253.5" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge6" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#ff0000" d="M49.58,-459.12C58.7,-484.21 83.29,-541.78 125,-569 139.45,-578.43 156.72,-584.09 173.82,-587.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.4,-590.87 183.84,-589.08 174.56,-583.97 173.4,-590.87"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node8" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node8"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="321,-560 186,-560 186,-536 321,-536 321,-560"/>
<text text-anchor="middle" x="253.5" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge7" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#ff0000" d="M54.57,-459.03C68,-475.92 94.85,-506.35 125,-522 140.59,-530.09 158.47,-535.66 175.81,-539.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.44,-543 185.93,-541.57 176.84,-536.14 175.44,-543"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_node9" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node9"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="321.5,-480 185.5,-480 185.5,-456 321.5,-456 321.5,-480"/>
<text text-anchor="middle" x="253.5" y="-465.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge8" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#ff0000" d="M89.15,-451.43C114.08,-453.96 146.08,-457.2 175.13,-460.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.97,-463.65 185.27,-461.18 175.68,-456.69 174.97,-463.65"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node10" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node10"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-438 125,-438 125,-414 382,-414 382,-438"/>
<text text-anchor="middle" x="253.5" y="-423.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge9" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#ff0000" d="M89.15,-442.57C99.72,-441.5 111.57,-440.3 123.92,-439.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="124.33,-442.52 133.93,-438.03 123.62,-435.56 124.33,-442.52"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node11" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node11"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="642,-560 442,-560 442,-536 642,-536 642,-560"/>
<text text-anchor="middle" x="542" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge10" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#ff0000" d="M63.96,-459.12C79.57,-468.78 102.87,-481.83 125,-489 139.9,-493.83 322.04,-518.73 440.32,-534.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="440.11,-538.11 450.49,-535.97 441.04,-531.17 440.11,-538.11"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node12" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node12"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="640,-476 444,-476 444,-452 640,-452 640,-476"/>
<text text-anchor="middle" x="542" y="-461.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge11" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#ff0000" d="M62.49,-434.87C77.95,-424.63 101.82,-410.75 125,-405 235.87,-377.51 277.07,-359.87 382,-405 403.37,-414.19 397.48,-432.04 418,-443 423.2,-445.78 428.69,-448.21 434.34,-450.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="433.39,-453.7 443.99,-453.6 435.64,-447.07 433.39,-453.7"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node13" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node13"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-354 178.5,-354 178.5,-330 328.5,-330 328.5,-354"/>
<text text-anchor="middle" x="253.5" y="-339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge12" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#ff0000" d="M54.86,-434.81C68.44,-418.01 95.26,-388.01 125,-372 138.39,-364.8 153.48,-359.31 168.47,-355.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.49,-358.48 178.29,-352.57 167.73,-351.71 169.49,-358.48"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_node14" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node14"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="342,-224 165,-224 165,-200 342,-200 342,-224"/>
<text text-anchor="middle" x="253.5" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_edge13" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#ff0000" d="M51.64,-434.72C63.74,-411.2 92.34,-358.75 125,-321 156.29,-284.83 199.9,-250.21 227.15,-230.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.39,-232.74 235.39,-224.01 225.25,-227.09 229.39,-232.74"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node15" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node15"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-104 167,-104 167,-80 340,-80 340,-104"/>
<text text-anchor="middle" x="253.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge14" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#ff0000" d="M46.73,-434.64C52.4,-380.34 77.74,-163.59 125,-118 134.04,-109.27 145.18,-103.11 157.07,-98.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.26,-102.11 166.74,-95.75 156.15,-95.43 158.26,-102.11"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_node16" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node16"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="324.5,-24 182.5,-24 182.5,0 324.5,0 324.5,-24"/>
<text text-anchor="middle" x="253.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_edge15" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#ff0000" d="M46.1,-434.69C49.4,-372.8 67.21,-96.32 125,-38 137.56,-25.32 154.51,-17.99 171.94,-13.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.11,-17.26 182.24,-11.88 171.75,-10.39 173.11,-17.26"/>
</g>
<!-- to_char -->
<g id="proc~~compute_mbe~~CallsGraph_node17" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1406.5,-146 1352.5,-146 1352.5,-122 1406.5,-122 1406.5,-146"/>
<text text-anchor="middle" x="1379.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge16" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M45.43,-434.75C45.87,-393.83 53.04,-260.52 125,-191 222.09,-97.21 284.21,-128.94 418,-111 775.78,-63.03 1215.07,-112.6 1342.37,-129.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1341.99,-132.56 1352.36,-130.39 1342.9,-125.62 1341.99,-132.56"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge22" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#dfff00" d="M267.57,-842.25C293.69,-865.77 355.2,-916.57 418,-935 526.11,-966.72 823.02,-982.9 925,-935 1115.27,-845.63 1146.25,-765.08 1227,-571 1259.07,-493.91 1216.98,-266.67 1263,-197 1281.31,-169.28 1316.08,-152.73 1342.71,-143.59"/>
<polygon fill="#dfff00" stroke="#dfff00" points="1344.03,-146.85 1352.47,-140.45 1341.88,-140.19 1344.03,-146.85"/>
</g>
<!-- debug -->
<g id="proc~~compute_mbe~~CallsGraph_node18" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="840.5,-726 786.5,-726 786.5,-702 840.5,-702 840.5,-726"/>
<text text-anchor="middle" x="813.5" y="-711.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge17" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#dfff00" d="M280.22,-817.92C311.91,-803.54 367.76,-779.87 418,-767 547.26,-733.9 705.96,-720.58 776.15,-716.03"/>
<polygon fill="#dfff00" stroke="#dfff00" points="776.49,-719.52 786.25,-715.4 776.05,-712.53 776.49,-719.52"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_node19" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="595,-800 489,-800 489,-776 595,-776 595,-800"/>
<text text-anchor="middle" x="542" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_edge18" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#dfff00" d="M324.59,-819.73C371.71,-812.82 433.28,-803.79 478.7,-797.13"/>
<polygon fill="#dfff00" stroke="#dfff00" points="479.32,-800.58 488.71,-795.67 478.31,-793.65 479.32,-800.58"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_node27" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node27"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="659.5,-926 424.5,-926 424.5,-902 659.5,-902 659.5,-926"/>
<text text-anchor="middle" x="542" y="-911.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_edge19" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#dfff00" d="M280.86,-842.03C312.73,-856.14 368.29,-879.32 418,-893 427.4,-895.59 437.29,-897.91 447.22,-899.99"/>
<polygon fill="#dfff00" stroke="#dfff00" points="446.65,-903.44 457.14,-901.98 448.03,-896.58 446.65,-903.44"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_node28" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node28"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="666,-884 418,-884 418,-860 666,-860 666,-884"/>
<text text-anchor="middle" x="542" y="-869.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_edge20" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#dfff00" d="M324.59,-840.27C362,-845.76 408.52,-852.58 448.83,-858.49"/>
<polygon fill="#dfff00" stroke="#dfff00" points="448.53,-861.98 458.94,-859.97 449.55,-855.06 448.53,-861.98"/>
</g>
<!-- start -->
<g id="proc~~compute_mbe~~CallsGraph_node36" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="569,-842 515,-842 515,-818 569,-818 569,-842"/>
<text text-anchor="middle" x="542" y="-827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~compute_mbe~~CallsGraph_edge21" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#dfff00" d="M324.59,-830C381.48,-830 459.43,-830 504.59,-830"/>
<polygon fill="#dfff00" stroke="#dfff00" points="504.78,-833.5 514.78,-830 504.78,-826.5 504.78,-833.5"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#7fff00" d="M282.91,-644.05C375.95,-681.9 679.62,-792.53 925,-735 1100.71,-693.81 1286.32,-573.93 1352.9,-528.11"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1355.26,-530.72 1361.49,-522.15 1351.27,-524.97 1355.26,-530.72"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_node26" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node26"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="661,-602 423,-602 423,-578 661,-578 661,-602"/>
<text text-anchor="middle" x="542" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#7fff00" d="M314.21,-623.25C353.16,-617.54 404.77,-609.97 448.92,-603.5"/>
<polygon fill="#7fff00" stroke="#7fff00" points="449.71,-606.92 459.09,-602.01 448.69,-599.99 449.71,-606.92"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_node31" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node31"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-644 477,-644 477,-620 607,-620 607,-644"/>
<text text-anchor="middle" x="542" y="-629.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge25" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#7fff00" d="M314.21,-632C358.52,-632 419.21,-632 466.67,-632"/>
<polygon fill="#7fff00" stroke="#7fff00" points="466.89,-635.5 476.89,-632 466.89,-628.5 466.89,-635.5"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge28" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#1fff00" d="M323.12,-579.94C360.82,-574.41 408.09,-567.48 448.95,-561.49"/>
<polygon fill="#1fff00" stroke="#1fff00" points="449.53,-564.95 458.92,-560.03 448.52,-558.02 449.53,-564.95"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge26" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#1fff00" d="M323.12,-590C349.97,-590 381.67,-590 412.45,-590"/>
<polygon fill="#1fff00" stroke="#1fff00" points="412.85,-593.5 422.85,-590 412.85,-586.5 412.85,-593.5"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge27" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#1fff00" d="M323.12,-600.06C366.43,-606.41 422.37,-614.61 466.72,-621.11"/>
<polygon fill="#1fff00" stroke="#1fff00" points="466.46,-624.61 476.86,-622.6 467.48,-617.68 466.46,-624.61"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#00ff3f" d="M280.86,-535.97C312.73,-521.86 368.29,-498.68 418,-485 427.4,-482.41 437.29,-480.09 447.22,-478.01"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="448.03,-481.42 457.14,-476.02 446.65,-474.56 448.03,-481.42"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge29" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff3f" d="M321.31,-557.79C359.27,-563.36 407.36,-570.41 448.86,-576.49"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="448.58,-579.99 458.98,-577.98 449.59,-573.06 448.58,-579.99"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge30" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff3f" d="M321.31,-550.2C341.79,-553.14 363.72,-558.71 382,-569 403.42,-581.06 396.61,-598.88 418,-611 432.81,-619.39 450.12,-624.61 466.99,-627.82"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="466.41,-631.27 476.86,-629.48 467.58,-624.36 466.41,-631.27"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_node33" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node33"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="617.5,-518 466.5,-518 466.5,-494 617.5,-494 617.5,-518"/>
<text text-anchor="middle" x="542" y="-503.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge32" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#00ff9f" d="M321.67,-476.91C361.86,-482.24 413.31,-489.06 456.28,-494.76"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="456.07,-498.27 466.44,-496.11 456.99,-491.33 456.07,-498.27"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge33" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#009fff" d="M642.12,-555.75C650.7,-559.07 658.83,-563.4 666,-569 697.37,-593.5 670.86,-626.21 702,-651 718.6,-664.22 741.01,-670 761.31,-672.27"/>
<polygon fill="#009fff" stroke="#009fff" points="761.12,-675.77 771.38,-673.14 761.72,-668.79 761.12,-675.77"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge35" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#009fff" d="M642.12,-543.49C828,-535.04 1221.09,-517.16 1342.21,-511.65"/>
<polygon fill="#009fff" stroke="#009fff" points="1342.59,-515.14 1352.42,-511.19 1342.27,-508.14 1342.59,-515.14"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge34" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#009fff" d="M642.02,-554.42C650.78,-557.98 658.97,-562.73 666,-569 708.81,-607.21 659.55,-654.39 702,-693 721.88,-711.08 752.33,-715.79 776.23,-716.28"/>
<polygon fill="#009fff" stroke="#009fff" points="776.36,-719.78 786.35,-716.25 776.34,-712.78 776.36,-719.78"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_node22" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node22"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="896.5,-440 730.5,-440 730.5,-416 896.5,-416 896.5,-440"/>
<text text-anchor="middle" x="813.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge36" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#009fff" d="M642.01,-540.11C650.61,-536.82 658.78,-532.53 666,-527 696.31,-503.78 671.91,-472.5 702,-449 707.77,-444.5 714.21,-440.86 721.01,-437.94"/>
<polygon fill="#009fff" stroke="#009fff" points="722.35,-441.17 730.48,-434.37 719.89,-434.62 722.35,-441.17"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_node23" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node23"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="894,-600 733,-600 733,-576 894,-576 894,-600"/>
<text text-anchor="middle" x="813.5" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_edge37" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#009fff" d="M623.86,-560C654.92,-564.61 690.55,-569.9 722.42,-574.63"/>
<polygon fill="#009fff" stroke="#009fff" points="722.22,-578.14 732.63,-576.14 723.25,-571.21 722.22,-578.14"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_node24" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node24"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1163.5,-562 1024.5,-562 1024.5,-538 1163.5,-538 1163.5,-562"/>
<text text-anchor="middle" x="1094" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge38" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#009fff" d="M642.28,-548.36C748.97,-548.75 916.37,-549.36 1014.33,-549.71"/>
<polygon fill="#009fff" stroke="#009fff" points="1014.45,-553.21 1024.46,-549.75 1014.47,-546.21 1014.45,-553.21"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node25" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node25"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="925,-398 702,-398 702,-374 925,-374 925,-398"/>
<text text-anchor="middle" x="813.5" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge39" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#009fff" d="M642.26,-541.4C650.92,-537.86 659.02,-533.17 666,-527 707.71,-490.11 660.64,-444.28 702,-407 703.32,-405.81 704.69,-404.68 706.1,-403.6"/>
<polygon fill="#009fff" stroke="#009fff" points="708.15,-406.44 714.57,-398.02 704.3,-400.59 708.15,-406.44"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_node34" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node34"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="890.5,-482 736.5,-482 736.5,-458 890.5,-458 890.5,-482"/>
<text text-anchor="middle" x="813.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_edge40" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#009fff" d="M642.15,-535.98C650.4,-533.51 658.45,-530.55 666,-527 685.1,-518.01 683.18,-505.58 702,-496 710.54,-491.65 719.82,-488.02 729.25,-484.98"/>
<polygon fill="#009fff" stroke="#009fff" points="730.53,-488.25 739.11,-482.03 728.53,-481.55 730.53,-488.25"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge41" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#003fff" d="M633.11,-451.96C661.05,-448.23 691.88,-444.11 719.97,-440.36"/>
<polygon fill="#003fff" stroke="#003fff" points="720.74,-443.79 730.19,-438.99 719.82,-436.85 720.74,-443.79"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge42" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#003fff" d="M640.21,-453.27C649.18,-450.55 657.92,-447.18 666,-443 686.1,-432.61 682,-417.58 702,-407 705.79,-405 709.74,-403.18 713.79,-401.54"/>
<polygon fill="#003fff" stroke="#003fff" points="715.24,-404.74 723.42,-398.01 712.83,-398.17 715.24,-404.74"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node35" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node35"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="885.5,-356 741.5,-356 741.5,-332 885.5,-332 885.5,-356"/>
<text text-anchor="middle" x="813.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge43" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#003fff" d="M640.16,-456.8C649.44,-453.42 658.26,-448.93 666,-443 696.31,-419.78 671.91,-388.5 702,-365 710.66,-358.24 720.85,-353.43 731.48,-350.05"/>
<polygon fill="#003fff" stroke="#003fff" points="732.63,-353.36 741.34,-347.33 730.77,-346.62 732.63,-353.36"/>
</g>
<!-- header -->
<g id="proc~~compute_mbe~~CallsGraph_node20" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="569,-434 515,-434 515,-410 569,-410 569,-434"/>
<text text-anchor="middle" x="542" y="-419.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~compute_mbe~~CallsGraph_edge44" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#1f00ff" d="M328.58,-353.55C346.61,-357.94 365.45,-363.91 382,-372 400.46,-381.02 399.27,-392.55 418,-401 445.47,-413.39 479.41,-418.51 504.68,-420.61"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="504.71,-424.12 514.93,-421.34 505.2,-417.14 504.71,-424.12"/>
</g>
<!-- level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node21" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="579,-392 505,-392 505,-368 579,-368 579,-392"/>
<text text-anchor="middle" x="542" y="-377.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge45" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#1f00ff" d="M328.65,-351.84C381.11,-358.79 449.81,-367.9 494.66,-373.85"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="494.31,-377.34 504.68,-375.18 495.23,-370.4 494.31,-377.34"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node30" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node30"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="604,-266 480,-266 480,-242 604,-242 604,-266"/>
<text text-anchor="middle" x="542" y="-251.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge46" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#1f00ff" d="M279.1,-329.92C310.58,-314.93 367.13,-289.57 418,-275 434.54,-270.26 452.65,-266.44 469.77,-263.43"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="470.44,-266.86 479.72,-261.75 469.28,-259.96 470.44,-266.86"/>
</g>
<!-- verbose -->
<g id="proc~~compute_mbe~~CallsGraph_node37" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="569.5,-350 514.5,-350 514.5,-326 569.5,-326 569.5,-350"/>
<text text-anchor="middle" x="542" y="-335.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~compute_mbe~~CallsGraph_edge47" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#1f00ff" d="M328.65,-340.96C384.87,-340.18 459.75,-339.13 503.92,-338.52"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="504.24,-342.01 514.19,-338.37 504.15,-335.01 504.24,-342.01"/>
</g>
<!-- warning -->
<g id="proc~~compute_mbe~~CallsGraph_node38" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="569.5,-308 514.5,-308 514.5,-284 569.5,-284 569.5,-308"/>
<text text-anchor="middle" x="542" y="-293.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge48" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#1f00ff" d="M328.65,-330.09C384.99,-321.05 460.06,-309 504.2,-301.91"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="504.88,-305.35 514.19,-300.3 503.77,-298.43 504.88,-305.35"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge49" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#7f00ff" d="M332.07,-199.98C359.18,-196.32 389.87,-192.8 418,-191 609.32,-178.76 1205.9,-178.5 1227,-197 1312.07,-271.58 1197.87,-356.49 1263,-449 1281.87,-475.8 1316.25,-491.78 1342.61,-500.62"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1341.68,-504 1352.27,-503.66 1343.78,-497.32 1341.68,-504"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge50" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#7f00ff" d="M272.76,-199.84C302.57,-180.17 363.84,-140.61 418,-111 446.8,-95.25 480.47,-79.26 505.29,-67.91"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="507.02,-70.97 514.68,-63.64 504.13,-64.59 507.02,-70.97"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_node29" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node29"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="587.5,-224 496.5,-224 496.5,-200 587.5,-200 587.5,-224"/>
<text text-anchor="middle" x="542" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_edge51" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#7f00ff" d="M342.02,-212C389.04,-212 445.57,-212 486.33,-212"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="486.34,-215.5 496.34,-212 486.34,-208.5 486.34,-215.5"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge52" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#7f00ff" d="M336.6,-224.04C378.67,-230.2 429.41,-237.64 469.8,-243.56"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="469.44,-247.05 479.84,-245.03 470.45,-240.12 469.44,-247.05"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_node32" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node32"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="616.5,-144 467.5,-144 467.5,-120 616.5,-120 616.5,-144"/>
<text text-anchor="middle" x="542" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_edge53" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#7f00ff" d="M287.37,-199.95C320.15,-188.22 372.11,-170.39 418,-158 433.88,-153.71 451.07,-149.7 467.42,-146.16"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="468.42,-149.53 477.47,-144.03 466.97,-142.68 468.42,-149.53"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge54" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#7f00ff" d="M280.86,-224.03C312.73,-238.14 368.29,-261.32 418,-275 446.51,-282.84 479.59,-288.29 504.25,-291.67"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="503.9,-295.15 514.27,-292.99 504.82,-288.22 503.9,-295.15"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge55" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#df00ff" d="M340.07,-80.05C394.98,-72.39 463.46,-62.83 504.63,-57.08"/>
<polygon fill="#df00ff" stroke="#df00ff" points="505.32,-60.52 514.74,-55.67 504.35,-53.58 505.32,-60.52"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge56" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#ff00bf" d="M324.59,-21.79C381.6,-29.75 459.76,-40.66 504.87,-46.96"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="504.4,-50.42 514.78,-48.34 505.36,-43.49 504.4,-50.42"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge57" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#ff00bf" d="M324.5,-9.59C485.83,-5.58 895.38,-4.25 1227,-78 1268.12,-87.15 1313.16,-104.84 1343.35,-117.91"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1342.04,-121.16 1352.61,-121.97 1344.86,-114.75 1342.04,-121.16"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge63" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#daff00" d="M896.72,-437.14C906.62,-440.1 916.3,-443.96 925,-449 946.27,-461.32 941.3,-476.29 961,-491 986.35,-509.92 1018.73,-524.51 1045.08,-534.45"/>
<polygon fill="#daff00" stroke="#daff00" points="1043.89,-537.74 1054.48,-537.9 1046.3,-531.17 1043.89,-537.74"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node40" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node40"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1153,-482 1035,-482 1035,-458 1153,-458 1153,-482"/>
<text text-anchor="middle" x="1094" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge58" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#daff00" d="M894.31,-440.04C935.56,-446.26 985.38,-453.77 1024.82,-459.72"/>
<polygon fill="#daff00" stroke="#daff00" points="1024.46,-463.2 1034.87,-461.23 1025.5,-456.28 1024.46,-463.2"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_node43" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node43"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1178.5,-440 1009.5,-440 1009.5,-416 1178.5,-416 1178.5,-440"/>
<text text-anchor="middle" x="1094" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_edge59" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#daff00" d="M896.55,-428C928.69,-428 965.74,-428 998.95,-428"/>
<polygon fill="#daff00" stroke="#daff00" points="999.12,-431.5 1009.12,-428 999.12,-424.5 999.12,-431.5"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_node44" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node44"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1162.5,-356 1025.5,-356 1025.5,-332 1162.5,-332 1162.5,-356"/>
<text text-anchor="middle" x="1094" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_edge60" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#daff00" d="M896.72,-418.86C906.62,-415.9 916.3,-412.04 925,-407 946.27,-394.68 939.54,-377 961,-365 977.39,-355.83 996.62,-350.36 1015.25,-347.17"/>
<polygon fill="#daff00" stroke="#daff00" points="1015.85,-350.62 1025.21,-345.66 1014.8,-343.69 1015.85,-350.62"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node45" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node45"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1158,-398 1030,-398 1030,-374 1158,-374 1158,-398"/>
<text text-anchor="middle" x="1094" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge61" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#daff00" d="M894.31,-415.96C933.85,-410 981.27,-402.85 1019.86,-397.03"/>
<polygon fill="#daff00" stroke="#daff00" points="1020.62,-400.46 1029.98,-395.5 1019.57,-393.53 1020.62,-400.46"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_node46" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node46"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1171,-314 1017,-314 1017,-290 1171,-290 1171,-314"/>
<text text-anchor="middle" x="1094" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_edge62" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#daff00" d="M896.69,-421.84C906.93,-418.45 916.7,-413.67 925,-407 956.66,-381.56 928.96,-347.96 961,-323 974.11,-312.78 990.22,-306.64 1006.63,-303.09"/>
<polygon fill="#daff00" stroke="#daff00" points="1007.65,-306.46 1016.85,-301.2 1006.38,-299.58 1007.65,-306.46"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_node47" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node47"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1227,-272 961,-272 961,-248 1227,-248 1227,-272"/>
<text text-anchor="middle" x="1094" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_edge64" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#daff00" d="M896.67,-423.08C907.1,-419.53 916.93,-414.37 925,-407 968,-367.72 917.41,-319.63 961,-281 962.19,-279.94 963.42,-278.93 964.67,-277.95"/>
<polygon fill="#daff00" stroke="#daff00" points="967.02,-280.58 973.33,-272.07 963.09,-274.79 967.02,-280.58"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge65" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#91ff00" d="M894.31,-577.11C931.77,-572 976.3,-565.92 1013.7,-560.82"/>
<polygon fill="#91ff00" stroke="#91ff00" points="1014.62,-564.23 1024.05,-559.41 1013.67,-557.29 1014.62,-564.23"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node42" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node42"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1208.5,-230 979.5,-230 979.5,-206 1208.5,-206 1208.5,-230"/>
<text text-anchor="middle" x="1094" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge66" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#00ff00" d="M912.73,-373.9C917.12,-371.37 921.25,-368.42 925,-365 968,-325.72 917.41,-277.63 961,-239 964.04,-236.31 967.28,-233.88 970.68,-231.71"/>
<polygon fill="#00ff00" stroke="#00ff00" points="972.43,-234.74 979.44,-226.79 969,-228.63 972.43,-234.74"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_node39" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="853,-815 774,-815 774,-791 853,-791 853,-815"/>
<text text-anchor="middle" x="813.5" y="-800.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge67" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ff48" d="M653.68,-602.11C658.06,-604.67 662.2,-607.61 666,-611 708.81,-649.21 667.23,-689.34 702,-735 719.69,-758.23 747.8,-775.37 771.24,-786.63"/>
<polygon fill="#00ff48" stroke="#00ff48" points="770.08,-789.95 780.63,-790.95 773.01,-783.59 770.08,-789.95"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node41" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node41"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="877.5,-642 749.5,-642 749.5,-618 877.5,-618 877.5,-642"/>
<text text-anchor="middle" x="813.5" y="-627.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge68" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#00ff48" d="M623.86,-602C660.41,-607.43 703.29,-613.79 738.92,-619.08"/>
<polygon fill="#00ff48" stroke="#00ff48" points="738.85,-622.61 749.25,-620.61 739.88,-615.68 738.85,-622.61"/>
</g>
<!-- sort -->
<g id="proc~~compute_mbe~~CallsGraph_node49" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="840.5,-875 786.5,-875 786.5,-851 840.5,-851 840.5,-875"/>
<text text-anchor="middle" x="813.5" y="-860.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge69" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#00ff48" d="M654.99,-602.11C658.94,-604.68 662.63,-607.63 666,-611 733.83,-678.95 640.19,-750.54 702,-824 720.34,-845.79 751.67,-855.41 776.29,-859.66"/>
<polygon fill="#00ff48" stroke="#00ff48" points="775.97,-863.15 786.38,-861.17 777.01,-856.23 775.97,-863.15"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node48" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node48"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="872.5,-926 754.5,-926 754.5,-902 872.5,-902 872.5,-926"/>
<text text-anchor="middle" x="813.5" y="-911.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge70" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#00ff91" d="M659.64,-914C688.4,-914 718.27,-914 743.9,-914"/>
<polygon fill="#00ff91" stroke="#00ff91" points="744.24,-917.5 754.24,-914 744.24,-910.5 744.24,-917.5"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge71" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ffda" d="M623.74,-859.97C637.9,-857.36 652.44,-854.36 666,-851 701.94,-842.09 741.83,-828.79 770.89,-818.45"/>
<polygon fill="#00ffda" stroke="#00ffda" points="772.09,-821.74 780.32,-815.07 769.72,-815.15 772.09,-821.74"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge72" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#00ffda" d="M666.31,-867.88C706.26,-866.55 747.55,-865.17 776.02,-864.22"/>
<polygon fill="#00ffda" stroke="#00ffda" points="776.39,-867.71 786.27,-863.88 776.16,-860.71 776.39,-867.71"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node50" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node50"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1496,-230 1263,-230 1263,-206 1496,-206 1496,-230"/>
<text text-anchor="middle" x="1379.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge73" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#5cff00" d="M1208.68,-218C1223.2,-218 1238.12,-218 1252.82,-218"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1252.95,-221.5 1262.95,-218 1252.95,-214.5 1252.95,-221.5"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_node53" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node53"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1419,-440 1340,-440 1340,-416 1419,-416 1419,-440"/>
<text text-anchor="middle" x="1379.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_edge74" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff2e" d="M1178.53,-428C1227.76,-428 1288.34,-428 1329.84,-428"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1329.96,-431.5 1339.96,-428 1329.96,-424.5 1329.96,-431.5"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge75" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ffb9" d="M1162.6,-342.08C1185.03,-344.54 1208.88,-350.88 1227,-365 1259.04,-389.96 1235.47,-419.14 1263,-449 1284.71,-472.55 1317.63,-488.68 1342.77,-498.41"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1341.74,-501.76 1352.33,-501.95 1344.17,-495.2 1341.74,-501.76"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge78" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ffb9" d="M1162.62,-347.29C1185.45,-345.03 1209.55,-338.47 1227,-323 1270.59,-284.37 1226.61,-242.47 1263,-197 1283.37,-171.54 1316.94,-154.88 1342.65,-145.13"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1343.86,-148.41 1352.08,-141.73 1341.49,-141.83 1343.86,-148.41"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_node51" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node51"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1461,-377 1298,-377 1298,-353 1461,-353 1461,-377"/>
<text text-anchor="middle" x="1379.5" y="-362.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge76" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ffb9" d="M1162.55,-349C1199.99,-351.78 1247.05,-355.26 1287.68,-358.27"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1287.63,-361.78 1297.86,-359.03 1288.14,-354.8 1287.63,-361.78"/>
</g>
<!-- proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_node52" class="node">
<title>proc~error_set</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node52"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1432,-335 1327,-335 1327,-311 1432,-311 1432,-335"/>
<text text-anchor="middle" x="1379.5" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_edge77" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ffb9" d="M1162.55,-339C1209.44,-335.52 1271.43,-330.93 1316.96,-327.56"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1317.28,-331.04 1326.99,-326.82 1316.76,-324.06 1317.28,-331.04"/>
</g>
<!-- proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node54" class="node">
<title>proc~cgto_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node54"><a xlink:href="../proc/cgto_destroy.html" xlink:title="cgto_type%cgto_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1674,-230 1532,-230 1532,-206 1674,-206 1674,-230"/>
<text text-anchor="middle" x="1603" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cgto_type%cgto_destroy</text>
</a>
</g>
</g>
<!-- proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge79" class="edge">
<title>proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy</title>
<path fill="none" stroke="#ff0000" d="M1496.12,-218C1504.77,-218 1513.38,-218 1521.74,-218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1521.79,-221.5 1531.79,-218 1521.79,-214.5 1521.79,-221.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCallsGraph = svgPanZoom('#proccompute_mbeCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CalledByGraph Pages: 1 -->
<svg id="proccompute_mbeCalledByGraph" width="641pt" height="72pt"
 viewBox="0.00 0.00 641.00 72.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CalledByGraph" class="graph" transform="scale(0.62 0.62) rotate(0) translate(4 112)">
<title>proc~~compute_mbe~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 1025,-112 1025,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="1021,-66 932,-66 932,-42 1021,-42 1021,-66"/>
<text text-anchor="middle" x="976.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node2" class="node">
<title>proc~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node2"><a xlink:href="../proc/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="875.5,-87 762.5,-87 762.5,-63 875.5,-63 875.5,-87"/>
<text text-anchor="middle" x="819" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M875.7,-67.48C890.71,-65.45 906.92,-63.26 921.82,-61.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="922.45,-64.7 931.89,-59.89 921.51,-57.76 922.45,-64.7"/>
</g>
<!-- proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node3" class="node">
<title>proc~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node3"><a xlink:href="../proc/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="896,-45 742,-45 742,-21 896,-21 896,-45"/>
<text text-anchor="middle" x="819" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge2" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M896.38,-43.32C904.92,-44.47 913.47,-45.62 921.64,-46.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="921.36,-50.22 931.74,-48.09 922.3,-43.28 921.36,-50.22"/>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node4" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node4"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="685.5,-87 572.5,-87 572.5,-63 685.5,-63 685.5,-87"/>
<text text-anchor="middle" x="629" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge3" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M685.64,-75C706.58,-75 730.58,-75 752.35,-75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="752.5,-78.5 762.5,-75 752.5,-71.5 752.5,-78.5"/>
</g>
<!-- interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node5" class="node">
<title>interface~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node5"><a xlink:href="../interface/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#a7506f" stroke="#a7506f" points="706,-45 552,-45 552,-21 706,-21 706,-45"/>
<text text-anchor="middle" x="629" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge4" class="edge">
<title>interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M706.2,-33C714.52,-33 723.03,-33 731.47,-33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="731.7,-36.5 741.7,-33 731.7,-29.5 731.7,-36.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node6" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node6"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="516,-66 353,-66 353,-42 516,-42 516,-66"/>
<text text-anchor="middle" x="434.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge5" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M516.02,-62.78C531.42,-64.46 547.38,-66.21 562.25,-67.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.03,-71.32 572.35,-68.93 562.79,-64.37 562.03,-71.32"/>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge6" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" d="M516.02,-45.22C524.54,-44.29 533.22,-43.34 541.8,-42.4"/>
<polygon fill="#00ffff" stroke="#00ffff" points="542.24,-45.88 551.8,-41.31 541.48,-38.92 542.24,-45.88"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node7" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node7"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-66 223,-66 223,-42 317,-42 317,-66"/>
<text text-anchor="middle" x="270" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge7" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M317.13,-54C325.24,-54 333.94,-54 342.78,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.8,-57.5 352.8,-54 342.8,-50.5 342.8,-57.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~compute_mbe~~CalledByGraph_node8" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node8"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="176.5,-108 10.5,-108 10.5,-84 176.5,-84 176.5,-108"/>
<text text-anchor="middle" x="93.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge8" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M148.85,-83.92C161.39,-81.06 174.67,-77.98 187,-75 195.32,-72.99 204.09,-70.81 212.69,-68.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.82,-71.96 222.65,-66.11 212.1,-65.18 213.82,-71.96"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~compute_mbe~~CalledByGraph_node9" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node9"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="187,-66 0,-66 0,-42 187,-42 187,-66"/>
<text text-anchor="middle" x="93.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge9" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M187.11,-54C195.83,-54 204.48,-54 212.7,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.87,-57.5 222.87,-54 212.87,-50.5 212.87,-57.5"/>
</g>
<!-- program~main -->
<g id="proc~~compute_mbe~~CalledByGraph_node10" class="node">
<title>program~main</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node10"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="120.5,-24 66.5,-24 66.5,0 120.5,0 120.5,-24"/>
<text text-anchor="middle" x="93.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge10" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M120.86,-17.78C139.39,-21.9 164.75,-27.63 187,-33 195.32,-35.01 204.09,-37.19 212.69,-39.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.1,-42.82 222.65,-41.89 213.82,-36.04 212.1,-42.82"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCalledByGraph = svgPanZoom('#proccompute_mbeCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_grad"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_grad</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_hess"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_hess</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_log_level~5"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_log_level</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_e~2"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>delta_E</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_gradients~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_gradients</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_hessians~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_hessians</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-do_detailed_print"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>do_detailed_print</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_size~3"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_size</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hess_dim~4"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>hess_dim</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~11"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lookup~5"></span>
              type(<a href='../type/fragment_lookup_t.html'>fragment_lookup_t</a>),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lookup</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nlevel~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nlevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sum_by_level~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sum_by_level</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Compute many-body expansion (MBE) energy with optional gradient and/or hessian</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! This is the core routine that handles all MBE computations.</span>
<span class="w">      </span><span class="c">!! Optional arguments control what derivatives are computed:</span>
<span class="w">      </span><span class="c">!!   - If sys_geom and total_gradient are present: compute gradient</span>
<span class="w">      </span><span class="c">!!   - If total_hessian is also present: compute hessian</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_result_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculation_result_t</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_config_parser</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">bond_t</span>

<span class="w">      </span><span class="c">! Required arguments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_energy</span>

<span class="w">      </span><span class="c">! Optional arguments for gradient computation</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! (3, total_atoms)</span>

<span class="w">      </span><span class="c">! Optional arguments for hessian computation</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">   </span><span class="c">!! (3*total_atoms, 3*total_atoms)</span>

<span class="w">      </span><span class="c">! Optional bond information for hydrogen cap handling</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span>

<span class="w">      </span><span class="c">! Local variables</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(:),</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(:),</span><span class="w"> </span><span class="n">energies</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">do_detailed_print</span><span class="p">,</span><span class="w"> </span><span class="n">compute_grad</span><span class="p">,</span><span class="w"> </span><span class="n">compute_hess</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">fragment_lookup_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lookup</span>

<span class="w">      </span><span class="c">! Determine what to compute based on optional arguments</span>
<span class="w">      </span><span class="n">compute_grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">total_gradient</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_hess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_grad</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">total_hessian</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Validate inputs for gradient computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_gradient</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have gradient!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Missing gradient in compute_mbe_internal&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Validate inputs for hessian computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_hessian</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have Hessian!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Missing Hessian in compute_mbe_internal&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">hess_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Get logger configuration</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">configuration</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="n">do_detailed_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">current_log_level</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">verbose_level</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Allocate energy arrays (always needed)</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="n">sum_by_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="n">delta_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">      </span><span class="c">! Extract total energies from results</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">         </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">energy</span><span class="p">%</span><span class="n">total</span><span class="p">()</span>
<span class="w">      </span><span class="k">end do</span>

<span class="w">      </span><span class="c">! Allocate gradient arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_gradients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate hessian arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">(</span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_hessians</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Build hash table for fast fragment lookups</span>
<span class="w">      </span><span class="k">call </span><span class="n">build_mbe_lookup_table</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">lookup</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Bottom-up computation: process fragments by size (1-body, then 2-body, etc.)</span>
<span class="w">      </span><span class="c">! This makes the algorithm independent of input fragment order</span>
<span class="w">      </span><span class="c">! We process by n-mer level to ensure all subsets are computed before they&#39;re needed</span>
<span class="w">      </span><span class="k">do </span><span class="n">nlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Only process fragments of the current nlevel</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! 1-body: delta = value (no subsets to subtract)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_gradient</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_hessian</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                   </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">            else if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! n-body: delta = value - sum(all subset deltas)</span>
<span class="w">               </span><span class="n">delta_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_mbe_delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_E</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_gradient</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_hessian</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end do</span>

<span class="w">      </span><span class="c">! Clean up lookup table</span>
<span class="w">      </span><span class="k">call </span><span class="n">lookup</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>

<span class="w">      </span><span class="c">! Compute totals</span>
<span class="w">      </span><span class="n">total_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">)</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print energy breakdown (always)</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_mbe_energy_breakdown</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Print gradient info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_mbe_gradient_info</span><span class="p">(</span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print hessian info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MBE Hessian computation completed&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Total Hessian Frobenius norm: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">total_hessian</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print detailed breakdown if requested</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">do_detailed_print</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Write JSON output with appropriate arguments</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">)</span>

<span class="w">   </span><span class="k">end subroutine </span><span class="n">compute_mbe</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-07 09:12 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>