<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>global_coordinator &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>global_coordinator
      <small>Module Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 2.1% of total for procedures.">141 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe_mpi_fragment_distribution_scheme.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe_mpi_fragment_distribution_scheme.f90.html'>mqc_mbe_mpi_fragment_distribution_scheme.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe_fragment_distribution_scheme.html'>mqc_mbe_fragment_distribution_scheme</a></li>
            <li class="breadcrumb-item active" aria-current="page">global_coordinator</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-calc_type_local~3">calc_type_local</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-coord_timer~4">coord_timer</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-current_fragment">current_fragment</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-dummy_msg~4">dummy_msg</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-finished_nodes~2">finished_nodes</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-fragment_idx~7">fragment_idx</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-handling_local_workers~2">handling_local_workers</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-has_pending~3">has_pending</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_dummy~2">local_dummy</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_finished_workers~2">local_finished_workers</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_status~2">local_status</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-req~8">req</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-request_source~2">request_source</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-results~7">results</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-results_received~2">results_received</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-status~6">status</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-worker_fragment_map">worker_fragment_map</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-worker_source~2">worker_source</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/global_coordinator.html#src">global_coordinator</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>module subroutine global_coordinator(world_comm, node_comm, total_fragments, polymers, max_level, node_leader_ranks, num_nodes, sys_geom, calc_type, bonds)  
    <a href="../interface/global_coordinator.html"><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
</h2>
    

    <p>Global coordinator for distributing fragments to node coordinators
will act as a node coordinator for a single node calculation
Uses int64 for total_fragments to handle large fragment counts that overflow int32.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~13"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_comm~7"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_comm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_fragments~4"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_fragments</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~8"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~10"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_leader_ranks~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_leader_ranks</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-num_nodes~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>num_nodes</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~37"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-calc_type~14"></span>
              integer(kind=int32),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>calc_type</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~20"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~global_coordinator~~CallsGraph Pages: 1 -->
<svg id="procglobal_coordinatorCallsGraph" width="641pt" height="472pt"
 viewBox="0.00 0.00 641.00 471.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~global_coordinator~~CallsGraph" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 1257.6)">
<title>proc~~global_coordinator~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1257.6 1711,-1257.6 1711,4 -4,4"/>
<!-- proc~global_coordinator -->
<g id="proc~~global_coordinator~~CallsGraph_node1" class="node">
<title>proc~global_coordinator</title>
<polygon fill="none" stroke="black" points="113,-572.37 0,-572.37 0,-548.37 113,-548.37 113,-572.37"/>
<text text-anchor="middle" x="56.5" y="-557.97" font-family="Helvetica,sans-Serif" font-size="10.50">global_coordinator</text>
</g>
<!-- debug -->
<g id="proc~~global_coordinator~~CallsGraph_node2" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="1051.5,-919.37 997.5,-919.37 997.5,-895.37 1051.5,-895.37 1051.5,-919.37"/>
<text text-anchor="middle" x="1024.5" y="-904.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~global_coordinator&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;debug</title>
<path fill="none" stroke="#ff0000" d="M61.23,-572.41C79.7,-629.7 167.25,-875.99 336,-974.37 440.12,-1035.07 776.39,-1078.71 877,-1012.37 910.91,-990.01 881.34,-953.81 913,-928.37 933.73,-911.72 963.66,-906.84 987.15,-905.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="987.49,-909.41 997.43,-905.75 987.37,-902.41 987.49,-909.41"/>
</g>
<!-- error -->
<g id="proc~~global_coordinator~~CallsGraph_node3" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1617.5,-793.37 1563.5,-793.37 1563.5,-769.37 1617.5,-769.37 1617.5,-793.37"/>
<text text-anchor="middle" x="1590.5" y="-778.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~global_coordinator&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge2" class="edge">
<title>proc~global_coordinator&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M57.79,-572.58C59.8,-647.19 73.91,-1041.2 149,-1129.37 244.45,-1241.45 316.28,-1233.37 463.5,-1233.37 463.5,-1233.37 463.5,-1233.37 1025.5,-1233.37 1210.58,-1233.37 1305.02,-1305.1 1438,-1176.37 1506.04,-1110.51 1440.29,-1054.86 1474,-966.37 1498.87,-901.08 1547.89,-833.8 1573.33,-801.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1576.08,-803.48 1579.55,-793.47 1570.59,-799.13 1576.08,-803.48"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_node4" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="806,-423.37 700,-423.37 700,-399.37 806,-399.37 806,-423.37"/>
<text text-anchor="middle" x="753" y="-408.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~global_coordinator&#45;&gt;get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_edge3" class="edge">
<title>proc~global_coordinator&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#ff0000" d="M76.16,-572.39C120.55,-599.32 233.69,-657.95 300,-602.37 370.22,-543.51 265.78,-458.23 336,-399.37 387.91,-355.85 586.95,-382.52 689.75,-399.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="689.24,-403.37 699.68,-401.61 690.42,-396.47 689.24,-403.37"/>
</g>
<!-- info -->
<g id="proc~~global_coordinator~~CallsGraph_node5" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="780,-465.37 726,-465.37 726,-441.37 780,-441.37 780,-465.37"/>
<text text-anchor="middle" x="753" y="-450.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~global_coordinator&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge4" class="edge">
<title>proc~global_coordinator&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M69.9,-548.36C86.44,-533.15 117.33,-507.46 149,-495.37 253.47,-455.48 601.93,-452.9 715.71,-453.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="715.97,-456.65 725.98,-453.19 715.99,-449.65 715.97,-456.65"/>
</g>
<!-- iprobe -->
<g id="proc~~global_coordinator~~CallsGraph_node6" class="node">
<title>iprobe</title>
<polygon fill="#777777" stroke="#777777" points="251.5,-716.37 197.5,-716.37 197.5,-692.37 251.5,-692.37 251.5,-716.37"/>
<text text-anchor="middle" x="224.5" y="-701.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iprobe</text>
</g>
<!-- proc~global_coordinator&#45;&gt;iprobe -->
<g id="proc~~global_coordinator~~CallsGraph_edge5" class="edge">
<title>proc~global_coordinator&#45;&gt;iprobe</title>
<path fill="none" stroke="#ff0000" d="M63.14,-572.6C75.22,-597.4 106.03,-653.79 149,-683.37 160.27,-691.13 174.35,-696.04 187.23,-699.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="186.72,-702.6 197.23,-701.25 188.17,-695.76 186.72,-702.6"/>
</g>
<!-- irecv -->
<g id="proc~~global_coordinator~~CallsGraph_node7" class="node">
<title>irecv</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-1125.37 437.5,-1125.37 437.5,-1101.37 491.5,-1101.37 491.5,-1125.37"/>
<text text-anchor="middle" x="464.5" y="-1110.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">irecv</text>
</g>
<!-- proc~global_coordinator&#45;&gt;irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge6" class="edge">
<title>proc~global_coordinator&#45;&gt;irecv</title>
<path fill="none" stroke="#ff0000" d="M57.65,-572.53C58.79,-645.05 68.6,-1019.9 149,-1092.37 226.36,-1162.1 362.52,-1139.76 427.29,-1123.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="428.24,-1127.07 437.06,-1121.19 426.5,-1120.29 428.24,-1127.07"/>
</g>
<!-- isend -->
<g id="proc~~global_coordinator~~CallsGraph_node8" class="node">
<title>isend</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-107.37 437.5,-107.37 437.5,-83.37 491.5,-83.37 491.5,-107.37"/>
<text text-anchor="middle" x="464.5" y="-92.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isend</text>
</g>
<!-- proc~global_coordinator&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge7" class="edge">
<title>proc~global_coordinator&#45;&gt;isend</title>
<path fill="none" stroke="#ff0000" d="M62.26,-548.25C74.65,-517.26 109.67,-433.05 149,-368.37 184.77,-309.55 277.74,-158.05 336,-121.37 363.42,-104.1 400.15,-98.02 427.14,-96.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="427.55,-99.5 437.33,-95.41 427.14,-92.51 427.55,-99.5"/>
</g>
<!-- mbe_total_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node9" class="node">
<title>mbe_total_gradient</title>
<polygon fill="#777777" stroke="#777777" points="282.5,-593.37 166.5,-593.37 166.5,-569.37 282.5,-569.37 282.5,-593.37"/>
<text text-anchor="middle" x="224.5" y="-578.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_total_gradient</text>
</g>
<!-- proc~global_coordinator&#45;&gt;mbe_total_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge8" class="edge">
<title>proc~global_coordinator&#45;&gt;mbe_total_gradient</title>
<path fill="none" stroke="#ff0000" d="M113.24,-567.42C127.03,-569.17 141.96,-571.05 156.24,-572.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.13,-576.38 166.49,-574.16 157.01,-569.43 156.13,-576.38"/>
</g>
<!-- mbe_total_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node10" class="node">
<title>mbe_total_hessian</title>
<polygon fill="#777777" stroke="#777777" points="280.5,-551.37 168.5,-551.37 168.5,-527.37 280.5,-527.37 280.5,-551.37"/>
<text text-anchor="middle" x="224.5" y="-536.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_total_hessian</text>
</g>
<!-- proc~global_coordinator&#45;&gt;mbe_total_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge9" class="edge">
<title>proc~global_coordinator&#45;&gt;mbe_total_hessian</title>
<path fill="none" stroke="#ff0000" d="M113.24,-553.32C127.7,-551.49 143.41,-549.5 158.31,-547.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.99,-551.06 168.47,-546.33 158.11,-544.11 158.99,-551.06"/>
</g>
<!-- proc~compute_mbe -->
<g id="proc~~global_coordinator~~CallsGraph_node11" class="node">
<title>proc~compute_mbe</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node11"><a xlink:href="../proc/compute_mbe.html" xlink:title="compute_mbe">
<polygon fill="#d9534f" stroke="#d9534f" points="269,-674.37 180,-674.37 180,-650.37 269,-650.37 269,-674.37"/>
<text text-anchor="middle" x="224.5" y="-659.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~global_coordinator~~CallsGraph_edge10" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M69.52,-572.53C86.11,-588.75 117.58,-617.5 149,-635.37 156.48,-639.62 164.75,-643.41 172.98,-646.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="171.98,-650.07 182.57,-650.34 174.46,-643.52 171.98,-650.07"/>
</g>
<!-- proc~result_irecv -->
<g id="proc~~global_coordinator~~CallsGraph_node12" class="node">
<title>proc~result_irecv</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node12"><a xlink:href="../proc/result_irecv.html" xlink:title="result_irecv">
<polygon fill="#d9534f" stroke="#d9534f" points="261,-1083.37 188,-1083.37 188,-1059.37 261,-1059.37 261,-1083.37"/>
<text text-anchor="middle" x="224.5" y="-1068.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">result_irecv</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~result_irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge11" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~result_irecv</title>
<path fill="none" stroke="#ff0000" d="M58.18,-572.49C62.18,-640.16 84.85,-970.85 149,-1045.37 156.53,-1054.12 167.19,-1059.93 178.08,-1063.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.07,-1067.13 187.65,-1066.69 179.1,-1060.43 177.07,-1067.13"/>
</g>
<!-- proc~send_fragment_to_node -->
<g id="proc~~global_coordinator~~CallsGraph_node13" class="node">
<title>proc~send_fragment_to_node</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node13"><a xlink:href="../proc/send_fragment_to_node.html" xlink:title="send_fragment_to_node">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-138.37 154,-138.37 154,-114.37 295,-114.37 295,-138.37"/>
<text text-anchor="middle" x="224.5" y="-123.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_node</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_node -->
<g id="proc~~global_coordinator~~CallsGraph_edge12" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_node</title>
<path fill="none" stroke="#ff0000" d="M60.67,-548.14C71.21,-508.11 106.79,-377.64 149,-274.37 167.98,-227.92 195.69,-176.06 211.41,-147.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.62,-149.17 216.44,-138.73 208.51,-145.75 214.62,-149.17"/>
</g>
<!-- proc~send_fragment_to_worker -->
<g id="proc~~global_coordinator~~CallsGraph_node14" class="node">
<title>proc~send_fragment_to_worker</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node14"><a xlink:href="../proc/send_fragment_to_worker.html" xlink:title="send_fragment_to_worker">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-401.37 149,-401.37 149,-377.37 300,-377.37 300,-401.37"/>
<text text-anchor="middle" x="224.5" y="-386.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_worker</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker -->
<g id="proc~~global_coordinator~~CallsGraph_edge13" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker</title>
<path fill="none" stroke="#ff0000" d="M65.73,-548.26C80.81,-526.54 114.51,-480.07 149,-446.37 163.8,-431.91 182.26,-417.76 197.1,-407.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.19,-409.99 205.37,-401.38 195.17,-404.26 199.19,-409.99"/>
</g>
<!-- start -->
<g id="proc~~global_coordinator~~CallsGraph_node15" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="780,-145.37 726,-145.37 726,-121.37 780,-121.37 780,-145.37"/>
<text text-anchor="middle" x="753" y="-130.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~global_coordinator&#45;&gt;start -->
<g id="proc~~global_coordinator~~CallsGraph_edge14" class="edge">
<title>proc~global_coordinator&#45;&gt;start</title>
<path fill="none" stroke="#ff0000" d="M58.15,-547.96C61.88,-481.61 82.8,-169.34 149,-105.37 220.12,-36.64 495.65,-56.89 593,-74.37 638.04,-82.46 687,-102.47 718.51,-116.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="717.17,-120.18 727.71,-121.25 720.13,-113.84 717.17,-120.18"/>
</g>
<!-- to_char -->
<g id="proc~~global_coordinator~~CallsGraph_node16" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1617.5,-147.37 1563.5,-147.37 1563.5,-123.37 1617.5,-123.37 1617.5,-147.37"/>
<text text-anchor="middle" x="1590.5" y="-132.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~global_coordinator&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge15" class="edge">
<title>proc~global_coordinator&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M57.84,-548C60.05,-477.46 74.68,-126.62 149,-56.37 251.35,40.39 322.65,-17.37 463.5,-17.37 463.5,-17.37 463.5,-17.37 1025.5,-17.37 1229.23,-17.37 1465.74,-92.05 1553.95,-122.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1552.88,-125.92 1563.48,-125.91 1555.19,-119.31 1552.88,-125.92"/>
</g>
<!-- verbose -->
<g id="proc~~global_coordinator~~CallsGraph_node17" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="780.5,-675.37 725.5,-675.37 725.5,-651.37 780.5,-651.37 780.5,-675.37"/>
<text text-anchor="middle" x="753" y="-660.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~global_coordinator&#45;&gt;verbose -->
<g id="proc~~global_coordinator~~CallsGraph_edge16" class="edge">
<title>proc~global_coordinator&#45;&gt;verbose</title>
<path fill="none" stroke="#ff0000" d="M77.31,-548.3C121.27,-523.23 228.74,-471.6 300,-518.37 333.62,-540.43 304.11,-576.88 336,-601.37 339.78,-604.27 614.29,-643.71 715.26,-658.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="714.91,-661.62 725.31,-659.57 715.9,-654.69 714.91,-661.62"/>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge18" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#009fff" d="M248.77,-650.18C265.95,-639.87 288.29,-623.41 300,-602.37 363.57,-488.1 265.78,-420.67 336,-310.37 408.38,-196.67 488.14,-234.06 593,-149.37 610.85,-134.95 607.86,-121.3 629,-112.37 730.54,-69.49 768.01,-95.92 877,-112.37 1164.6,-155.78 1262.69,-217.28 1438,-449.37 1516.22,-552.93 1566.26,-703.33 1583.14,-759.3"/>
<polygon fill="#009fff" stroke="#009fff" points="1579.87,-760.6 1586.07,-769.2 1586.59,-758.61 1579.87,-760.6"/>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge19" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#009fff" d="M269.26,-653.95C280.51,-649.95 291.76,-644.05 300,-635.37 337.76,-595.61 294.55,-553.26 336,-517.37 343.22,-511.12 616.18,-472.38 715.96,-458.4"/>
<polygon fill="#009fff" stroke="#009fff" points="716.46,-461.86 725.88,-457.01 715.49,-454.93 716.46,-461.86"/>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge32" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#009fff" d="M249.03,-650.32C266.34,-640.08 288.75,-623.66 300,-602.37 347.17,-513.08 266.34,-222.48 336,-149.37 375.72,-107.68 540.59,-140.23 593,-116.37 612.48,-107.5 608.99,-91.98 629,-84.37 732.03,-45.2 766.85,-80.43 877,-84.37 1136.71,-93.65 1448.65,-121.91 1553.3,-131.86"/>
<polygon fill="#009fff" stroke="#009fff" points="1553.05,-135.35 1563.33,-132.82 1553.71,-128.38 1553.05,-135.35"/>
</g>
<!-- configuration -->
<g id="proc~~global_coordinator~~CallsGraph_node18" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="1066.5,-961.37 982.5,-961.37 982.5,-937.37 1066.5,-937.37 1066.5,-961.37"/>
<text text-anchor="middle" x="1024.5" y="-946.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~global_coordinator~~CallsGraph_edge17" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#009fff" d="M269.04,-667.65C280.16,-670.76 291.39,-675.66 300,-683.37 331.78,-711.84 302.47,-745.99 336,-772.37 426.75,-843.76 490.56,-757.09 593,-810.37 613.64,-821.1 608.39,-837.58 629,-848.37 727.79,-900.08 779.52,-832.22 877,-886.37 898.49,-898.31 891.73,-916.05 913,-928.37 930.84,-938.7 952.77,-944.09 972.37,-946.84"/>
<polygon fill="#009fff" stroke="#009fff" points="972.02,-950.33 982.37,-948.06 972.87,-943.38 972.02,-950.33"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~global_coordinator~~CallsGraph_node19" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node19"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="535.5,-343.37 393.5,-343.37 393.5,-319.37 535.5,-319.37 535.5,-343.37"/>
<text text-anchor="middle" x="464.5" y="-328.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~global_coordinator~~CallsGraph_edge20" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#009fff" d="M248.11,-650.22C265.16,-639.82 287.66,-623.24 300,-602.37 346.65,-523.5 282.15,-473.51 336,-399.37 354.19,-374.33 384.45,-357.64 410.93,-347.05"/>
<polygon fill="#009fff" stroke="#009fff" points="412.37,-350.25 420.48,-343.43 409.89,-343.7 412.37,-350.25"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~global_coordinator~~CallsGraph_node20" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node20"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-721.37 404,-721.37 404,-697.37 525,-697.37 525,-721.37"/>
<text text-anchor="middle" x="464.5" y="-706.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~global_coordinator~~CallsGraph_edge21" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#009fff" d="M269.15,-670.99C304.04,-677.88 353.6,-687.67 393.95,-695.63"/>
<polygon fill="#009fff" stroke="#009fff" points="393.5,-699.11 403.99,-697.62 394.86,-692.25 393.5,-699.11"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node21" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node21"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="534,-885.37 395,-885.37 395,-861.37 534,-861.37 534,-885.37"/>
<text text-anchor="middle" x="464.5" y="-870.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge22" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#009fff" d="M269.2,-666.48C280.58,-669.56 291.91,-674.74 300,-683.37 352.51,-739.41 280.45,-799.35 336,-852.37 349.21,-864.98 366.92,-871.69 384.92,-874.99"/>
<polygon fill="#009fff" stroke="#009fff" points="384.52,-878.46 394.93,-876.48 385.56,-871.54 384.52,-878.46"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node22" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node22"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="532,-843.37 397,-843.37 397,-819.37 532,-819.37 532,-843.37"/>
<text text-anchor="middle" x="464.5" y="-828.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#009fff" d="M269.16,-667C280.41,-670.1 291.68,-675.15 300,-683.37 340.22,-723.1 294.35,-767.15 336,-805.37 349.9,-818.12 368.29,-825.32 386.77,-829.24"/>
<polygon fill="#009fff" stroke="#009fff" points="386.25,-832.7 396.72,-831.04 387.5,-825.81 386.25,-832.7"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~global_coordinator~~CallsGraph_node23" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node23"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="532.5,-965.37 396.5,-965.37 396.5,-941.37 532.5,-941.37 532.5,-965.37"/>
<text text-anchor="middle" x="464.5" y="-950.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~global_coordinator~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#009fff" d="M269.17,-666.05C280.69,-669.11 292.1,-674.39 300,-683.37 372.38,-765.69 260.64,-847.77 336,-927.37 349.23,-941.34 367.76,-948.89 386.61,-952.75"/>
<polygon fill="#009fff" stroke="#009fff" points="386.02,-956.2 396.47,-954.45 387.21,-949.3 386.02,-956.2"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node24" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node24"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="593,-763.37 336,-763.37 336,-739.37 593,-739.37 593,-763.37"/>
<text text-anchor="middle" x="464.5" y="-748.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge25" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#009fff" d="M269.33,-669.71C279.96,-672.81 290.88,-677.18 300,-683.37 321.78,-698.14 313.43,-716.84 336,-730.37 338.89,-732.1 341.87,-733.7 344.93,-735.18"/>
<polygon fill="#009fff" stroke="#009fff" points="343.77,-738.49 354.34,-739.26 346.56,-732.07 343.77,-738.49"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node25" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node25"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="853,-1083.37 653,-1083.37 653,-1059.37 853,-1059.37 853,-1083.37"/>
<text text-anchor="middle" x="753" y="-1068.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge26" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#009fff" d="M269.3,-665.94C280.83,-668.99 292.21,-674.3 300,-683.37 384.9,-782.24 248.86,-877.47 336,-974.37 358.38,-999.26 556.12,-1037.29 670.73,-1057.55"/>
<polygon fill="#009fff" stroke="#009fff" points="670.42,-1061.04 680.87,-1059.33 671.63,-1054.15 670.42,-1061.04"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node26" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node26"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="851,-961.37 655,-961.37 655,-937.37 851,-937.37 851,-961.37"/>
<text text-anchor="middle" x="753" y="-946.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge27" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#009fff" d="M269.04,-666.17C280.56,-669.23 292,-674.48 300,-683.37 363.62,-754.1 267.48,-828.38 336,-894.37 341.58,-899.74 523.39,-922.26 644.79,-936.76"/>
<polygon fill="#009fff" stroke="#009fff" points="644.53,-940.26 654.88,-937.96 645.36,-933.3 644.53,-940.26"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_node27" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node27"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="539.5,-674.37 389.5,-674.37 389.5,-650.37 539.5,-650.37 539.5,-674.37"/>
<text text-anchor="middle" x="464.5" y="-659.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_edge28" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#009fff" d="M269.15,-662.37C299.82,-662.37 341.83,-662.37 378.94,-662.37"/>
<polygon fill="#009fff" stroke="#009fff" points="379.27,-665.87 389.27,-662.37 379.27,-658.87 379.27,-665.87"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~global_coordinator~~CallsGraph_node28" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node28"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="553,-592.37 376,-592.37 376,-568.37 553,-568.37 553,-592.37"/>
<text text-anchor="middle" x="464.5" y="-577.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~global_coordinator~~CallsGraph_edge29" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#009fff" d="M260.36,-650.36C302.34,-635.89 372.93,-611.58 418.85,-595.75"/>
<polygon fill="#009fff" stroke="#009fff" points="420.23,-598.98 428.54,-592.41 417.95,-592.36 420.23,-598.98"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_node29" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node29"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="551,-550.37 378,-550.37 378,-526.37 551,-526.37 551,-550.37"/>
<text text-anchor="middle" x="464.5" y="-535.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_edge30" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#009fff" d="M269.24,-652.85C280.23,-648.86 291.35,-643.24 300,-635.37 327.65,-610.22 306.15,-581.86 336,-559.37 345.52,-552.2 356.58,-547.1 368.13,-543.52"/>
<polygon fill="#009fff" stroke="#009fff" points="369.19,-546.86 377.92,-540.86 367.35,-540.1 369.19,-546.86"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~global_coordinator~~CallsGraph_node30" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node30"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="535.5,-432.37 393.5,-432.37 393.5,-408.37 535.5,-408.37 535.5,-432.37"/>
<text text-anchor="middle" x="464.5" y="-417.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~global_coordinator~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#009fff" d="M269.23,-654.42C280.62,-650.42 291.94,-644.4 300,-635.37 345.94,-583.89 293.17,-538.46 336,-484.37 354.27,-461.3 383.05,-445.86 408.64,-435.93"/>
<polygon fill="#009fff" stroke="#009fff" points="410.09,-439.13 418.27,-432.39 407.67,-432.56 410.09,-439.13"/>
</g>
<!-- proc~result_irecv&#45;&gt;irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge33" class="edge">
<title>proc~result_irecv&#45;&gt;irecv</title>
<path fill="none" stroke="#003fff" d="M261.29,-1078.4C282.9,-1082.59 311,-1087.94 336,-1092.37 366.67,-1097.81 401.59,-1103.53 427.11,-1107.62"/>
<polygon fill="#003fff" stroke="#003fff" points="426.67,-1111.09 437.1,-1109.21 427.77,-1104.18 426.67,-1111.09"/>
</g>
<!-- recv -->
<g id="proc~~global_coordinator~~CallsGraph_node31" class="node">
<title>recv</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-1083.37 437.5,-1083.37 437.5,-1059.37 491.5,-1059.37 491.5,-1083.37"/>
<text text-anchor="middle" x="464.5" y="-1068.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">recv</text>
</g>
<!-- proc~result_irecv&#45;&gt;recv -->
<g id="proc~~global_coordinator~~CallsGraph_edge34" class="edge">
<title>proc~result_irecv&#45;&gt;recv</title>
<path fill="none" stroke="#003fff" d="M261.13,-1071.37C305.79,-1071.37 381.93,-1071.37 427,-1071.37"/>
<polygon fill="#003fff" stroke="#003fff" points="427.2,-1074.87 437.2,-1071.37 427.2,-1067.87 427.2,-1074.87"/>
</g>
<!-- proc~send_fragment_to_node&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge35" class="edge">
<title>proc~send_fragment_to_node&#45;&gt;isend</title>
<path fill="none" stroke="#1f00ff" d="M295.3,-117.28C338.56,-111.64 392.34,-104.64 427.27,-100.09"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="428.01,-103.52 437.48,-98.76 427.11,-96.58 428.01,-103.52"/>
</g>
<!-- proc~send_fragment_to_worker&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge36" class="edge">
<title>proc~send_fragment_to_worker&#45;&gt;isend</title>
<path fill="none" stroke="#7f00ff" d="M239.47,-377.35C256.56,-361.83 285.05,-333.13 300,-302.37 335.84,-228.6 278.14,-179.51 336,-121.37 359.63,-97.62 398.67,-92.66 427.33,-92.69"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="427.3,-96.19 437.37,-92.91 427.45,-89.2 427.3,-96.19"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge37" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#ff6d00" d="M535.95,-340.33C652,-355.26 871.22,-384.17 877,-390.37 952.36,-471.2 839.49,-803.85 913,-886.37 931.18,-906.78 962.53,-911.15 987.2,-910.92"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="987.43,-914.41 997.3,-910.57 987.19,-907.41 987.43,-914.41"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_edge38" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#ff6d00" d="M519.39,-343.39C542.44,-349.24 569.41,-357.04 593,-366.37 609.82,-373.03 611.99,-379.22 629,-385.37 648.4,-392.39 670.25,-397.77 690.08,-401.76"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="689.46,-405.21 699.95,-403.67 690.79,-398.33 689.46,-405.21"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~global_coordinator~~CallsGraph_edge41" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#ff6d00" d="M475.36,-319.26C504.59,-283.67 591.06,-180.57 629,-159.37 655.79,-144.4 690.27,-138.03 715.9,-135.33"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="716.3,-138.81 725.94,-134.41 715.67,-131.84 716.3,-138.81"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge42" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#ff6d00" d="M474.93,-319.17C497.74,-290.75 559.16,-220.42 629,-192.37 715.93,-157.45 1388.03,-139.96 1553.02,-136.17"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1553.22,-139.66 1563.14,-135.94 1553.06,-132.67 1553.22,-139.66"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~global_coordinator~~CallsGraph_node39" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node39"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="870.5,-225.37 635.5,-225.37 635.5,-201.37 870.5,-201.37 870.5,-225.37"/>
<text text-anchor="middle" x="753" y="-210.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~global_coordinator~~CallsGraph_edge39" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#ff6d00" d="M482.77,-319.29C511.69,-299.62 572.31,-260.74 629,-239.37 641.12,-234.8 654.24,-230.95 667.24,-227.74"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="668.2,-231.1 677.13,-225.4 666.6,-224.29 668.2,-231.1"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~global_coordinator~~CallsGraph_node40" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node40"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="877,-343.37 629,-343.37 629,-319.37 877,-319.37 877,-343.37"/>
<text text-anchor="middle" x="753" y="-328.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~global_coordinator~~CallsGraph_edge40" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#ff6d00" d="M535.59,-331.37C560.7,-331.37 589.92,-331.37 618.61,-331.37"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="618.73,-334.87 628.73,-331.37 618.73,-327.87 618.73,-334.87"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge43" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#ffda00" d="M525.17,-711.22C547.48,-713.92 572.39,-719.43 593,-730.37 613.55,-741.27 607.63,-759.18 629,-768.37 730.25,-811.92 767.44,-780.4 877,-768.37 893.29,-766.58 896.71,-762.16 913,-760.37 1144.94,-734.91 1205.22,-744.31 1438,-760.37 1477.57,-763.1 1522.55,-769.79 1553.15,-774.9"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1552.9,-778.4 1563.34,-776.63 1554.07,-771.5 1552.9,-778.4"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_node38" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node38"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="872,-839.37 634,-839.37 634,-815.37 872,-815.37 872,-839.37"/>
<text text-anchor="middle" x="753" y="-824.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge44" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#ffda00" d="M525.12,-708.01C548.19,-710.19 573.64,-716.18 593,-730.37 621.54,-751.28 600.94,-779.82 629,-801.37 633.82,-805.07 639.05,-808.28 644.55,-811.05"/>
<polygon fill="#ffda00" stroke="#ffda00" points="643.46,-814.4 654.01,-815.32 646.33,-808.02 643.46,-814.4"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_node43" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node43"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="818,-919.37 688,-919.37 688,-895.37 818,-895.37 818,-919.37"/>
<text text-anchor="middle" x="753" y="-904.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge45" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#ffda00" d="M525.14,-706.26C548.75,-708.07 574.6,-714.27 593,-730.37 634.26,-766.48 593.27,-806.78 629,-848.37 646.5,-868.74 672.62,-882.64 696.3,-891.8"/>
<polygon fill="#ffda00" stroke="#ffda00" points="695.33,-895.17 705.92,-895.32 697.74,-888.6 695.33,-895.17"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge48" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#b6ff00" d="M510.32,-885.38C537.16,-894.51 570.35,-909.48 593,-932.37 620.42,-960.08 601.77,-984.47 629,-1012.37 648.49,-1032.35 676.11,-1046.43 700.23,-1055.82"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="699.04,-1059.11 709.63,-1059.31 701.48,-1052.55 699.04,-1059.11"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge46" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#b6ff00" d="M534.12,-862.35C574.05,-855.94 624.7,-847.81 667.12,-841"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="667.83,-844.43 677.15,-839.39 666.72,-837.52 667.83,-844.43"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge47" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#b6ff00" d="M534.12,-881.51C577.43,-886.65 633.37,-893.29 677.72,-898.55"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="677.52,-902.06 687.86,-899.76 678.34,-895.1 677.52,-902.06"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge51" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#48ff00" d="M532.17,-830.49C553.34,-833.15 575.71,-839.34 593,-852.37 622.85,-874.86 599.22,-905.79 629,-928.37 634.1,-932.24 639.66,-935.49 645.5,-938.22"/>
<polygon fill="#48ff00" stroke="#48ff00" points="644.32,-941.52 654.9,-942.09 646.99,-935.04 644.32,-941.52"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge49" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#48ff00" d="M532.31,-830.44C559.61,-830.06 592.16,-829.6 623.72,-829.16"/>
<polygon fill="#48ff00" stroke="#48ff00" points="623.98,-832.66 633.93,-829.02 623.88,-825.66 623.98,-832.66"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge50" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#48ff00" d="M532.24,-835.81C552.4,-838.86 574.16,-843.94 593,-852.37 611.75,-860.76 610.44,-872.56 629,-881.37 644.1,-888.54 661.18,-893.75 677.7,-897.52"/>
<polygon fill="#48ff00" stroke="#48ff00" points="677.38,-901.03 687.89,-899.7 678.84,-894.19 677.38,-901.03"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~global_coordinator~~CallsGraph_node45" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node45"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828.5,-1003.37 677.5,-1003.37 677.5,-979.37 828.5,-979.37 828.5,-1003.37"/>
<text text-anchor="middle" x="753" y="-988.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~global_coordinator~~CallsGraph_edge52" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#00ff24" d="M532.67,-962.28C572.86,-967.61 624.31,-974.43 667.28,-980.13"/>
<polygon fill="#00ff24" stroke="#00ff24" points="667.07,-983.64 677.44,-981.48 667.99,-976.7 667.07,-983.64"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge54" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#00ffff" d="M853.06,-1060.6C861.81,-1056.75 869.99,-1051.77 877,-1045.37 917.17,-1008.67 872.46,-964.65 913,-928.37 933.03,-910.45 963.46,-905.72 987.32,-905.19"/>
<polygon fill="#00ffff" stroke="#00ffff" points="987.42,-908.69 997.43,-905.2 987.43,-901.69 987.42,-908.69"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge55" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#00ffff" d="M842.32,-1059.36C854.39,-1055.83 866.3,-1051.27 877,-1045.37 897.09,-1034.3 892.69,-1019.04 913,-1008.37 1001.99,-961.59 1061.4,-1037.77 1136,-970.37 1180.49,-930.18 1126.95,-879.92 1172,-840.37 1281.63,-744.11 1473.61,-761.97 1553.27,-774.61"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1552.86,-778.09 1563.3,-776.26 1554,-771.18 1552.86,-778.09"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~global_coordinator~~CallsGraph_edge53" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#00ffff" d="M851.95,-1059.28C860.92,-1055.69 869.45,-1051.13 877,-1045.37 904.81,-1024.14 885.44,-996.91 913,-975.37 929.8,-962.24 952.15,-955.56 972.34,-952.23"/>
<polygon fill="#00ffff" stroke="#00ffff" points="972.95,-955.68 982.36,-950.81 971.97,-948.75 972.95,-955.68"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_node34" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node34"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="1107.5,-1041.37 941.5,-1041.37 941.5,-1017.37 1107.5,-1017.37 1107.5,-1041.37"/>
<text text-anchor="middle" x="1024.5" y="-1026.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_edge56" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#00ffff" d="M831.23,-1059.33C864.07,-1054.22 902.53,-1048.22 936.38,-1042.95"/>
<polygon fill="#00ffff" stroke="#00ffff" points="936.92,-1046.41 946.26,-1041.41 935.84,-1039.49 936.92,-1046.41"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~global_coordinator~~CallsGraph_node35" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node35"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1105,-1163.37 944,-1163.37 944,-1139.37 1105,-1139.37 1105,-1163.37"/>
<text text-anchor="middle" x="1024.5" y="-1148.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~global_coordinator~~CallsGraph_edge57" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#00ffff" d="M786.6,-1083.47C818.53,-1095.08 868.72,-1112.67 913,-1125.37 927.31,-1129.47 942.81,-1133.42 957.53,-1136.95"/>
<polygon fill="#00ffff" stroke="#00ffff" points="957.05,-1140.43 967.58,-1139.31 958.65,-1133.61 957.05,-1140.43"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_node36" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node36"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1374.5,-1167.37 1235.5,-1167.37 1235.5,-1143.37 1374.5,-1143.37 1374.5,-1167.37"/>
<text text-anchor="middle" x="1305" y="-1152.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge58" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00ffff" d="M832.8,-1083.4C937.29,-1099.36 1120.64,-1127.37 1225.15,-1143.33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1224.91,-1146.83 1235.33,-1144.88 1225.97,-1139.91 1224.91,-1146.83"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node37" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node37"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1136,-1083.37 913,-1083.37 913,-1059.37 1136,-1059.37 1136,-1083.37"/>
<text text-anchor="middle" x="1024.5" y="-1068.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge59" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#00ffff" d="M853.2,-1071.37C869.24,-1071.37 885.99,-1071.37 902.47,-1071.37"/>
<polygon fill="#00ffff" stroke="#00ffff" points="902.69,-1074.87 912.69,-1071.37 902.69,-1067.87 902.69,-1074.87"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~global_coordinator~~CallsGraph_node46" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node46"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="1101.5,-1205.37 947.5,-1205.37 947.5,-1181.37 1101.5,-1181.37 1101.5,-1205.37"/>
<text text-anchor="middle" x="1024.5" y="-1190.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~global_coordinator~~CallsGraph_edge60" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#00ffff" d="M768.74,-1083.49C795.63,-1104.94 855.23,-1149.5 913,-1172.37 920.76,-1175.44 929.02,-1178.08 937.38,-1180.33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="936.68,-1183.76 947.23,-1182.8 938.38,-1176.97 936.68,-1183.76"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_edge61" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#0091ff" d="M838.89,-961.42C851.76,-963.94 864.81,-966.92 877,-970.37 916.46,-981.55 959.83,-999.81 989.06,-1013.06"/>
<polygon fill="#0091ff" stroke="#0091ff" points="987.86,-1016.35 998.41,-1017.34 990.78,-1009.99 987.86,-1016.35"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge62" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#0091ff" d="M851.22,-956.49C860.49,-959.89 869.29,-964.4 877,-970.37 907.84,-994.23 882.39,-1026.22 913,-1050.37 914.64,-1051.66 916.33,-1052.88 918.08,-1054.04"/>
<polygon fill="#0091ff" stroke="#0091ff" points="916.74,-1057.31 927.16,-1059.26 920.23,-1051.24 916.74,-1057.31"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node47" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node47"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1096.5,-877.37 952.5,-877.37 952.5,-853.37 1096.5,-853.37 1096.5,-877.37"/>
<text text-anchor="middle" x="1024.5" y="-862.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge63" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#0091ff" d="M851.24,-939.39C860.25,-936.52 868.99,-932.91 877,-928.37 898.39,-916.25 891.73,-898.69 913,-886.37 922.03,-881.14 932.1,-877.18 942.39,-874.19"/>
<polygon fill="#0091ff" stroke="#0091ff" points="943.5,-877.51 952.29,-871.6 941.73,-870.74 943.5,-877.51"/>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~global_coordinator~~CallsGraph_edge67" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#0024ff" d="M539.65,-662.63C595.87,-662.82 670.75,-663.09 714.92,-663.24"/>
<polygon fill="#0024ff" stroke="#0024ff" points="715.18,-666.74 725.19,-663.28 715.21,-659.74 715.18,-666.74"/>
</g>
<!-- header -->
<g id="proc~~global_coordinator~~CallsGraph_node32" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="780,-759.37 726,-759.37 726,-735.37 780,-735.37 780,-759.37"/>
<text text-anchor="middle" x="753" y="-744.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~global_coordinator~~CallsGraph_edge64" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#0024ff" d="M539.69,-669.61C557.9,-673.48 576.8,-679.38 593,-688.37 613.34,-699.66 608.48,-715.41 629,-726.37 655.87,-740.73 690.33,-745.65 715.94,-747.17"/>
<polygon fill="#0024ff" stroke="#0024ff" points="715.83,-750.67 725.98,-747.62 716.15,-743.67 715.83,-750.67"/>
</g>
<!-- level_name -->
<g id="proc~~global_coordinator~~CallsGraph_node33" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="790,-717.37 716,-717.37 716,-693.37 790,-693.37 790,-717.37"/>
<text text-anchor="middle" x="753" y="-702.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge65" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#0024ff" d="M539.65,-673.5C592.11,-681.37 660.81,-691.68 705.66,-698.41"/>
<polygon fill="#0024ff" stroke="#0024ff" points="705.27,-701.9 715.68,-699.92 706.31,-694.97 705.27,-701.9"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_node42" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node42"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="815,-633.37 691,-633.37 691,-609.37 815,-609.37 815,-633.37"/>
<text text-anchor="middle" x="753" y="-618.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge66" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#0024ff" d="M539.65,-651.76C583.09,-645.54 637.68,-637.73 680.63,-631.58"/>
<polygon fill="#0024ff" stroke="#0024ff" points="681.32,-635.02 690.72,-630.14 680.33,-628.09 681.32,-635.02"/>
</g>
<!-- warning -->
<g id="proc~~global_coordinator~~CallsGraph_node48" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="780.5,-591.37 725.5,-591.37 725.5,-567.37 780.5,-567.37 780.5,-591.37"/>
<text text-anchor="middle" x="753" y="-576.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge68" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#0024ff" d="M492.45,-650.3C524.43,-636.41 579.64,-613.81 629,-600.37 657.53,-592.6 690.61,-587.15 715.27,-583.75"/>
<polygon fill="#0024ff" stroke="#0024ff" points="715.83,-587.2 725.28,-582.42 714.91,-580.27 715.83,-587.2"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge69" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#4800ff" d="M553.18,-580.73C568.11,-576.95 582.24,-570.34 593,-559.37 671.29,-479.53 544.47,-383.56 629,-310.37 712.33,-238.22 771.45,-278.63 877,-310.37 1190.02,-404.48 1492.24,-685.73 1570.19,-762.07"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1567.83,-764.67 1577.41,-769.19 1572.75,-759.68 1567.83,-764.67"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge70" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#4800ff" d="M553.05,-577.89C567.47,-574.27 581.45,-568.46 593,-559.37 625.24,-534 596.83,-499.83 629,-474.37 653.37,-455.08 689.05,-450.81 715.71,-450.79"/>
<polygon fill="#4800ff" stroke="#4800ff" points="715.74,-454.29 725.81,-450.98 715.88,-447.3 715.74,-454.29"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~global_coordinator~~CallsGraph_node41" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node41"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="798.5,-549.37 707.5,-549.37 707.5,-525.37 798.5,-525.37 798.5,-549.37"/>
<text text-anchor="middle" x="753" y="-534.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~global_coordinator~~CallsGraph_edge71" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#4800ff" d="M545.69,-568.33C594.12,-561.07 654.56,-551.99 697.47,-545.55"/>
<polygon fill="#4800ff" stroke="#4800ff" points="698.07,-549 707.44,-544.06 697.03,-542.08 698.07,-549"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge72" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#4800ff" d="M549.52,-592.39C591.14,-598.35 640.85,-605.46 680.61,-611.15"/>
<polygon fill="#4800ff" stroke="#4800ff" points="680.35,-614.65 690.75,-612.6 681.35,-607.72 680.35,-614.65"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~global_coordinator~~CallsGraph_node44" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node44"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-507.37 678.5,-507.37 678.5,-483.37 827.5,-483.37 827.5,-507.37"/>
<text text-anchor="middle" x="753" y="-492.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~global_coordinator~~CallsGraph_edge73" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#4800ff" d="M553.04,-574.42C566.99,-571.13 580.82,-566.32 593,-559.37 614.65,-547.02 607.39,-528.79 629,-516.37 640.94,-509.51 654.54,-504.76 668.23,-501.5"/>
<polygon fill="#4800ff" stroke="#4800ff" points="669.14,-504.88 678.19,-499.38 667.68,-498.04 669.14,-504.88"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge74" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#4800ff" d="M553.02,-580.06C607.51,-579.87 674.76,-579.64 715.46,-579.5"/>
<polygon fill="#4800ff" stroke="#4800ff" points="715.48,-583 725.46,-579.46 715.45,-576 715.48,-583"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge75" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#b600ff" d="M551.08,-528.45C565.62,-524.68 580.16,-519.5 593,-512.37 613.34,-501.08 608.48,-485.33 629,-474.37 655.87,-460.01 690.33,-455.09 715.94,-453.57"/>
<polygon fill="#b600ff" stroke="#b600ff" points="716.15,-457.07 725.98,-453.12 715.83,-450.07 716.15,-457.07"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge76" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#ff00da" d="M535.59,-428.44C592.48,-435 670.43,-443.97 715.59,-449.18"/>
<polygon fill="#ff00da" stroke="#ff00da" points="715.45,-452.68 725.78,-450.35 716.25,-445.73 715.45,-452.68"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge77" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#ff00da" d="M502.49,-408.36C530.55,-397.59 568.37,-379.31 593,-352.37 620.69,-322.09 595.55,-291.13 629,-267.37 675.02,-234.68 1080.1,-242.25 1136,-234.37 1293,-212.25 1476.54,-165.66 1553.09,-145.27"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1554.42,-148.54 1563.17,-142.57 1552.61,-141.78 1554.42,-148.54"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge83" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#ffb300" d="M1107.69,-1035.53C1117.93,-1038.92 1127.7,-1043.7 1136,-1050.37 1167.66,-1075.81 1139.96,-1109.41 1172,-1134.37 1187.2,-1146.21 1206.42,-1152.58 1225.46,-1155.78"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1224.99,-1159.25 1235.38,-1157.18 1225.97,-1152.32 1224.99,-1159.25"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_node50" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node50"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1364,-873.37 1246,-873.37 1246,-849.37 1364,-849.37 1364,-873.37"/>
<text text-anchor="middle" x="1305" y="-858.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_edge78" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#ffb300" d="M1107.75,-1020.43C1118.17,-1016.45 1127.97,-1010.94 1136,-1003.37 1176.81,-964.86 1129.81,-919.35 1172,-882.37 1189.33,-867.18 1213.07,-860.62 1235.65,-858.27"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1236.21,-861.74 1245.91,-857.47 1235.67,-854.76 1236.21,-861.74"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~global_coordinator~~CallsGraph_node53" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node53"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1389.5,-1083.37 1220.5,-1083.37 1220.5,-1059.37 1389.5,-1059.37 1389.5,-1083.37"/>
<text text-anchor="middle" x="1305" y="-1068.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~global_coordinator~~CallsGraph_edge79" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#ffb300" d="M1105.31,-1041.41C1139.25,-1046.52 1178.99,-1052.52 1213.97,-1057.79"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1213.77,-1061.3 1224.18,-1059.33 1214.82,-1054.38 1213.77,-1061.3"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~global_coordinator~~CallsGraph_node54" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node54"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1373.5,-1041.37 1236.5,-1041.37 1236.5,-1017.37 1373.5,-1017.37 1373.5,-1041.37"/>
<text text-anchor="middle" x="1305" y="-1026.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~global_coordinator~~CallsGraph_edge80" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#ffb300" d="M1107.55,-1029.37C1144.95,-1029.37 1189.01,-1029.37 1225.92,-1029.37"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1226.13,-1032.87 1236.13,-1029.37 1226.13,-1025.87 1226.13,-1032.87"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_node55" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node55"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1369,-999.37 1241,-999.37 1241,-975.37 1369,-975.37 1369,-999.37"/>
<text text-anchor="middle" x="1305" y="-984.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_edge81" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#ffb300" d="M1105.31,-1017.33C1144.85,-1011.37 1192.27,-1004.22 1230.86,-998.4"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1231.62,-1001.83 1240.98,-996.87 1230.57,-994.9 1231.62,-1001.83"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~global_coordinator~~CallsGraph_node56" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node56"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1382,-957.37 1228,-957.37 1228,-933.37 1382,-933.37 1382,-957.37"/>
<text text-anchor="middle" x="1305" y="-942.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~global_coordinator~~CallsGraph_edge82" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#ffb300" d="M1102.25,-1017.32C1113.98,-1013.79 1125.62,-1009.24 1136,-1003.37 1155.97,-992.07 1151.63,-976.93 1172,-966.37 1185.94,-959.14 1201.74,-954.26 1217.43,-951.01"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1218.52,-954.36 1227.71,-949.09 1217.24,-947.48 1218.52,-954.36"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~global_coordinator~~CallsGraph_node57" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node57"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1438,-915.37 1172,-915.37 1172,-891.37 1438,-891.37 1438,-915.37"/>
<text text-anchor="middle" x="1305" y="-900.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~global_coordinator~~CallsGraph_edge84" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#ffb300" d="M1107.68,-1019.07C1117.92,-1015.27 1127.7,-1010.18 1136,-1003.37 1165.83,-978.89 1141.29,-947.74 1172,-924.37 1173.84,-922.97 1175.73,-921.65 1177.68,-920.4"/>
<polygon fill="#ffb300" stroke="#ffb300" points="1179.53,-923.37 1186.49,-915.38 1176.07,-917.29 1179.53,-923.37"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge85" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#f0ff00" d="M1105.31,-1152.52C1142.77,-1153.05 1187.3,-1153.69 1224.7,-1154.23"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="1225,-1157.74 1235.05,-1154.38 1225.1,-1150.74 1225,-1157.74"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node52" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node52"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1419.5,-1125.37 1190.5,-1125.37 1190.5,-1101.37 1419.5,-1101.37 1419.5,-1125.37"/>
<text text-anchor="middle" x="1305" y="-1110.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge86" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#3cff00" d="M1105.31,-1083.41C1139.25,-1088.52 1178.99,-1094.52 1213.97,-1099.79"/>
<polygon fill="#3cff00" stroke="#3cff00" points="1213.77,-1103.3 1224.18,-1101.33 1214.82,-1096.38 1213.77,-1103.3"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_node49" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="1064,-528.37 985,-528.37 985,-504.37 1064,-504.37 1064,-528.37"/>
<text text-anchor="middle" x="1024.5" y="-513.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_edge87" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ff1e" d="M793.29,-815.35C819.37,-805.85 853.08,-790.47 877,-768.37 950.96,-700.06 998.45,-585.72 1015.94,-538.16"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1019.3,-539.15 1019.39,-528.56 1012.71,-536.78 1019.3,-539.15"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~global_coordinator~~CallsGraph_node51" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node51"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1088.5,-835.37 960.5,-835.37 960.5,-811.37 1088.5,-811.37 1088.5,-835.37"/>
<text text-anchor="middle" x="1024.5" y="-820.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~global_coordinator~~CallsGraph_edge88" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#00ff1e" d="M872.21,-825.62C898.69,-825.22 926.04,-824.82 950.08,-824.46"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="950.22,-827.96 960.16,-824.31 950.11,-820.96 950.22,-827.96"/>
</g>
<!-- sort -->
<g id="proc~~global_coordinator~~CallsGraph_node59" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="1051.5,-793.37 997.5,-793.37 997.5,-769.37 1051.5,-769.37 1051.5,-793.37"/>
<text text-anchor="middle" x="1024.5" y="-778.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~global_coordinator~~CallsGraph_edge89" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#00ff1e" d="M824.46,-815.34C876.79,-806.41 946.02,-794.59 987.52,-787.51"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="988.18,-790.95 997.45,-785.82 987,-784.05 988.18,-790.95"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~global_coordinator~~CallsGraph_node58" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node58"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1083.5,-225.37 965.5,-225.37 965.5,-201.37 1083.5,-201.37 1083.5,-225.37"/>
<text text-anchor="middle" x="1024.5" y="-210.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~global_coordinator~~CallsGraph_edge90" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#00ff78" d="M870.64,-213.37C899.4,-213.37 929.27,-213.37 954.9,-213.37"/>
<polygon fill="#00ff78" stroke="#00ff78" points="955.24,-216.87 965.24,-213.37 955.24,-209.87 955.24,-216.87"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_edge91" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ffd1" d="M843.43,-343.4C855.15,-346.93 866.66,-351.49 877,-357.37 937.83,-391.98 987.77,-460.53 1010.41,-495.21"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="1007.72,-497.5 1016.06,-504.04 1013.62,-493.73 1007.72,-497.5"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~global_coordinator~~CallsGraph_edge92" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#00ffd1" d="M857.86,-343.44C864.89,-347.13 871.4,-351.71 877,-357.37 934.37,-415.37 888.01,-459.71 913,-537.37 940.56,-623.02 989.58,-718.59 1011.88,-760.15"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="1008.87,-761.94 1016.7,-769.07 1015.03,-758.61 1008.87,-761.94"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node60" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node60"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1707,-1125.37 1474,-1125.37 1474,-1101.37 1707,-1101.37 1707,-1125.37"/>
<text text-anchor="middle" x="1590.5" y="-1110.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge93" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#5cff00" d="M1419.68,-1113.37C1434.2,-1113.37 1449.12,-1113.37 1463.82,-1113.37"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1463.95,-1116.87 1473.95,-1113.37 1463.95,-1109.87 1463.95,-1116.87"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~global_coordinator~~CallsGraph_node63" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node63"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1630,-1083.37 1551,-1083.37 1551,-1059.37 1630,-1059.37 1630,-1083.37"/>
<text text-anchor="middle" x="1590.5" y="-1068.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~global_coordinator~~CallsGraph_edge94" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff2e" d="M1389.53,-1071.37C1438.76,-1071.37 1499.34,-1071.37 1540.84,-1071.37"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1540.96,-1074.87 1550.96,-1071.37 1540.96,-1067.87 1540.96,-1074.87"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge95" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ffb9" d="M1373.58,-1029.19C1395.51,-1026.47 1419.05,-1020.52 1438,-1008.37 1458.56,-995.19 1544.23,-856.07 1576.83,-802.36"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1579.92,-804.02 1582.1,-793.66 1573.93,-800.4 1579.92,-804.02"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge98" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ffb9" d="M1373.79,-1034.01C1397.05,-1031.98 1421.38,-1025.22 1438,-1008.37 1477.11,-968.72 1464.94,-815.32 1474,-760.37 1513.01,-523.81 1569.01,-238.57 1585.05,-157.7"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1588.53,-158.16 1587.04,-147.67 1581.66,-156.8 1588.53,-158.16"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_node61" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node61"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1672,-999.37 1509,-999.37 1509,-975.37 1672,-975.37 1672,-999.37"/>
<text text-anchor="middle" x="1590.5" y="-984.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_edge96" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ffb9" d="M1373.55,-1019.36C1411.07,-1013.8 1458.25,-1006.81 1498.94,-1000.79"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1499.48,-1004.24 1508.86,-999.32 1498.45,-997.32 1499.48,-1004.24"/>
</g>
<!-- proc~error_set -->
<g id="proc~~global_coordinator~~CallsGraph_node62" class="node">
<title>proc~error_set</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node62"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1643,-1041.37 1538,-1041.37 1538,-1017.37 1643,-1017.37 1643,-1041.37"/>
<text text-anchor="middle" x="1590.5" y="-1026.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~global_coordinator~~CallsGraph_edge97" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ffb9" d="M1373.55,-1029.37C1420.44,-1029.37 1482.43,-1029.37 1527.96,-1029.37"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1527.99,-1032.87 1537.99,-1029.37 1527.99,-1025.87 1527.99,-1032.87"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocglobal_coordinatorCallsGraph = svgPanZoom('#procglobal_coordinatorCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~global_coordinator~~CalledByGraph Pages: 1 -->
<svg id="procglobal_coordinatorCalledByGraph" width="641pt" height="79pt"
 viewBox="0.00 0.00 641.00 78.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~global_coordinator~~CalledByGraph" class="graph" transform="scale(0.7 0.7) rotate(0) translate(4 108)">
<title>proc~~global_coordinator~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-108 908,-108 908,4 -4,4"/>
<!-- proc~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_node1" class="node">
<title>proc~global_coordinator</title>
<polygon fill="none" stroke="black" points="904,-64 791,-64 791,-40 904,-40 904,-64"/>
<text text-anchor="middle" x="847.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50">global_coordinator</text>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_node2" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node2"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="755,-64 642,-64 642,-40 755,-40 755,-64"/>
<text text-anchor="middle" x="698.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_edge1" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.07,-52C763.49,-52 772.24,-52 780.84,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="780.85,-55.5 790.85,-52 780.85,-48.5 780.85,-55.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_node3" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node3"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-64 443,-64 443,-40 606,-40 606,-64"/>
<text text-anchor="middle" x="524.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_edge2" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M606.21,-52C614.78,-52 623.41,-52 631.77,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="631.81,-55.5 641.81,-52 631.81,-48.5 631.81,-55.5"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_node4" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node4"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="407,-64 313,-64 313,-40 407,-40 407,-64"/>
<text text-anchor="middle" x="360" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge3" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M407.13,-52C415.24,-52 423.94,-52 432.78,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="432.8,-55.5 442.8,-52 432.8,-48.5 432.8,-55.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~global_coordinator~~CalledByGraph_node5" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node5"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="266.5,-104 100.5,-104 100.5,-80 266.5,-80 266.5,-104"/>
<text text-anchor="middle" x="183.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge4" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M236.86,-80C257.74,-75.21 281.82,-69.69 303.05,-64.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.94,-68.21 312.9,-62.57 302.37,-61.39 303.94,-68.21"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~global_coordinator~~CalledByGraph_node6" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node6"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="277,-24 90,-24 90,0 277,0 277,-24"/>
<text text-anchor="middle" x="183.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge5" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M236.86,-24C257.74,-28.79 281.82,-34.31 303.05,-39.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.37,-42.61 312.9,-41.43 303.94,-35.79 302.37,-42.61"/>
</g>
<!-- program~main -->
<g id="proc~~global_coordinator~~CalledByGraph_node7" class="node">
<title>program~main</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node7"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-44 0,-44 0,-20 54,-20 54,-44"/>
<text text-anchor="middle" x="27" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge6" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M54.25,-33.59C107.66,-36.81 230.05,-44.21 302.43,-48.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.54,-52.09 312.73,-49.2 302.96,-45.11 302.54,-52.09"/>
</g>
<!-- program~main&#45;&gt;proc~run_multi_molecule_calculations -->
<g id="proc~~global_coordinator~~CalledByGraph_edge7" class="edge">
<title>program~main&#45;&gt;proc~run_multi_molecule_calculations</title>
<path fill="none" stroke="#00ff00" d="M54.21,-28.61C61.81,-27.62 70.61,-26.48 79.96,-25.27"/>
<polygon fill="#00ff00" stroke="#00ff00" points="80.42,-28.74 89.89,-23.99 79.52,-21.8 80.42,-28.74"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocglobal_coordinatorCalledByGraph = svgPanZoom('#procglobal_coordinatorCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-calc_type_local~3"></span>
              integer(kind=int32),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>calc_type_local</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-coord_timer~4"></span>
              type(timer_type),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>coord_timer</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_fragment"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_fragment</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dummy_msg~4"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dummy_msg</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-finished_nodes~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>finished_nodes</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_idx~7"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_idx</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-handling_local_workers~2"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>handling_local_workers</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-has_pending~3"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>has_pending</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_dummy~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_dummy</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_finished_workers~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_finished_workers</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_status~2"></span>
              type(MPI_Status),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-req~8"></span>
              type(request_t),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>req</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-request_source~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>request_source</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results~7"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results_received~2"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>results_received</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-status~6"></span>
              type(MPI_Status),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-worker_fragment_map"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>worker_fragment_map</strong>(node_comm%size())</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-worker_source~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>worker_source</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">module subroutine </span><span class="n">global_coordinator</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                        </span><span class="n">node_leader_ranks</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">calc_type</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Global coordinator for distributing fragments to node coordinators</span>
<span class="w">      </span><span class="c">!! will act as a node coordinator for a single node calculation</span>
<span class="w">      </span><span class="c">!! Uses int64 for total_fragments to handle large fragment counts that overflow int32.</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_fragments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">node_leader_ranks</span><span class="p">(:)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">calc_type</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span>

<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">timer_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coord_timer</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">results_received</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">finished_nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">request_source</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_msg</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_idx</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">MPI_Status</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">handling_local_workers</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">has_pending</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">calc_type_local</span>

<span class="w">      </span><span class="c">! For local workers</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="p">,</span><span class="w"> </span><span class="n">local_dummy</span>

<span class="w">      </span><span class="c">! Storage for results</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">())</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">worker_source</span>

<span class="w">      </span><span class="c">! MPI request handles for non-blocking operations</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">request_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">req</span>

<span class="w">      </span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_type</span>

<span class="w">      </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_fragments</span>
<span class="w">      </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">handling_local_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0_int64</span>

<span class="w">      </span><span class="c">! Allocate storage for results</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">))</span>
<span class="w">      </span><span class="n">worker_fragment_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator starting with &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="s2">&quot; fragments for &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; nodes&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="n">start</span><span class="p">()</span>
<span class="w">      </span><span class="k">do while</span><span class="w"> </span><span class="p">(</span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">)</span>

<span class="w">         </span><span class="c">! PRIORITY 1: Check for incoming results from local workers</span>
<span class="w">         </span><span class="c">! This MUST be checked before sending new work to avoid race conditions</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! Keep checking for results until there are none pending</span>
<span class="w">            </span><span class="k">do</span>
<span class="k">               call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="k">               </span><span class="n">worker_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span>

<span class="w">               </span><span class="c">! Safety check: worker should have a fragment assigned</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received result from worker &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="s2">&quot; but no fragment was assigned!&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Invalid worker_fragment_map state&quot;</span>
<span class="w">               </span><span class="k">end if</span>

<span class="w">               </span><span class="c">! Receive result and store it using the fragment index for this worker</span>
<span class="w">               </span><span class="k">call </span><span class="n">result_irecv</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)),</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">worker_source</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">TAG_WORKER_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="c">! Clear the mapping since we&#39;ve received the result</span>
<span class="w">               </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">               </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">results_received</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">results_received</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Processed &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">results_received</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; fragments [&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s]&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! PRIORITY 1b: Check for incoming results from remote node coordinators</span>
<span class="w">         </span><span class="k">do</span>
<span class="k">            call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="w">            </span><span class="c">! Receive fragment index and result from node coordinator</span>
<span class="w">            </span><span class="c">! TODO: serialize the data for better performance</span>
<span class="w">            </span><span class="k">call </span><span class="n">irecv</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_idx</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">result_irecv</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">fragment_idx</span><span class="p">),</span><span class="w"> </span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">results_received</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">results_received</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Processed &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">results_received</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; fragments [&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s]&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>

<span class="w">         </span><span class="c">! PRIORITY 2: Remote node coordinator requests</span>
<span class="w">         </span><span class="k">call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">irecv</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_msg</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="n">request_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_fragment</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">send_fragment_to_node</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">request_source</span><span class="p">)</span>
<span class="w">               </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               call </span><span class="n">isend</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">request_source</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_FINISH</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! PRIORITY 3: Local workers (shared memory) - send new work</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! Only process work request if this worker doesn&#39;t have pending results</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">irecv</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">local_dummy</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">                  </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_fragment</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     call </span><span class="n">send_fragment_to_worker</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span>
<span class="w">                     </span><span class="c">! Track which fragment was sent to this worker</span>
<span class="w">                     </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span>
<span class="w">                     </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                     call </span><span class="n">isend</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_FINISH</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">                     </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">               end if</span>
<span class="w">               </span><span class="c">! If worker still has pending results, skip the work request</span>
<span class="w">               </span><span class="c">! It will be processed on the next iteration after results are received</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! Finalize local worker completion</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">handling_local_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Manually incremented finished_nodes for self&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator finished local workers&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">      end do</span>

<span class="k">      call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator finished all fragments&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="k">stop</span><span class="p">()</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time to evaluate all fragments &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">block</span>
<span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_energy</span>
<span class="w">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">         </span><span class="c">! Compute the many-body expansion</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing Many-Body Expansion (MBE)...&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="n">start</span><span class="p">()</span>

<span class="w">         </span><span class="c">! Use combined function if computing gradients or Hessians (more efficient)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CALC_TYPE_HESSIAN</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;sys_geom required for Hessian calculation in global_coordinator&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Missing sys_geom for Hessian calculation&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_hessian</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">)</span>
<span class="w">         </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CALC_TYPE_GRADIENT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;sys_geom required for gradient calculation in global_coordinator&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Missing sys_geom for gradient calculation&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="o">=</span><span class="n">bonds</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">)</span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">)</span>
<span class="w">         </span><span class="k">end if</span>

<span class="k">         call </span><span class="n">coord_timer</span><span class="p">%</span><span class="k">stop</span><span class="p">()</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time to compute MBE &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="k">end block</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="w">   </span><span class="k">end subroutine </span><span class="n">global_coordinator</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-07 09:12 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>