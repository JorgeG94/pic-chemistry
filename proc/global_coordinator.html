<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>global_coordinator &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>global_coordinator
      <small>Module Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.9% of total for procedures.">141 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe_mpi_fragment_distribution_scheme.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe_mpi_fragment_distribution_scheme.f90.html'>mqc_mbe_mpi_fragment_distribution_scheme.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe_fragment_distribution_scheme.html'>mqc_mbe_fragment_distribution_scheme</a></li>
            <li class="breadcrumb-item active" aria-current="page">global_coordinator</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-calc_type_local~3">calc_type_local</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-coord_timer~3">coord_timer</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-current_fragment">current_fragment</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-dummy_msg~2">dummy_msg</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-finished_nodes~2">finished_nodes</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-fragment_idx~6">fragment_idx</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-handling_local_workers~2">handling_local_workers</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-has_pending~2">has_pending</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_dummy~2">local_dummy</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_finished_workers~2">local_finished_workers</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_status~2">local_status</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-req~6">req</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-request_source~2">request_source</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-results~7">results</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-results_received~2">results_received</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-status~4">status</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-worker_fragment_map">worker_fragment_map</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-worker_source~2">worker_source</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/global_coordinator.html#src">global_coordinator</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>module subroutine global_coordinator(world_comm, node_comm, total_fragments, polymers, max_level, node_leader_ranks, num_nodes, sys_geom, calc_type, bonds)  
    <a href="../interface/global_coordinator.html"><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
</h2>
    

    <p>Global coordinator for distributing fragments to node coordinators
will act as a node coordinator for a single node calculation
Uses int64 for total_fragments to handle large fragment counts that overflow int32.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~13"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_comm~9"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_comm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_fragments~7"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_fragments</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~11"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~14"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_leader_ranks~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_leader_ranks</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-num_nodes~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>num_nodes</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~36"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-calc_type~14"></span>
              integer(kind=int32),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>calc_type</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~18"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~global_coordinator~~CallsGraph Pages: 1 -->
<svg id="procglobal_coordinatorCallsGraph" width="641pt" height="668pt"
 viewBox="0.00 0.00 641.00 667.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~global_coordinator~~CallsGraph" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 1782.61)">
<title>proc~~global_coordinator~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1782.61 1711,-1782.61 1711,4 -4,4"/>
<!-- proc~global_coordinator -->
<g id="proc~~global_coordinator~~CallsGraph_node1" class="node">
<title>proc~global_coordinator</title>
<polygon fill="none" stroke="black" points="113,-330 0,-330 0,-306 113,-306 113,-330"/>
<text text-anchor="middle" x="56.5" y="-315.6" font-family="Helvetica,sans-Serif" font-size="10.50">global_coordinator</text>
</g>
<!-- debug -->
<g id="proc~~global_coordinator~~CallsGraph_node2" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="1051.5,-1352 997.5,-1352 997.5,-1328 1051.5,-1328 1051.5,-1352"/>
<text text-anchor="middle" x="1024.5" y="-1337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~global_coordinator&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;debug</title>
<path fill="none" stroke="#ff0000" d="M57.3,-330.01C55.77,-430.49 48.85,-1132.22 149,-1312 199.66,-1402.93 239.11,-1414.97 336,-1453 448.08,-1497 765.48,-1528.4 877,-1483 938.08,-1458.13 987.58,-1394.19 1010.2,-1360.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1013.24,-1362.62 1015.85,-1352.35 1007.41,-1358.75 1013.24,-1362.62"/>
</g>
<!-- error -->
<g id="proc~~global_coordinator~~CallsGraph_node3" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1617.5,-578 1563.5,-578 1563.5,-554 1617.5,-554 1617.5,-578"/>
<text text-anchor="middle" x="1590.5" y="-563.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~global_coordinator&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge2" class="edge">
<title>proc~global_coordinator&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M113.02,-319.21C272.29,-322.88 728.81,-334.91 877,-355 1130.42,-389.35 1198.9,-392.25 1438,-483 1483.99,-500.46 1533.25,-529.62 1562.7,-548.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1560.87,-551.31 1571.18,-553.76 1564.65,-545.41 1560.87,-551.31"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_node4" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="806,-1474 700,-1474 700,-1450 806,-1450 806,-1474"/>
<text text-anchor="middle" x="753" y="-1459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~global_coordinator&#45;&gt;get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_edge3" class="edge">
<title>proc~global_coordinator&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#ff0000" d="M57.71,-330.07C59.48,-424.08 73.89,-1039.82 149,-1207 199.41,-1319.19 226.64,-1354.7 336,-1411 450.23,-1469.81 604.79,-1471.75 689.7,-1467.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="689.92,-1470.79 699.7,-1466.73 689.52,-1463.81 689.92,-1470.79"/>
</g>
<!-- info -->
<g id="proc~~global_coordinator~~CallsGraph_node5" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="780,-388 726,-388 726,-364 780,-364 780,-388"/>
<text text-anchor="middle" x="753" y="-373.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~global_coordinator&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge4" class="edge">
<title>proc~global_coordinator&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M83.28,-330.08C101.27,-337.88 126.07,-347.4 149,-352 360.19,-394.32 621.05,-384.15 715.61,-378.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="716.03,-381.98 725.79,-377.87 715.6,-374.99 716.03,-381.98"/>
</g>
<!-- iprobe -->
<g id="proc~~global_coordinator~~CallsGraph_node6" class="node">
<title>iprobe</title>
<polygon fill="#777777" stroke="#777777" points="251.5,-310 197.5,-310 197.5,-286 251.5,-286 251.5,-310"/>
<text text-anchor="middle" x="224.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iprobe</text>
</g>
<!-- proc~global_coordinator&#45;&gt;iprobe -->
<g id="proc~~global_coordinator~~CallsGraph_edge5" class="edge">
<title>proc~global_coordinator&#45;&gt;iprobe</title>
<path fill="none" stroke="#ff0000" d="M113.24,-311.28C137.68,-308.34 165.68,-304.97 187.34,-302.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="187.91,-305.81 197.42,-301.14 187.08,-298.86 187.91,-305.81"/>
</g>
<!-- irecv -->
<g id="proc~~global_coordinator~~CallsGraph_node7" class="node">
<title>irecv</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-270 437.5,-270 437.5,-246 491.5,-246 491.5,-270"/>
<text text-anchor="middle" x="464.5" y="-255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">irecv</text>
</g>
<!-- proc~global_coordinator&#45;&gt;irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge6" class="edge">
<title>proc~global_coordinator&#45;&gt;irecv</title>
<path fill="none" stroke="#ff0000" d="M78.53,-305.94C96.59,-296.23 123.64,-283.23 149,-277 247.27,-252.87 367.74,-253.69 427.01,-256"/>
<polygon fill="#ff0000" stroke="#ff0000" points="427.21,-259.52 437.35,-256.45 427.51,-252.52 427.21,-259.52"/>
</g>
<!-- isend -->
<g id="proc~~global_coordinator~~CallsGraph_node8" class="node">
<title>isend</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-148 437.5,-148 437.5,-124 491.5,-124 491.5,-148"/>
<text text-anchor="middle" x="464.5" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isend</text>
</g>
<!-- proc~global_coordinator&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge7" class="edge">
<title>proc~global_coordinator&#45;&gt;isend</title>
<path fill="none" stroke="#ff0000" d="M60.13,-305.84C67.62,-274.41 92.35,-190.5 149,-155 194.39,-126.55 354.43,-130.51 427.11,-133.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="427.01,-137.44 437.17,-134.44 427.36,-130.45 427.01,-137.44"/>
</g>
<!-- mbe_total_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node9" class="node">
<title>mbe_total_gradient</title>
<polygon fill="#777777" stroke="#777777" points="282.5,-66 166.5,-66 166.5,-42 282.5,-42 282.5,-66"/>
<text text-anchor="middle" x="224.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_total_gradient</text>
</g>
<!-- proc~global_coordinator&#45;&gt;mbe_total_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge8" class="edge">
<title>proc~global_coordinator&#45;&gt;mbe_total_gradient</title>
<path fill="none" stroke="#ff0000" d="M58.34,-305.79C61.74,-266.21 77.94,-140.24 149,-75 151.6,-72.61 154.46,-70.49 157.48,-68.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="159.18,-71.67 166.4,-63.92 155.92,-65.47 159.18,-71.67"/>
</g>
<!-- mbe_total_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node10" class="node">
<title>mbe_total_hessian</title>
<polygon fill="#777777" stroke="#777777" points="280.5,-24 168.5,-24 168.5,0 280.5,0 280.5,-24"/>
<text text-anchor="middle" x="224.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_total_hessian</text>
</g>
<!-- proc~global_coordinator&#45;&gt;mbe_total_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge9" class="edge">
<title>proc~global_coordinator&#45;&gt;mbe_total_hessian</title>
<path fill="none" stroke="#ff0000" d="M57.57,-305.93C58.49,-262.33 67.66,-111.47 149,-33 152.1,-30.01 155.59,-27.44 159.33,-25.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.04,-28.29 168.43,-20.7 157.92,-22.02 161.04,-28.29"/>
</g>
<!-- proc~compute_mbe -->
<g id="proc~~global_coordinator~~CallsGraph_node11" class="node">
<title>proc~compute_mbe</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node11"><a xlink:href="../proc/compute_mbe.html" xlink:title="compute_mbe">
<polygon fill="#d9534f" stroke="#d9534f" points="269,-882 180,-882 180,-858 269,-858 269,-882"/>
<text text-anchor="middle" x="224.5" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~global_coordinator~~CallsGraph_edge10" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M61.12,-330.04C82.19,-400.11 189.02,-755.34 216.86,-847.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.55,-849.07 219.78,-857.64 220.26,-847.06 213.55,-849.07"/>
</g>
<!-- proc~result_irecv -->
<g id="proc~~global_coordinator~~CallsGraph_node12" class="node">
<title>proc~result_irecv</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node12"><a xlink:href="../proc/result_irecv.html" xlink:title="result_irecv">
<polygon fill="#d9534f" stroke="#d9534f" points="261,-230 188,-230 188,-206 261,-206 261,-230"/>
<text text-anchor="middle" x="224.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">result_irecv</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~result_irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge11" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~result_irecv</title>
<path fill="none" stroke="#ff0000" d="M69.52,-305.96C86.12,-289.91 117.58,-261.49 149,-244 158.07,-238.95 168.29,-234.62 178.19,-231.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.62,-234.22 187.93,-227.65 177.34,-227.6 179.62,-234.22"/>
</g>
<!-- proc~send_fragment_to_node -->
<g id="proc~~global_coordinator~~CallsGraph_node13" class="node">
<title>proc~send_fragment_to_node</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node13"><a xlink:href="../proc/send_fragment_to_node.html" xlink:title="send_fragment_to_node">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-108 154,-108 154,-84 295,-84 295,-108"/>
<text text-anchor="middle" x="224.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_node</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_node -->
<g id="proc~~global_coordinator~~CallsGraph_edge12" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_node</title>
<path fill="none" stroke="#ff0000" d="M59.73,-305.93C66.63,-271.96 90.77,-174.63 149,-122 153.07,-118.33 157.68,-115.17 162.57,-112.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="164.18,-115.56 171.62,-108.02 161.1,-109.27 164.18,-115.56"/>
</g>
<!-- proc~send_fragment_to_worker -->
<g id="proc~~global_coordinator~~CallsGraph_node14" class="node">
<title>proc~send_fragment_to_worker</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node14"><a xlink:href="../proc/send_fragment_to_worker.html" xlink:title="send_fragment_to_worker">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-188 149,-188 149,-164 300,-164 300,-188"/>
<text text-anchor="middle" x="224.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_worker</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker -->
<g id="proc~~global_coordinator~~CallsGraph_edge13" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker</title>
<path fill="none" stroke="#ff0000" d="M63.2,-305.97C75.38,-281.57 106.37,-226.11 149,-197 151.53,-195.28 154.19,-193.69 156.95,-192.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.45,-195.4 166.04,-188.02 155.5,-189.05 158.45,-195.4"/>
</g>
<!-- start -->
<g id="proc~~global_coordinator~~CallsGraph_node15" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="780,-1432 726,-1432 726,-1408 780,-1408 780,-1432"/>
<text text-anchor="middle" x="753" y="-1417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~global_coordinator&#45;&gt;start -->
<g id="proc~~global_coordinator~~CallsGraph_edge14" class="edge">
<title>proc~global_coordinator&#45;&gt;start</title>
<path fill="none" stroke="#ff0000" d="M57.2,-330.01C55.82,-400.8 53.63,-770.04 149,-1049 201.79,-1203.42 199.85,-1275.03 336,-1365 456.16,-1444.41 638.83,-1433.97 715.8,-1425.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="716.44,-1428.54 725.94,-1423.86 715.59,-1421.6 716.44,-1428.54"/>
</g>
<!-- to_char -->
<g id="proc~~global_coordinator~~CallsGraph_node16" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1617.5,-1232 1563.5,-1232 1563.5,-1208 1617.5,-1208 1617.5,-1232"/>
<text text-anchor="middle" x="1590.5" y="-1217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~global_coordinator&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge15" class="edge">
<title>proc~global_coordinator&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M57.5,-330.1C57.68,-434.48 62.01,-1183.9 149,-1388 231.52,-1581.6 253.04,-1742 463.5,-1742 463.5,-1742 463.5,-1742 1025.5,-1742 1209.03,-1742 1293.26,-1835.83 1438,-1723 1517.5,-1661.03 1572.66,-1331.06 1586.24,-1242.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1589.73,-1242.46 1587.76,-1232.05 1582.81,-1241.42 1589.73,-1242.46"/>
</g>
<!-- verbose -->
<g id="proc~~global_coordinator~~CallsGraph_node17" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="780.5,-1112 725.5,-1112 725.5,-1088 780.5,-1088 780.5,-1112"/>
<text text-anchor="middle" x="753" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~global_coordinator&#45;&gt;verbose -->
<g id="proc~~global_coordinator~~CallsGraph_edge16" class="edge">
<title>proc~global_coordinator&#45;&gt;verbose</title>
<path fill="none" stroke="#ff0000" d="M57.76,-330.12C59.4,-391.76 71.07,-676.01 149,-891 204.35,-1043.71 194.79,-1124.74 336,-1205 435.3,-1261.44 497.64,-1267.88 593,-1205 626.91,-1182.64 597.1,-1146.14 629,-1121 653.26,-1101.88 688.65,-1097.54 715.24,-1097.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="715.27,-1100.96 725.32,-1097.62 715.38,-1093.96 715.27,-1100.96"/>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge19" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#009fff" d="M226.36,-857.82C230.14,-813.86 249.25,-662.06 336,-587 437.09,-499.53 496.27,-534.91 629,-519 986,-476.21 1082.7,-464.84 1438,-520 1478.63,-526.31 1523.51,-540.95 1553.79,-552.03"/>
<polygon fill="#009fff" stroke="#009fff" points="1552.89,-555.43 1563.48,-555.64 1555.33,-548.87 1552.89,-555.43"/>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#009fff" d="M226.79,-857.59C233.8,-792.64 269.5,-492.47 336,-433 350.16,-420.34 616.96,-390.52 715.68,-379.87"/>
<polygon fill="#009fff" stroke="#009fff" points="716.21,-383.33 725.78,-378.78 715.46,-376.37 716.21,-383.33"/>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge39" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#009fff" d="M231.52,-882.01C245.32,-909.97 279.63,-981.83 300,-1045 322.37,-1114.37 279.36,-1159.13 336,-1205 384.5,-1244.28 1352.58,-1225.21 1553.27,-1220.82"/>
<polygon fill="#009fff" stroke="#009fff" points="1553.38,-1224.32 1563.3,-1220.6 1553.22,-1217.32 1553.38,-1224.32"/>
</g>
<!-- cart_disp -->
<g id="proc~~global_coordinator~~CallsGraph_node18" class="node">
<title>cart_disp</title>
<polygon fill="#777777" stroke="#777777" points="495,-1196 434,-1196 434,-1172 495,-1172 495,-1196"/>
<text text-anchor="middle" x="464.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cart_disp</text>
</g>
<!-- proc~compute_mbe&#45;&gt;cart_disp -->
<g id="proc~~global_coordinator~~CallsGraph_edge17" class="edge">
<title>proc~compute_mbe&#45;&gt;cart_disp</title>
<path fill="none" stroke="#009fff" d="M226.01,-882.17C228.59,-927.49 244.14,-1087.69 336,-1163 360.31,-1182.93 396.2,-1187.33 423.71,-1187.24"/>
<polygon fill="#009fff" stroke="#009fff" points="423.89,-1190.73 433.8,-1187 423.72,-1183.74 423.89,-1190.73"/>
</g>
<!-- configuration -->
<g id="proc~~global_coordinator~~CallsGraph_node19" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="1066.5,-744 982.5,-744 982.5,-720 1066.5,-720 1066.5,-744"/>
<text text-anchor="middle" x="1024.5" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~global_coordinator~~CallsGraph_edge18" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#009fff" d="M227.63,-857.75C234.84,-820.46 262.17,-708.18 336,-664 434.01,-605.35 479.13,-655.06 593,-664 666.04,-669.73 874.91,-705.7 972.32,-722.88"/>
<polygon fill="#009fff" stroke="#009fff" points="971.78,-726.34 982.23,-724.63 973,-719.45 971.78,-726.34"/>
</g>
<!-- fc_mdyne -->
<g id="proc~~global_coordinator~~CallsGraph_node20" class="node">
<title>fc_mdyne</title>
<polygon fill="#777777" stroke="#777777" points="496.5,-1154 432.5,-1154 432.5,-1130 496.5,-1130 496.5,-1154"/>
<text text-anchor="middle" x="464.5" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fc_mdyne</text>
</g>
<!-- proc~compute_mbe&#45;&gt;fc_mdyne -->
<g id="proc~~global_coordinator~~CallsGraph_edge20" class="edge">
<title>proc~compute_mbe&#45;&gt;fc_mdyne</title>
<path fill="none" stroke="#009fff" d="M226.83,-882.14C232.04,-923.24 254.92,-1058.12 336,-1121 360.26,-1139.81 395.01,-1144.51 422.11,-1144.81"/>
<polygon fill="#009fff" stroke="#009fff" points="422.48,-1148.31 432.45,-1144.72 422.42,-1141.31 422.48,-1148.31"/>
</g>
<!-- force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_node21" class="node">
<title>force_constants</title>
<polygon fill="#777777" stroke="#777777" points="512.5,-1112 416.5,-1112 416.5,-1088 512.5,-1088 512.5,-1112"/>
<text text-anchor="middle" x="464.5" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">force_constants</text>
</g>
<!-- proc~compute_mbe&#45;&gt;force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_edge21" class="edge">
<title>proc~compute_mbe&#45;&gt;force_constants</title>
<path fill="none" stroke="#009fff" d="M227.97,-882.15C236.08,-918.72 265.54,-1028.29 336,-1079 356.06,-1093.44 382.48,-1099.34 406.06,-1101.38"/>
<polygon fill="#009fff" stroke="#009fff" points="406.11,-1104.89 416.31,-1102.04 406.56,-1097.9 406.11,-1104.89"/>
</g>
<!-- frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_node22" class="node">
<title>frequencies</title>
<polygon fill="#777777" stroke="#777777" points="502,-1028 427,-1028 427,-1004 502,-1004 502,-1028"/>
<text text-anchor="middle" x="464.5" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">frequencies</text>
</g>
<!-- proc~compute_mbe&#45;&gt;frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_edge22" class="edge">
<title>proc~compute_mbe&#45;&gt;frequencies</title>
<path fill="none" stroke="#009fff" d="M232.22,-882.07C247.16,-907.65 285.81,-967.25 336,-995 360.5,-1008.55 391.42,-1013.88 416.67,-1015.78"/>
<polygon fill="#009fff" stroke="#009fff" points="416.56,-1019.28 426.75,-1016.39 416.98,-1012.29 416.56,-1019.28"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~global_coordinator~~CallsGraph_node23" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node23"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="535.5,-1356 393.5,-1356 393.5,-1332 535.5,-1332 535.5,-1356"/>
<text text-anchor="middle" x="464.5" y="-1341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~global_coordinator~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#009fff" d="M226.7,-882.38C233.39,-948.59 268.16,-1260.13 336,-1323 348.86,-1334.92 365.75,-1341.52 383.02,-1344.93"/>
<polygon fill="#009fff" stroke="#009fff" points="382.76,-1348.44 393.2,-1346.59 383.89,-1341.53 382.76,-1348.44"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~global_coordinator~~CallsGraph_node24" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node24"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-738 404,-738 404,-714 525,-714 525,-738"/>
<text text-anchor="middle" x="464.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~global_coordinator~~CallsGraph_edge25" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#009fff" d="M232.5,-857.74C247.7,-832.36 286.4,-774.16 336,-747 353.51,-737.41 374.25,-731.95 393.86,-728.91"/>
<polygon fill="#009fff" stroke="#009fff" points="394.56,-732.35 403.99,-727.53 393.61,-725.41 394.56,-732.35"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node25" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node25"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="534,-822 395,-822 395,-798 534,-798 534,-822"/>
<text text-anchor="middle" x="464.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge26" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#009fff" d="M261.58,-857.93C283.05,-850.98 310.91,-842.4 336,-836 352.83,-831.7 371.06,-827.64 388.32,-824.06"/>
<polygon fill="#009fff" stroke="#009fff" points="389.26,-827.44 398.36,-822.01 387.86,-820.59 389.26,-827.44"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node26" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node26"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="532,-780 397,-780 397,-756 532,-756 532,-780"/>
<text text-anchor="middle" x="464.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge27" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#009fff" d="M237.86,-857.81C257.08,-839.64 296.09,-805.77 336,-789 351.91,-782.31 369.76,-777.75 386.96,-774.64"/>
<polygon fill="#009fff" stroke="#009fff" points="387.7,-778.06 396.99,-772.97 386.55,-771.16 387.7,-778.06"/>
</g>
<!-- proc~compute_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_node27" class="node">
<title>proc~compute_vibrational_analysis</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node27"><a xlink:href="../proc/compute_vibrational_analysis.html" xlink:title="compute_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="549.5,-1592 379.5,-1592 379.5,-1568 549.5,-1568 549.5,-1592"/>
<text text-anchor="middle" x="464.5" y="-1577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_edge28" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis</title>
<path fill="none" stroke="#009fff" d="M226.8,-882.29C233.09,-939.1 263.14,-1181.24 336,-1365 366.23,-1441.24 421.31,-1522.08 448.08,-1559.19"/>
<polygon fill="#009fff" stroke="#009fff" points="445.52,-1561.63 454.24,-1567.65 451.18,-1557.5 445.52,-1561.63"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~global_coordinator~~CallsGraph_node28" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node28"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="532.5,-1314 396.5,-1314 396.5,-1290 532.5,-1290 532.5,-1314"/>
<text text-anchor="middle" x="464.5" y="-1299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~global_coordinator~~CallsGraph_edge29" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#009fff" d="M225.8,-882.08C227.66,-932.01 240.97,-1124.86 336,-1238 355.21,-1260.87 384.62,-1276.4 410.35,-1286.42"/>
<polygon fill="#009fff" stroke="#009fff" points="409.41,-1289.81 420,-1290 411.84,-1283.24 409.41,-1289.81"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node29" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node29"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="593,-986 336,-986 336,-962 593,-962 593,-986"/>
<text text-anchor="middle" x="464.5" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge30" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#009fff" d="M237.48,-882.19C256.51,-900.75 295.62,-935.75 336,-953 341.35,-955.29 346.93,-957.33 352.63,-959.14"/>
<polygon fill="#009fff" stroke="#009fff" points="351.74,-962.53 362.33,-962 353.72,-955.82 351.74,-962.53"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node30" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node30"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="853,-944 653,-944 653,-920 853,-920 853,-944"/>
<text text-anchor="middle" x="753" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#009fff" d="M269.28,-864.55C338.66,-857.11 477.84,-847.02 593,-869 639.25,-877.83 689.22,-899.9 720.55,-915.41"/>
<polygon fill="#009fff" stroke="#009fff" points="719.14,-918.62 729.65,-920 722.29,-912.37 719.14,-918.62"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node31" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node31"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="851,-780 655,-780 655,-756 851,-756 851,-780"/>
<text text-anchor="middle" x="753" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge32" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#009fff" d="M229.18,-857.87C239.65,-825.75 273.04,-738.61 336,-705 436.76,-651.21 487.77,-660.57 593,-705 614.14,-713.93 608.91,-730.93 629,-742 636.86,-746.33 645.37,-749.94 654.12,-752.95"/>
<polygon fill="#009fff" stroke="#009fff" points="653.09,-756.3 663.68,-755.99 655.21,-749.63 653.09,-756.3"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_node32" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node32"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="539.5,-1070 389.5,-1070 389.5,-1046 539.5,-1046 539.5,-1070"/>
<text text-anchor="middle" x="464.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_edge33" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#009fff" d="M229.62,-882.17C240.97,-913.66 275.89,-998.07 336,-1037 348.9,-1045.35 364.02,-1050.74 379.26,-1054.15"/>
<polygon fill="#009fff" stroke="#009fff" points="378.77,-1057.62 389.26,-1056.12 380.12,-1050.75 378.77,-1057.62"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~global_coordinator~~CallsGraph_node33" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node33"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="553,-620 376,-620 376,-596 553,-596 553,-620"/>
<text text-anchor="middle" x="464.5" y="-605.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~global_coordinator~~CallsGraph_edge34" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#009fff" d="M227.3,-857.86C233.82,-818.57 259.94,-693.9 336,-634 344.92,-626.97 355.26,-621.7 366.11,-617.77"/>
<polygon fill="#009fff" stroke="#009fff" points="367.31,-621.06 375.75,-614.65 365.16,-614.4 367.31,-621.06"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_node34" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node34"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="551,-466 378,-466 378,-442 551,-442 551,-466"/>
<text text-anchor="middle" x="464.5" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_edge35" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#009fff" d="M227.17,-857.62C235.66,-796.61 275.94,-528.82 336,-475 345.23,-466.73 356.41,-461.05 368.27,-457.23"/>
<polygon fill="#009fff" stroke="#009fff" points="369.21,-460.6 377.91,-454.55 367.33,-453.86 369.21,-460.6"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~global_coordinator~~CallsGraph_node35" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node35"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="535.5,-944 393.5,-944 393.5,-920 535.5,-920 535.5,-944"/>
<text text-anchor="middle" x="464.5" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~global_coordinator~~CallsGraph_edge36" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#009fff" d="M253.63,-882.15C275.68,-891.25 307.32,-903.39 336,-911 351.03,-914.99 367.27,-918.35 382.96,-921.15"/>
<polygon fill="#009fff" stroke="#009fff" points="382.73,-924.66 393.17,-922.9 383.91,-917.76 382.73,-924.66"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_node36" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node36"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="538.5,-508 390.5,-508 390.5,-484 538.5,-484 538.5,-508"/>
<text text-anchor="middle" x="464.5" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_edge37" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#009fff" d="M225.29,-857.86C225.13,-807.82 231.58,-615.87 336,-522 348.31,-510.93 364.03,-504.07 380.18,-499.91"/>
<polygon fill="#009fff" stroke="#009fff" points="381.28,-503.25 390.27,-497.66 379.75,-496.42 381.28,-503.25"/>
</g>
<!-- reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_node38" class="node">
<title>reduced_masses</title>
<polygon fill="#777777" stroke="#777777" points="515,-902 414,-902 414,-878 515,-878 515,-902"/>
<text text-anchor="middle" x="464.5" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduced_masses</text>
</g>
<!-- proc~compute_mbe&#45;&gt;reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_edge38" class="edge">
<title>proc~compute_mbe&#45;&gt;reduced_masses</title>
<path fill="none" stroke="#009fff" d="M269.15,-873.67C306.97,-876.85 362.02,-881.47 403.89,-884.99"/>
<polygon fill="#009fff" stroke="#009fff" points="403.7,-888.49 413.96,-885.84 404.28,-881.51 403.7,-888.49"/>
</g>
<!-- proc~result_irecv&#45;&gt;irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge40" class="edge">
<title>proc~result_irecv&#45;&gt;irecv</title>
<path fill="none" stroke="#003fff" d="M261.32,-224.22C282.94,-227.97 311.05,-232.8 336,-237 366.72,-242.17 401.63,-247.91 427.14,-252.08"/>
<polygon fill="#003fff" stroke="#003fff" points="426.69,-255.55 437.12,-253.71 427.81,-248.64 426.69,-255.55"/>
</g>
<!-- recv -->
<g id="proc~~global_coordinator~~CallsGraph_node37" class="node">
<title>recv</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-228 437.5,-228 437.5,-204 491.5,-204 491.5,-228"/>
<text text-anchor="middle" x="464.5" y="-213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">recv</text>
</g>
<!-- proc~result_irecv&#45;&gt;recv -->
<g id="proc~~global_coordinator~~CallsGraph_edge41" class="edge">
<title>proc~result_irecv&#45;&gt;recv</title>
<path fill="none" stroke="#003fff" d="M261.13,-217.7C305.79,-217.33 381.93,-216.69 427,-216.31"/>
<polygon fill="#003fff" stroke="#003fff" points="427.23,-219.8 437.2,-216.22 427.17,-212.81 427.23,-219.8"/>
</g>
<!-- proc~send_fragment_to_node&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge42" class="edge">
<title>proc~send_fragment_to_node&#45;&gt;isend</title>
<path fill="none" stroke="#1f00ff" d="M295.3,-107.73C338.56,-115 392.34,-124.04 427.27,-129.91"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="427.03,-133.42 437.48,-131.63 428.19,-126.52 427.03,-133.42"/>
</g>
<!-- proc~send_fragment_to_worker&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge43" class="edge">
<title>proc~send_fragment_to_worker&#45;&gt;isend</title>
<path fill="none" stroke="#7f00ff" d="M296.91,-164C339.84,-156.78 392.67,-147.9 427.17,-142.11"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="427.98,-145.52 437.26,-140.41 426.82,-138.62 427.98,-145.52"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge44" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#91ff00" d="M535.61,-1343.5C655.55,-1342.64 896.02,-1340.91 987.26,-1340.26"/>
<polygon fill="#91ff00" stroke="#91ff00" points="987.41,-1343.76 997.38,-1340.19 987.36,-1336.76 987.41,-1343.76"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_edge45" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#91ff00" d="M481.2,-1356.03C509.24,-1376.86 570.45,-1419.48 629,-1441 648.13,-1448.03 669.82,-1452.73 689.6,-1455.87"/>
<polygon fill="#91ff00" stroke="#91ff00" points="689.34,-1459.36 699.74,-1457.36 690.36,-1452.44 689.34,-1459.36"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~global_coordinator~~CallsGraph_edge48" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#91ff00" d="M501.6,-1356.05C534.56,-1366.8 584.74,-1382.58 629,-1394 658.03,-1401.49 691.33,-1408.43 715.95,-1413.25"/>
<polygon fill="#91ff00" stroke="#91ff00" points="715.45,-1416.72 725.93,-1415.18 716.78,-1409.85 715.45,-1416.72"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge49" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#91ff00" d="M535.88,-1349.45C564.72,-1351.49 598.45,-1353.65 629,-1355 854.13,-1364.95 913.21,-1394.84 1136,-1361 1296.51,-1336.62 1478.41,-1266.33 1553.82,-1235.17"/>
<polygon fill="#91ff00" stroke="#91ff00" points="1555.44,-1238.29 1563.33,-1231.22 1552.75,-1231.83 1555.44,-1238.29"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~global_coordinator~~CallsGraph_node51" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node51"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="870.5,-1314 635.5,-1314 635.5,-1290 870.5,-1290 870.5,-1314"/>
<text text-anchor="middle" x="753" y="-1299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~global_coordinator~~CallsGraph_edge46" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#91ff00" d="M535.59,-1333.73C573,-1328.24 619.52,-1321.42 659.83,-1315.51"/>
<polygon fill="#91ff00" stroke="#91ff00" points="660.55,-1318.94 669.94,-1314.03 659.53,-1312.02 660.55,-1318.94"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~global_coordinator~~CallsGraph_node52" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node52"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="877,-1154 629,-1154 629,-1130 877,-1130 877,-1154"/>
<text text-anchor="middle" x="753" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~global_coordinator~~CallsGraph_edge47" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#91ff00" d="M535.76,-1344.81C555.95,-1341.95 576.84,-1335.66 593,-1323 624.97,-1297.95 604.29,-1271.24 629,-1239 654.71,-1205.45 694.55,-1176.88 721.87,-1159.62"/>
<polygon fill="#91ff00" stroke="#91ff00" points="723.96,-1162.44 730.62,-1154.2 720.28,-1156.49 723.96,-1162.44"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge50" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#48ff00" d="M515.64,-713.93C598.19,-694.27 768.03,-654.77 913,-627 1027.53,-605.06 1056,-597 1172,-585 1312.33,-570.48 1480.34,-567.05 1553.03,-566.25"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1553.08,-569.75 1563.04,-566.15 1553.01,-562.75 1553.08,-569.75"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_node50" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node50"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="872,-986 634,-986 634,-962 872,-962 872,-986"/>
<text text-anchor="middle" x="753" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge51" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#48ff00" d="M525.17,-721.74C549.22,-723.26 575.39,-729.56 593,-747 659.04,-812.4 563.15,-887.41 629,-953 629.95,-953.95 630.93,-954.86 631.93,-955.74"/>
<polygon fill="#48ff00" stroke="#48ff00" points="629.95,-958.63 640.03,-961.87 634.17,-953.05 629.95,-958.63"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_node55" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node55"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="818,-864 688,-864 688,-840 818,-840 818,-864"/>
<text text-anchor="middle" x="753" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge52" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#48ff00" d="M525.27,-723.99C548.49,-726.04 574.02,-732.13 593,-747 624.97,-772.05 597.1,-805.86 629,-831 642.8,-841.87 660.19,-847.97 677.52,-851.21"/>
<polygon fill="#48ff00" stroke="#48ff00" points="677.27,-854.72 687.69,-852.81 678.36,-847.8 677.27,-854.72"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge55" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#00ff00" d="M534.3,-816.32C554.1,-820.14 575.16,-826.25 593,-836 613.13,-847 610.37,-859.61 629,-873 653.87,-890.88 685.01,-905.75 709.73,-916.09"/>
<polygon fill="#00ff00" stroke="#00ff00" points="708.62,-919.42 719.2,-919.97 711.27,-912.94 708.62,-919.42"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge53" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff00" d="M511.08,-822.07C537.87,-831.17 570.73,-846.09 593,-869 621.31,-898.13 597.1,-927.86 629,-953 630.63,-954.28 632.3,-955.5 634.02,-956.65"/>
<polygon fill="#00ff00" stroke="#00ff00" points="632.57,-959.86 642.97,-961.9 636.12,-953.82 632.57,-959.86"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge54" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff00" d="M534.12,-820.06C577.43,-826.41 633.37,-834.61 677.72,-841.11"/>
<polygon fill="#00ff00" stroke="#00ff00" points="677.46,-844.61 687.86,-842.6 678.48,-837.68 677.46,-844.61"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge58" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#00ff48" d="M532.31,-768C565.78,-768 607.12,-768 644.88,-768"/>
<polygon fill="#00ff48" stroke="#00ff48" points="644.91,-771.5 654.91,-768 644.91,-764.5 644.91,-771.5"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge56" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff48" d="M532.03,-764.73C553.94,-767.05 576.8,-773.64 593,-789 647.14,-840.35 575.01,-901.49 629,-953 629.99,-953.95 631.01,-954.86 632.05,-955.74"/>
<polygon fill="#00ff48" stroke="#00ff48" points="630.34,-958.82 640.49,-961.86 634.45,-953.15 630.34,-958.82"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge57" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff48" d="M532.31,-770.2C552.79,-773.14 574.72,-778.71 593,-789 614.42,-801.06 607.61,-818.88 629,-831 643.81,-839.39 661.12,-844.61 677.99,-847.82"/>
<polygon fill="#00ff48" stroke="#00ff48" points="677.41,-851.27 687.86,-849.48 678.58,-844.36 677.41,-851.27"/>
</g>
<!-- proc~compute_cartesian_displacements -->
<g id="proc~~global_coordinator~~CallsGraph_node42" class="node">
<title>proc~compute_cartesian_displacements</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node42"><a xlink:href="../proc/compute_cartesian_displacements.html" xlink:title="compute_cartesian_displacements">
<polygon fill="#d9534f" stroke="#d9534f" points="1123,-1550 926,-1550 926,-1526 1123,-1526 1123,-1550"/>
<text text-anchor="middle" x="1024.5" y="-1535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_cartesian_displacements</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements -->
<g id="proc~~global_coordinator~~CallsGraph_edge59" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements</title>
<path fill="none" stroke="#00ff91" d="M500.04,-1592.04C573.42,-1615.48 748.65,-1660.03 877,-1601 899.34,-1590.73 891.73,-1571.32 913,-1559 916.23,-1557.13 919.6,-1555.42 923.06,-1553.86"/>
<polygon fill="#00ff91" stroke="#00ff91" points="924.47,-1557.06 932.42,-1550.06 921.84,-1550.58 924.47,-1557.06"/>
</g>
<!-- proc~compute_force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_node43" class="node">
<title>proc~compute_force_constants</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node43"><a xlink:href="../proc/compute_force_constants.html" xlink:title="compute_force_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="827,-1592 679,-1592 679,-1568 827,-1568 827,-1592"/>
<text text-anchor="middle" x="753" y="-1577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_force_constants</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_edge60" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants</title>
<path fill="none" stroke="#00ff91" d="M549.52,-1580C586.95,-1580 630.93,-1580 668.32,-1580"/>
<polygon fill="#00ff91" stroke="#00ff91" points="668.68,-1583.5 678.68,-1580 668.68,-1576.5 668.68,-1583.5"/>
</g>
<!-- proc~compute_reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_node44" class="node">
<title>proc~compute_reduced_masses</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node44"><a xlink:href="../proc/compute_reduced_masses.html" xlink:title="compute_reduced_masses">
<polygon fill="#d9534f" stroke="#d9534f" points="1101.5,-1508 947.5,-1508 947.5,-1484 1101.5,-1484 1101.5,-1508"/>
<text text-anchor="middle" x="1024.5" y="-1493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_reduced_masses</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_edge61" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses</title>
<path fill="none" stroke="#00ff91" d="M545.45,-1567.96C649.38,-1552.32 830.2,-1525.1 937.17,-1509"/>
<polygon fill="#00ff91" stroke="#00ff91" points="937.92,-1512.42 947.28,-1507.47 936.87,-1505.5 937.92,-1512.42"/>
</g>
<!-- proc~compute_vibrational_frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_node45" class="node">
<title>proc~compute_vibrational_frequencies</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node45"><a xlink:href="../proc/compute_vibrational_frequencies.html" xlink:title="compute_vibrational_frequencies">
<polygon fill="#d9534f" stroke="#d9534f" points="848,-1672 658,-1672 658,-1648 848,-1648 848,-1672"/>
<text text-anchor="middle" x="753" y="-1657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_frequencies</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_edge62" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies</title>
<path fill="none" stroke="#00ff91" d="M498.37,-1592.05C531.15,-1603.78 583.11,-1621.61 629,-1634 644.88,-1638.29 662.07,-1642.3 678.42,-1645.84"/>
<polygon fill="#00ff91" stroke="#00ff91" points="677.97,-1649.32 688.47,-1647.97 679.42,-1642.47 677.97,-1649.32"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~global_coordinator~~CallsGraph_node57" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node57"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828.5,-1272 677.5,-1272 677.5,-1248 828.5,-1248 828.5,-1272"/>
<text text-anchor="middle" x="753" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~global_coordinator~~CallsGraph_edge63" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#00ffda" d="M532.67,-1292.15C572.86,-1286.26 624.31,-1278.72 667.28,-1272.42"/>
<polygon fill="#00ffda" stroke="#00ffda" points="668.05,-1275.84 677.44,-1270.93 667.04,-1268.92 668.05,-1275.84"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge65" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#0091ff" d="M853.1,-936.62C862.07,-940.47 870.28,-945.79 877,-953 932.7,-1012.81 857.86,-1258.68 913,-1319 931.44,-1339.18 962.76,-1343.57 987.36,-1343.4"/>
<polygon fill="#0091ff" stroke="#0091ff" points="987.55,-1346.9 997.43,-1343.08 987.32,-1339.9 987.55,-1346.9"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge66" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#0091ff" d="M853.18,-920.81C872.98,-918.74 893.64,-916.7 913,-915 971.25,-909.89 1392.55,-915.79 1438,-879 1483.27,-842.36 1450.48,-806.28 1474,-753 1502.46,-688.55 1549.95,-619.79 1574.21,-586.47"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1577.3,-588.17 1580.41,-578.04 1571.66,-584.02 1577.3,-588.17"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~global_coordinator~~CallsGraph_edge64" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#0091ff" d="M853.22,-921.85C861.99,-917.89 870.13,-912.71 877,-906 926.96,-857.17 862.55,-801.32 913,-753 928.64,-738.03 951.45,-732.08 972.3,-730.16"/>
<polygon fill="#0091ff" stroke="#0091ff" points="972.58,-733.65 982.33,-729.51 972.13,-726.66 972.58,-733.65"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_node41" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node41"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="1107.5,-786 941.5,-786 941.5,-762 1107.5,-762 1107.5,-786"/>
<text text-anchor="middle" x="1024.5" y="-771.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_edge67" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#0091ff" d="M851.99,-919.95C860.95,-916.35 869.47,-911.78 877,-906 905.06,-884.45 888.43,-860.45 913,-835 931.98,-815.34 958.68,-800.36 981.09,-790.17"/>
<polygon fill="#0091ff" stroke="#0091ff" points="982.63,-793.31 990.39,-786.09 979.82,-786.9 982.63,-793.31"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~global_coordinator~~CallsGraph_node47" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node47"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1105,-1028 944,-1028 944,-1004 1105,-1004 1105,-1028"/>
<text text-anchor="middle" x="1024.5" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~global_coordinator~~CallsGraph_edge68" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#0091ff" d="M853.19,-943.21C861.47,-945.85 869.52,-949.07 877,-953 897.31,-963.68 893.03,-978.7 913,-990 920.54,-994.27 928.75,-997.84 937.17,-1000.82"/>
<polygon fill="#0091ff" stroke="#0091ff" points="936.16,-1004.17 946.75,-1003.95 938.33,-997.52 936.16,-1004.17"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_node48" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node48"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1374.5,-988 1235.5,-988 1235.5,-964 1374.5,-964 1374.5,-988"/>
<text text-anchor="middle" x="1305" y="-973.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge69" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#0091ff" d="M820.32,-944.06C848.77,-948.81 882.42,-953.86 913,-957 1020.73,-968.05 1145.84,-972.71 1224.95,-974.65"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1225.24,-978.16 1235.32,-974.89 1225.41,-971.16 1225.24,-978.16"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node49" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node49"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1136,-868 913,-868 913,-844 1136,-844 1136,-868"/>
<text text-anchor="middle" x="1024.5" y="-853.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge70" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#0091ff" d="M832.79,-920C847.78,-916.42 863.12,-911.84 877,-906 894.73,-898.54 895.36,-889.66 913,-882 923.28,-877.54 934.44,-873.78 945.59,-870.62"/>
<polygon fill="#0091ff" stroke="#0091ff" points="946.6,-873.98 955.35,-868.01 944.79,-867.21 946.6,-873.98"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~global_coordinator~~CallsGraph_node58" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node58"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="1101.5,-948 947.5,-948 947.5,-924 1101.5,-924 1101.5,-948"/>
<text text-anchor="middle" x="1024.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~global_coordinator~~CallsGraph_edge71" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#0091ff" d="M853.2,-933.47C880.75,-933.88 910.43,-934.32 937.18,-934.72"/>
<polygon fill="#0091ff" stroke="#0091ff" points="937.23,-938.22 947.28,-934.87 937.33,-931.22 937.23,-938.22"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_edge72" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#0048ff" d="M851.3,-770.17C877.38,-770.75 905.51,-771.37 931.31,-771.95"/>
<polygon fill="#0048ff" stroke="#0048ff" points="931.38,-775.45 941.45,-772.17 931.53,-768.45 931.38,-775.45"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge73" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#0048ff" d="M841.35,-780.02C853.44,-782.52 865.61,-785.49 877,-789 918.54,-801.81 963.64,-823.76 992.67,-839.03"/>
<polygon fill="#0048ff" stroke="#0048ff" points="991.4,-842.32 1001.87,-843.93 994.69,-836.14 991.4,-842.32"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node59" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node59"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1096.5,-660 952.5,-660 952.5,-636 1096.5,-636 1096.5,-660"/>
<text text-anchor="middle" x="1024.5" y="-645.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge74" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#0048ff" d="M769.21,-755.8C796.37,-734.66 855.75,-691.36 913,-669 922.28,-665.38 932.24,-662.36 942.25,-659.86"/>
<polygon fill="#0048ff" stroke="#0048ff" points="943.32,-663.21 952.26,-657.53 941.73,-656.39 943.32,-663.21"/>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~global_coordinator~~CallsGraph_edge78" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#0000ff" d="M539.65,-1068.87C595.99,-1077.13 671.06,-1088.13 715.2,-1094.61"/>
<polygon fill="#0000ff" stroke="#0000ff" points="714.79,-1098.08 725.19,-1096.07 715.81,-1091.16 714.79,-1098.08"/>
</g>
<!-- header -->
<g id="proc~~global_coordinator~~CallsGraph_node39" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="780,-1028 726,-1028 726,-1004 780,-1004 780,-1028"/>
<text text-anchor="middle" x="753" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~global_coordinator~~CallsGraph_edge75" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#0000ff" d="M539.65,-1047.13C596.29,-1038.83 671.88,-1027.75 715.92,-1021.29"/>
<polygon fill="#0000ff" stroke="#0000ff" points="716.49,-1024.74 725.88,-1019.83 715.47,-1017.82 716.49,-1024.74"/>
</g>
<!-- level_name -->
<g id="proc~~global_coordinator~~CallsGraph_node40" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="790,-1070 716,-1070 716,-1046 790,-1046 790,-1070"/>
<text text-anchor="middle" x="753" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge76" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#0000ff" d="M539.65,-1058C592.11,-1058 660.81,-1058 705.66,-1058"/>
<polygon fill="#0000ff" stroke="#0000ff" points="705.68,-1061.5 715.68,-1058 705.68,-1054.5 705.68,-1061.5"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_node54" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node54"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="815,-822 691,-822 691,-798 815,-798 815,-822"/>
<text text-anchor="middle" x="753" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge77" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#0000ff" d="M539.7,-1060.74C559.3,-1057.79 578.89,-1050.97 593,-1037 659.04,-971.6 563.15,-896.59 629,-831 642.72,-817.33 661.87,-810.65 680.97,-807.74"/>
<polygon fill="#0000ff" stroke="#0000ff" points="681.41,-811.21 690.92,-806.54 680.58,-804.26 681.41,-811.21"/>
</g>
<!-- warning -->
<g id="proc~~global_coordinator~~CallsGraph_node60" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="1052,-702 997,-702 997,-678 1052,-678 1052,-702"/>
<text text-anchor="middle" x="1024.5" y="-687.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge79" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#0000ff" d="M539.78,-1059.6C559.04,-1056.57 578.43,-1049.98 593,-1037 636.48,-998.25 585.3,-949.5 629,-911 712.67,-837.28 795.57,-949.18 877,-873 930.86,-822.61 860.05,-762.34 913,-711 932.17,-692.41 962.4,-687.69 986.39,-687.32"/>
<polygon fill="#0000ff" stroke="#0000ff" points="986.55,-690.83 996.58,-687.42 986.61,-683.83 986.55,-690.83"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge80" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#4800ff" d="M490.52,-595.87C521.97,-581.37 578.02,-557.92 629,-549 984.54,-486.81 1425.38,-541.92 1553.21,-560.45"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1552.84,-563.93 1563.24,-561.92 1553.85,-557 1552.84,-563.93"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge81" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#4800ff" d="M484.99,-595.89C510.83,-579.44 557.3,-548.47 593,-517 610.69,-501.4 611.88,-494.23 629,-478 661.73,-446.96 702.51,-414.2 727.91,-394.42"/>
<polygon fill="#4800ff" stroke="#4800ff" points="730.13,-397.13 735.9,-388.24 725.85,-391.59 730.13,-397.13"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~global_coordinator~~CallsGraph_node53" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node53"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="798.5,-624 707.5,-624 707.5,-600 798.5,-600 798.5,-624"/>
<text text-anchor="middle" x="753" y="-609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~global_coordinator~~CallsGraph_edge82" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#4800ff" d="M553.02,-609.22C600.04,-609.88 656.57,-610.67 697.33,-611.24"/>
<polygon fill="#4800ff" stroke="#4800ff" points="697.29,-614.74 707.34,-611.38 697.39,-607.74 697.29,-614.74"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge83" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#4800ff" d="M487.68,-620.02C515.58,-636.1 563.4,-667.07 593,-705 617.99,-737.02 597.1,-763.86 629,-789 643.64,-800.54 662.34,-806.7 680.71,-809.78"/>
<polygon fill="#4800ff" stroke="#4800ff" points="680.47,-813.28 690.86,-811.19 681.44,-806.35 680.47,-813.28"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~global_coordinator~~CallsGraph_node56" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node56"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-582 678.5,-582 678.5,-558 827.5,-558 827.5,-582"/>
<text text-anchor="middle" x="753" y="-567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~global_coordinator~~CallsGraph_edge84" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#4800ff" d="M553.02,-596.39C589.57,-591.54 631.85,-585.94 668.02,-581.14"/>
<polygon fill="#4800ff" stroke="#4800ff" points="668.6,-584.59 678.05,-579.81 667.68,-577.65 668.6,-584.59"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge85" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#4800ff" d="M543.24,-620.02C570.37,-624.18 601.02,-628.84 629,-633 760.51,-652.56 916.84,-674.86 986.65,-684.78"/>
<polygon fill="#4800ff" stroke="#4800ff" points="986.31,-688.27 996.7,-686.21 987.29,-681.34 986.31,-688.27"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge86" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#9100ff" d="M550.4,-441.94C564.94,-438.41 579.66,-433.85 593,-428 611.07,-420.07 610.95,-409.99 629,-402 656.59,-389.78 690.25,-383.18 715.38,-379.69"/>
<polygon fill="#9100ff" stroke="#9100ff" points="716.12,-383.12 725.59,-378.37 715.22,-376.18 716.12,-383.12"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge87" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#da00ff" d="M535.73,-936.01C556.88,-933.52 578.34,-926.63 593,-911 648.3,-852.03 600.63,-624.7 629,-549 652.51,-486.28 704.64,-425.41 732.9,-395.39"/>
<polygon fill="#da00ff" stroke="#da00ff" points="735.49,-397.74 739.86,-388.1 730.42,-392.91 735.49,-397.74"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge88" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#da00ff" d="M535.75,-928.69C556.65,-931.29 577.96,-938.06 593,-953 660.18,-1019.74 558.25,-1100.06 629,-1163 696.25,-1222.83 1348.22,-1199.47 1438,-1206 1477.36,-1208.86 1522.37,-1213.15 1553.04,-1216.23"/>
<polygon fill="#da00ff" stroke="#da00ff" points="1552.95,-1219.74 1563.25,-1217.26 1553.65,-1212.77 1552.95,-1219.74"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge89" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;info</title>
<path fill="none" stroke="#ff00da" d="M538.67,-495.77C557.8,-492.7 577.41,-486.56 593,-475 622.06,-453.46 600.43,-424.19 629,-402 653.65,-382.85 689.15,-376.98 715.68,-375.53"/>
<polygon fill="#ff00da" stroke="#ff00da" points="715.86,-379.03 725.72,-375.17 715.6,-372.03 715.86,-379.03"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_node46" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node46"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1672,-482 1509,-482 1509,-458 1672,-458 1672,-482"/>
<text text-anchor="middle" x="1590.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_edge90" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#ff00da" d="M538.71,-491.68C557.13,-488.54 576.38,-483.39 593,-475 612.92,-464.95 608.32,-448.39 629,-440 795.57,-372.37 1259.08,-422.46 1438,-440 1469.13,-443.05 1503.36,-449.55 1531.39,-455.73"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1530.89,-459.2 1541.42,-457.98 1532.43,-452.37 1530.89,-459.2"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge91" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;warning</title>
<path fill="none" stroke="#ff00da" d="M534.93,-483.97C624.78,-472.59 781.17,-467.67 877,-549 919.45,-585.03 871.64,-631.72 913,-669 932.84,-686.88 963.02,-691.65 986.82,-692.21"/>
<polygon fill="#ff00da" stroke="#ff00da" points="986.92,-695.71 996.92,-692.22 986.92,-688.71 986.92,-695.71"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge97" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#ff8b00" d="M1054.13,-786.11C1077.6,-796.86 1110.92,-814.1 1136,-835 1155.41,-851.18 1153.68,-861.6 1172,-879 1204.94,-910.27 1248.16,-940.28 1276.01,-958.43"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1274.18,-961.41 1284.48,-963.89 1277.97,-955.53 1274.18,-961.41"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_node63" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node63"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1364,-744 1246,-744 1246,-720 1364,-720 1364,-744"/>
<text text-anchor="middle" x="1305" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_edge92" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#ff8b00" d="M1105.31,-761.96C1146.56,-755.74 1196.38,-748.23 1235.82,-742.28"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1236.5,-745.72 1245.87,-740.77 1235.46,-738.8 1236.5,-745.72"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~global_coordinator~~CallsGraph_node66" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node66"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1389.5,-828 1220.5,-828 1220.5,-804 1389.5,-804 1389.5,-828"/>
<text text-anchor="middle" x="1305" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~global_coordinator~~CallsGraph_edge93" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#ff8b00" d="M1105.31,-786.04C1139.25,-791.15 1178.99,-797.15 1213.97,-802.42"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1213.77,-805.93 1224.18,-803.96 1214.82,-799.01 1213.77,-805.93"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~global_coordinator~~CallsGraph_node67" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node67"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1373.5,-786 1236.5,-786 1236.5,-762 1373.5,-762 1373.5,-786"/>
<text text-anchor="middle" x="1305" y="-771.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~global_coordinator~~CallsGraph_edge94" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#ff8b00" d="M1107.55,-774C1144.95,-774 1189.01,-774 1225.92,-774"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1226.13,-777.5 1236.13,-774 1226.13,-770.5 1226.13,-777.5"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_node68" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node68"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1369,-702 1241,-702 1241,-678 1369,-678 1369,-702"/>
<text text-anchor="middle" x="1305" y="-687.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_edge95" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#ff8b00" d="M1107.72,-764.86C1117.62,-761.9 1127.3,-758.04 1136,-753 1157.27,-740.68 1150.54,-723 1172,-711 1189.76,-701.07 1210.84,-695.48 1230.88,-692.42"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1231.48,-695.87 1240.93,-691.07 1230.55,-688.93 1231.48,-695.87"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~global_coordinator~~CallsGraph_node70" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node70"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1382,-660 1228,-660 1228,-636 1382,-636 1382,-660"/>
<text text-anchor="middle" x="1305" y="-645.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~global_coordinator~~CallsGraph_edge96" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#ff8b00" d="M1107.69,-767.84C1117.93,-764.45 1127.7,-759.67 1136,-753 1167.66,-727.56 1139.96,-693.96 1172,-669 1185.11,-658.78 1201.22,-652.64 1217.63,-649.09"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1218.65,-652.46 1227.85,-647.2 1217.38,-645.58 1218.65,-652.46"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~global_coordinator~~CallsGraph_node71" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node71"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1438,-618 1172,-618 1172,-594 1438,-594 1438,-618"/>
<text text-anchor="middle" x="1305" y="-603.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~global_coordinator~~CallsGraph_edge98" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#ff8b00" d="M1107.67,-769.08C1118.1,-765.53 1127.93,-760.37 1136,-753 1179,-713.72 1128.41,-665.63 1172,-627 1173.19,-625.94 1174.42,-624.93 1175.67,-623.95"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1178.02,-626.58 1184.33,-618.07 1174.09,-620.79 1178.02,-626.58"/>
</g>
<!-- proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_node69" class="node">
<title>proc~element_mass</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node69"><a xlink:href="../proc/element_mass.html" xlink:title="element_mass">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1350,-1571 1260,-1571 1260,-1547 1350,-1547 1350,-1571"/>
<text text-anchor="middle" x="1305" y="-1556.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_mass</text>
</a>
</g>
</g>
<!-- proc~compute_cartesian_displacements&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge99" class="edge">
<title>proc~compute_cartesian_displacements&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ffd000" d="M1123.3,-1545.37C1165.66,-1548.57 1213.66,-1552.19 1249.54,-1554.89"/>
<polygon fill="#ffd000" stroke="#ffd000" points="1249.56,-1558.4 1259.79,-1555.67 1250.08,-1551.42 1249.56,-1558.4"/>
</g>
<!-- proc~compute_reduced_masses&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge100" class="edge">
<title>proc~compute_reduced_masses&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#a2ff00" d="M1092.24,-1508.05C1106.7,-1510.83 1121.89,-1513.9 1136,-1517 1174.32,-1525.42 1217.23,-1536.17 1250.09,-1544.69"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="1249.39,-1548.12 1259.95,-1547.25 1251.15,-1541.35 1249.39,-1548.12"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge101" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;error</title>
<path fill="none" stroke="#5cff00" d="M842.68,-1647.98C865.58,-1644.96 890.2,-1641.79 913,-1639 1029.53,-1624.76 1357.87,-1665.81 1438,-1580 1500.77,-1512.78 1446.96,-840.91 1474,-753 1494.7,-685.7 1545.56,-618.27 1572.35,-585.86"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1575.17,-587.94 1578.92,-578.03 1569.81,-583.44 1575.17,-587.94"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge105" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;warning</title>
<path fill="none" stroke="#5cff00" d="M807.71,-1647.95C833.14,-1639.31 861.31,-1624.84 877,-1601 931.4,-1518.32 848.36,-785.94 913,-711 930.74,-690.43 961.84,-686.01 986.53,-686.27"/>
<polygon fill="#5cff00" stroke="#5cff00" points="986.54,-689.77 996.66,-686.63 986.79,-682.78 986.54,-689.77"/>
</g>
<!-- pic_syev -->
<g id="proc~~global_coordinator~~CallsGraph_node62" class="node">
<title>pic_syev</title>
<polygon fill="#777777" stroke="#777777" points="1053.5,-1672 995.5,-1672 995.5,-1648 1053.5,-1648 1053.5,-1672"/>
<text text-anchor="middle" x="1024.5" y="-1657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_syev</text>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;pic_syev -->
<g id="proc~~global_coordinator~~CallsGraph_edge102" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;pic_syev</title>
<path fill="none" stroke="#5cff00" d="M848.26,-1660C895.17,-1660 949.29,-1660 984.83,-1660"/>
<polygon fill="#5cff00" stroke="#5cff00" points="985.24,-1663.5 995.24,-1660 985.24,-1656.5 985.24,-1663.5"/>
</g>
<!-- proc~mass_weight_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node72" class="node">
<title>proc~mass_weight_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node72"><a xlink:href="../proc/mass_weight_hessian.html" xlink:title="mass_weight_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1088,-1592 961,-1592 961,-1568 1088,-1568 1088,-1592"/>
<text text-anchor="middle" x="1024.5" y="-1577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mass_weight_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge103" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian</title>
<path fill="none" stroke="#5cff00" d="M836.4,-1647.99C850.31,-1644.45 864.33,-1639.88 877,-1634 895.38,-1625.46 894.71,-1614.74 913,-1606 924.83,-1600.34 937.98,-1595.87 950.95,-1592.35"/>
<polygon fill="#5cff00" stroke="#5cff00" points="951.99,-1595.69 960.82,-1589.84 950.27,-1588.91 951.99,-1595.69"/>
</g>
<!-- proc~project_translation_rotation -->
<g id="proc~~global_coordinator~~CallsGraph_node74" class="node">
<title>proc~project_translation_rotation</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node74"><a xlink:href="../proc/project_translation_rotation.html" xlink:title="project_translation_rotation">
<polygon fill="#d9534f" stroke="#d9534f" points="1103.5,-1714 945.5,-1714 945.5,-1690 1103.5,-1690 1103.5,-1714"/>
<text text-anchor="middle" x="1024.5" y="-1699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">project_translation_rotation</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation -->
<g id="proc~~global_coordinator~~CallsGraph_edge104" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation</title>
<path fill="none" stroke="#5cff00" d="M831.23,-1672.04C864.07,-1677.15 902.53,-1683.15 936.38,-1688.42"/>
<polygon fill="#5cff00" stroke="#5cff00" points="935.84,-1691.88 946.26,-1689.96 936.92,-1684.96 935.84,-1691.88"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge106" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00ff2e" d="M1105.31,-1004.54C1142.77,-999.16 1187.3,-992.76 1224.7,-987.39"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1225.65,-990.79 1235.05,-985.9 1224.66,-983.86 1225.65,-990.79"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node65" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node65"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1419.5,-870 1190.5,-870 1190.5,-846 1419.5,-846 1419.5,-870"/>
<text text-anchor="middle" x="1305" y="-855.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge107" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#00ffb9" d="M1136.37,-856.8C1150.79,-856.9 1165.63,-857.01 1180.25,-857.11"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1180.3,-860.61 1190.32,-857.18 1180.35,-853.61 1180.3,-860.61"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_node61" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="1064,-1112 985,-1112 985,-1088 1064,-1088 1064,-1112"/>
<text text-anchor="middle" x="1024.5" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_edge108" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ffff" d="M863.03,-986.1C867.97,-988.63 872.66,-991.58 877,-995 908.9,-1020.14 881.34,-1053.56 913,-1079 930.27,-1092.87 953.93,-1098.58 974.93,-1100.62"/>
<polygon fill="#00ffff" stroke="#00ffff" points="974.75,-1104.12 984.98,-1101.36 975.26,-1097.14 974.75,-1104.12"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~global_coordinator~~CallsGraph_node64" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node64"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1088.5,-1070 960.5,-1070 960.5,-1046 1088.5,-1046 1088.5,-1070"/>
<text text-anchor="middle" x="1024.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~global_coordinator~~CallsGraph_edge109" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#00ffff" d="M857.24,-986.02C864.12,-988.51 870.78,-991.47 877,-995 898.39,-1007.12 891.73,-1024.68 913,-1037 924.38,-1043.59 937.42,-1048.17 950.45,-1051.33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="949.88,-1054.79 960.39,-1053.49 951.36,-1047.95 949.88,-1054.79"/>
</g>
<!-- sort -->
<g id="proc~~global_coordinator~~CallsGraph_node75" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="1051.5,-1154 997.5,-1154 997.5,-1130 1051.5,-1130 1051.5,-1154"/>
<text text-anchor="middle" x="1024.5" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~global_coordinator~~CallsGraph_edge110" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#00ffff" d="M864.7,-986.09C869.08,-988.65 873.21,-991.6 877,-995 920.37,-1033.87 870,-1081.72 913,-1121 932.84,-1139.13 963.29,-1143.83 987.2,-1144.31"/>
<polygon fill="#00ffff" stroke="#00ffff" points="987.35,-1147.81 997.33,-1144.27 987.32,-1140.81 987.35,-1147.81"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~global_coordinator~~CallsGraph_node73" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node73"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1083.5,-1310 965.5,-1310 965.5,-1286 1083.5,-1286 1083.5,-1310"/>
<text text-anchor="middle" x="1024.5" y="-1295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~global_coordinator~~CallsGraph_edge111" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#00b9ff" d="M870.64,-1300.27C899.4,-1299.84 929.27,-1299.4 954.9,-1299.02"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="955.3,-1302.51 965.24,-1298.86 955.19,-1295.51 955.3,-1302.51"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_edge112" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#0073ff" d="M831.23,-1129.96C877.44,-1122.76 934.77,-1113.83 974.75,-1107.6"/>
<polygon fill="#0073ff" stroke="#0073ff" points="975.44,-1111.03 984.78,-1106.03 974.36,-1104.12 975.44,-1111.03"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~global_coordinator~~CallsGraph_edge113" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#0073ff" d="M877.31,-1142C917.26,-1142 958.55,-1142 987.02,-1142"/>
<polygon fill="#0073ff" stroke="#0073ff" points="987.27,-1145.5 997.27,-1142 987.27,-1138.5 987.27,-1145.5"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node77" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node77"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1707,-870 1474,-870 1474,-846 1707,-846 1707,-870"/>
<text text-anchor="middle" x="1590.5" y="-855.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge114" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#65ff00" d="M1419.68,-858C1434.2,-858 1449.12,-858 1463.82,-858"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1463.95,-861.5 1473.95,-858 1463.95,-854.5 1463.95,-861.5"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~global_coordinator~~CallsGraph_node79" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node79"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1630,-828 1551,-828 1551,-804 1630,-804 1630,-828"/>
<text text-anchor="middle" x="1590.5" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~global_coordinator~~CallsGraph_edge115" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff00" d="M1389.53,-816C1438.76,-816 1499.34,-816 1540.84,-816"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1540.96,-819.5 1550.96,-816 1540.96,-812.5 1540.96,-819.5"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge116" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ff66" d="M1373.63,-772.7C1395.33,-769.88 1418.71,-764.14 1438,-753 1507.71,-712.73 1558.3,-627.15 1579.07,-587.28"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1582.29,-588.68 1583.7,-578.18 1576.05,-585.5 1582.29,-588.68"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge119" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ff66" d="M1373.76,-771.41C1396.34,-773.79 1420.24,-780.25 1438,-795 1454.58,-808.77 1554.63,-1112.98 1582.37,-1198.07"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1579.1,-1199.32 1585.52,-1207.74 1585.75,-1197.15 1579.1,-1199.32"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_edge117" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ff66" d="M1373.54,-778.39C1396.77,-776.33 1421.15,-769.62 1438,-753 1504.79,-687.11 1422.34,-623.31 1474,-545 1491.82,-517.98 1523.09,-498.57 1548.61,-486.27"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1550.1,-489.43 1557.71,-482.06 1547.16,-483.08 1550.1,-489.43"/>
</g>
<!-- proc~error_set -->
<g id="proc~~global_coordinator~~CallsGraph_node78" class="node">
<title>proc~error_set</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node78"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1643,-786 1538,-786 1538,-762 1643,-762 1643,-786"/>
<text text-anchor="middle" x="1590.5" y="-771.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~global_coordinator~~CallsGraph_edge118" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ff66" d="M1373.55,-774C1420.44,-774 1482.43,-774 1527.96,-774"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1527.99,-777.5 1537.99,-774 1527.99,-770.5 1527.99,-777.5"/>
</g>
<!-- proc~mass_weight_hessian&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge120" class="edge">
<title>proc~mass_weight_hessian&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#6500ff" d="M1088,-1575.29C1136.61,-1571.62 1203.35,-1566.59 1249.74,-1563.09"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1250.18,-1566.57 1259.89,-1562.33 1249.66,-1559.59 1250.18,-1566.57"/>
</g>
<!-- proc~project_translation_rotation&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge122" class="edge">
<title>proc~project_translation_rotation&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ff00cb" d="M1103.78,-1691.59C1114.83,-1688.84 1125.87,-1685.38 1136,-1681 1195.28,-1655.38 1253.87,-1605.87 1283.7,-1578.45"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1286.4,-1580.72 1291.33,-1571.34 1281.63,-1575.6 1286.4,-1580.72"/>
</g>
<!-- pic_gesvd -->
<g id="proc~~global_coordinator~~CallsGraph_node76" class="node">
<title>pic_gesvd</title>
<polygon fill="#777777" stroke="#777777" points="1337.5,-1714 1272.5,-1714 1272.5,-1690 1337.5,-1690 1337.5,-1714"/>
<text text-anchor="middle" x="1305" y="-1699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_gesvd</text>
</g>
<!-- proc~project_translation_rotation&#45;&gt;pic_gesvd -->
<g id="proc~~global_coordinator~~CallsGraph_edge121" class="edge">
<title>proc~project_translation_rotation&#45;&gt;pic_gesvd</title>
<path fill="none" stroke="#ff00cb" d="M1103.82,-1702C1155.28,-1702 1220.58,-1702 1262.34,-1702"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1262.42,-1705.5 1272.42,-1702 1262.42,-1698.5 1262.42,-1705.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocglobal_coordinatorCallsGraph = svgPanZoom('#procglobal_coordinatorCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~global_coordinator~~CalledByGraph Pages: 1 -->
<svg id="procglobal_coordinatorCalledByGraph" width="641pt" height="79pt"
 viewBox="0.00 0.00 641.00 78.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~global_coordinator~~CalledByGraph" class="graph" transform="scale(0.7 0.7) rotate(0) translate(4 108)">
<title>proc~~global_coordinator~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-108 908,-108 908,4 -4,4"/>
<!-- proc~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_node1" class="node">
<title>proc~global_coordinator</title>
<polygon fill="none" stroke="black" points="904,-64 791,-64 791,-40 904,-40 904,-64"/>
<text text-anchor="middle" x="847.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50">global_coordinator</text>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_node2" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node2"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="755,-64 642,-64 642,-40 755,-40 755,-64"/>
<text text-anchor="middle" x="698.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_edge1" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.07,-52C763.49,-52 772.24,-52 780.84,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="780.85,-55.5 790.85,-52 780.85,-48.5 780.85,-55.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_node3" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node3"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-64 443,-64 443,-40 606,-40 606,-64"/>
<text text-anchor="middle" x="524.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_edge2" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M606.21,-52C614.78,-52 623.41,-52 631.77,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="631.81,-55.5 641.81,-52 631.81,-48.5 631.81,-55.5"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_node4" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node4"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="407,-64 313,-64 313,-40 407,-40 407,-64"/>
<text text-anchor="middle" x="360" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge3" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M407.13,-52C415.24,-52 423.94,-52 432.78,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="432.8,-55.5 442.8,-52 432.8,-48.5 432.8,-55.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~global_coordinator~~CalledByGraph_node5" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node5"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="266.5,-104 100.5,-104 100.5,-80 266.5,-80 266.5,-104"/>
<text text-anchor="middle" x="183.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge4" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M236.86,-80C257.74,-75.21 281.82,-69.69 303.05,-64.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.94,-68.21 312.9,-62.57 302.37,-61.39 303.94,-68.21"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~global_coordinator~~CalledByGraph_node6" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node6"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="277,-24 90,-24 90,0 277,0 277,-24"/>
<text text-anchor="middle" x="183.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge5" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M236.86,-24C257.74,-28.79 281.82,-34.31 303.05,-39.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.37,-42.61 312.9,-41.43 303.94,-35.79 302.37,-42.61"/>
</g>
<!-- program~main -->
<g id="proc~~global_coordinator~~CalledByGraph_node7" class="node">
<title>program~main</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node7"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-44 0,-44 0,-20 54,-20 54,-44"/>
<text text-anchor="middle" x="27" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge6" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M54.25,-33.59C107.66,-36.81 230.05,-44.21 302.43,-48.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.54,-52.09 312.73,-49.2 302.96,-45.11 302.54,-52.09"/>
</g>
<!-- program~main&#45;&gt;proc~run_multi_molecule_calculations -->
<g id="proc~~global_coordinator~~CalledByGraph_edge7" class="edge">
<title>program~main&#45;&gt;proc~run_multi_molecule_calculations</title>
<path fill="none" stroke="#00ff00" d="M54.21,-28.61C61.81,-27.62 70.61,-26.48 79.96,-25.27"/>
<polygon fill="#00ff00" stroke="#00ff00" points="80.42,-28.74 89.89,-23.99 79.52,-21.8 80.42,-28.74"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocglobal_coordinatorCalledByGraph = svgPanZoom('#procglobal_coordinatorCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-calc_type_local~3"></span>
              integer(kind=int32),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>calc_type_local</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-coord_timer~3"></span>
              type(timer_type),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>coord_timer</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_fragment"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_fragment</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dummy_msg~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dummy_msg</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-finished_nodes~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>finished_nodes</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_idx~6"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_idx</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-handling_local_workers~2"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>handling_local_workers</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-has_pending~2"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>has_pending</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_dummy~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_dummy</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_finished_workers~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_finished_workers</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_status~2"></span>
              type(MPI_Status),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-req~6"></span>
              type(request_t),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>req</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-request_source~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>request_source</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results~7"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results_received~2"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>results_received</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-status~4"></span>
              type(MPI_Status),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-worker_fragment_map"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>worker_fragment_map</strong>(node_comm%size())</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-worker_source~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>worker_source</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">module subroutine </span><span class="n">global_coordinator</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                        </span><span class="n">node_leader_ranks</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">calc_type</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Global coordinator for distributing fragments to node coordinators</span>
<span class="w">      </span><span class="c">!! will act as a node coordinator for a single node calculation</span>
<span class="w">      </span><span class="c">!! Uses int64 for total_fragments to handle large fragment counts that overflow int32.</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_fragments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">node_leader_ranks</span><span class="p">(:)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">calc_type</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span>

<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">timer_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coord_timer</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">results_received</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">finished_nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">request_source</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_msg</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_idx</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">MPI_Status</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">handling_local_workers</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">has_pending</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">calc_type_local</span>

<span class="w">      </span><span class="c">! For local workers</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="p">,</span><span class="w"> </span><span class="n">local_dummy</span>

<span class="w">      </span><span class="c">! Storage for results</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">())</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">worker_source</span>

<span class="w">      </span><span class="c">! MPI request handles for non-blocking operations</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">request_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">req</span>

<span class="w">      </span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_type</span>

<span class="w">      </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_fragments</span>
<span class="w">      </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">handling_local_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0_int64</span>

<span class="w">      </span><span class="c">! Allocate storage for results</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">))</span>
<span class="w">      </span><span class="n">worker_fragment_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator starting with &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="s2">&quot; fragments for &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; nodes&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="n">start</span><span class="p">()</span>
<span class="w">      </span><span class="k">do while</span><span class="w"> </span><span class="p">(</span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">)</span>

<span class="w">         </span><span class="c">! PRIORITY 1: Check for incoming results from local workers</span>
<span class="w">         </span><span class="c">! This MUST be checked before sending new work to avoid race conditions</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! Keep checking for results until there are none pending</span>
<span class="w">            </span><span class="k">do</span>
<span class="k">               call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="k">               </span><span class="n">worker_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span>

<span class="w">               </span><span class="c">! Safety check: worker should have a fragment assigned</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received result from worker &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="s2">&quot; but no fragment was assigned!&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Invalid worker_fragment_map state&quot;</span>
<span class="w">               </span><span class="k">end if</span>

<span class="w">               </span><span class="c">! Receive result and store it using the fragment index for this worker</span>
<span class="w">               </span><span class="k">call </span><span class="n">result_irecv</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)),</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">worker_source</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">TAG_WORKER_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="c">! Clear the mapping since we&#39;ve received the result</span>
<span class="w">               </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">               </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">results_received</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">results_received</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Processed &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">results_received</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; fragments [&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s]&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! PRIORITY 1b: Check for incoming results from remote node coordinators</span>
<span class="w">         </span><span class="k">do</span>
<span class="k">            call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="w">            </span><span class="c">! Receive fragment index and result from node coordinator</span>
<span class="w">            </span><span class="c">! TODO: serialize the data for better performance</span>
<span class="w">            </span><span class="k">call </span><span class="n">irecv</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_idx</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">result_irecv</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">fragment_idx</span><span class="p">),</span><span class="w"> </span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">results_received</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">results_received</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Processed &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">results_received</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; fragments [&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s]&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>

<span class="w">         </span><span class="c">! PRIORITY 2: Remote node coordinator requests</span>
<span class="w">         </span><span class="k">call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">irecv</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_msg</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="n">request_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_fragment</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">send_fragment_to_node</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">request_source</span><span class="p">)</span>
<span class="w">               </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               call </span><span class="n">isend</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">request_source</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_FINISH</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! PRIORITY 3: Local workers (shared memory) - send new work</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! Only process work request if this worker doesn&#39;t have pending results</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">irecv</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">local_dummy</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">                  </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_fragment</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     call </span><span class="n">send_fragment_to_worker</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span>
<span class="w">                     </span><span class="c">! Track which fragment was sent to this worker</span>
<span class="w">                     </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span>
<span class="w">                     </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                     call </span><span class="n">isend</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_FINISH</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">                     </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">               end if</span>
<span class="w">               </span><span class="c">! If worker still has pending results, skip the work request</span>
<span class="w">               </span><span class="c">! It will be processed on the next iteration after results are received</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! Finalize local worker completion</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">handling_local_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Manually incremented finished_nodes for self&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator finished local workers&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">      end do</span>

<span class="k">      call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator finished all fragments&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="k">stop</span><span class="p">()</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time to evaluate all fragments &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">block</span>
<span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_energy</span>
<span class="w">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">         </span><span class="c">! Compute the many-body expansion</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing Many-Body Expansion (MBE)...&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="n">start</span><span class="p">()</span>

<span class="w">         </span><span class="c">! Use combined function if computing gradients or Hessians (more efficient)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CALC_TYPE_HESSIAN</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;sys_geom required for Hessian calculation in global_coordinator&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Missing sys_geom for Hessian calculation&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_hessian</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">)</span>
<span class="w">         </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CALC_TYPE_GRADIENT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;sys_geom required for gradient calculation in global_coordinator&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Missing sys_geom for gradient calculation&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="o">=</span><span class="n">bonds</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">)</span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">)</span>
<span class="w">         </span><span class="k">end if</span>

<span class="k">         call </span><span class="n">coord_timer</span><span class="p">%</span><span class="k">stop</span><span class="p">()</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time to compute MBE &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="k">end block</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="w">   </span><span class="k">end subroutine </span><span class="n">global_coordinator</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-08 11:02 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>