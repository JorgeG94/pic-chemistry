<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>compute_vibrational_thermo &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>compute_vibrational_thermo
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.3% of total for procedures.">34 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_thermochemistry.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_thermochemistry.f90.html'>mqc_thermochemistry.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_thermochemistry.html'>mqc_thermochemistry</a></li>
            <li class="breadcrumb-item active" aria-current="page">compute_vibrational_thermo</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-cv_sum">Cv_sum</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-e_sum">E_sum</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-s_sum">S_sum</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-t~3">T</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-exp_neg_u">exp_neg_u</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-exp_u">exp_u</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-freq">freq</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-i~8">i</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-theta_v">theta_v</a>
            <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#variable-u">u</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/compute_vibrational_thermo.html#src">compute_vibrational_thermo</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public pure subroutine compute_vibrational_thermo(frequencies, n_freqs, temperature, E, S, Cv)  
</h2>
    

    <p>Compute vibrational contributions to thermodynamic properties.</p>
<p>Uses quantum harmonic oscillator partition function.
E_vib = R * sum(theta_v * [1/(exp(u)-1)]) where u = theta_v/T
S_vib = R * sum([u/(exp(u)-1) - ln(1-exp(-u))])
Cv_vib = R * sum(u^2 * exp(u) / (exp(u)-1)^2)</p>
<p>Note: ZPE is NOT included here (computed separately).</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-frequencies~2"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>frequencies</strong>(:)</td>
            <td>
                <p>Frequencies in cm^-1</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_freqs~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_freqs</strong></td>
            <td>
                <p>Number of frequencies</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temperature~4"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>temperature</strong></td>
            <td>
                <p>Temperature in K</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-e~3"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>E</strong></td>
            <td>
                <p>Thermal energy in Hartree (excluding ZPE)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~3"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>S</strong></td>
            <td>
                <p>Entropy in cal/(mol*K)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cv~3"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Cv</strong></td>
            <td>
                <p>Heat capacity in cal/(mol*K)</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_vibrational_thermo~~CalledByGraph Pages: 1 -->
<svg id="proccompute_vibrational_thermoCalledByGraph" width="641pt" height="123pt"
 viewBox="0.00 0.00 641.00 122.92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_vibrational_thermo~~CalledByGraph" class="graph" transform="scale(0.43 0.43) rotate(0) translate(4 280)">
<title>proc~~compute_vibrational_thermo~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-280 1477,-280 1477,4 -4,4"/>
<!-- proc~compute_vibrational_thermo -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node1" class="node">
<title>proc~compute_vibrational_thermo</title>
<polygon fill="none" stroke="black" points="1473,-130 1307,-130 1307,-106 1473,-106 1473,-130"/>
<text text-anchor="middle" x="1390" y="-115.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_vibrational_thermo</text>
</g>
<!-- proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node2" class="node">
<title>proc~compute_thermochemistry</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node2"><a xlink:href="../proc/compute_thermochemistry.html" xlink:title="compute_thermochemistry">
<polygon fill="#d9534f" stroke="#d9534f" points="1271,-130 1114,-130 1114,-106 1271,-106 1271,-130"/>
<text text-anchor="middle" x="1192.5" y="-115.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_thermochemistry</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_vibrational_thermo -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge1" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_vibrational_thermo</title>
<path fill="none" stroke="#ff0000" d="M1271.05,-118C1279.48,-118 1288.11,-118 1296.7,-118"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1296.73,-121.5 1306.73,-118 1296.73,-114.5 1296.73,-121.5"/>
</g>
<!-- proc~compute_mbe -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node3" class="node">
<title>proc~compute_mbe</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node3"><a xlink:href="../proc/compute_mbe.html" xlink:title="compute_mbe">
<polygon fill="#d9534f" stroke="#d9534f" points="860,-234 771,-234 771,-210 860,-210 860,-234"/>
<text text-anchor="middle" x="815.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M860.22,-215.56C912.71,-207.19 1003.05,-190.8 1078,-167 1105.74,-158.19 1135.95,-144.96 1158.22,-134.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1159.73,-137.63 1167.25,-130.16 1156.71,-131.31 1159.73,-137.63"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node6" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node6"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="1078,-110 930,-110 930,-86 1078,-86 1078,-110"/>
<text text-anchor="middle" x="1004" y="-95.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge13" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#00ffff" d="M860.21,-214.16C871.65,-211.05 883.66,-206.79 894,-201 932.43,-179.46 967.68,-141.39 987.16,-118.06"/>
<polygon fill="#00ffff" stroke="#00ffff" points="989.98,-120.14 993.61,-110.19 984.56,-115.71 989.98,-120.14"/>
</g>
<!-- proc~gmbe_pie_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node4" class="node">
<title>proc~gmbe_pie_coordinator</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node4"><a xlink:href="../proc/gmbe_pie_coordinator.html" xlink:title="gmbe_pie_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="882,-192 749,-192 749,-168 882,-168 882,-192"/>
<text text-anchor="middle" x="815.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gmbe_pie_coordinator</text>
</a>
</g>
</g>
<!-- proc~gmbe_pie_coordinator&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge3" class="edge">
<title>proc~gmbe_pie_coordinator&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M882.24,-171.63C935.24,-164.6 1011.61,-153.83 1078,-142 1094.26,-139.1 1111.74,-135.6 1128,-132.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1128.89,-135.57 1137.94,-130.06 1127.43,-128.72 1128.89,-135.57"/>
</g>
<!-- proc~gmbe_pie_coordinator&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge14" class="edge">
<title>proc~gmbe_pie_coordinator&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#00ffff" d="M867.95,-167.97C876.77,-165.37 885.74,-162.37 894,-159 923.34,-147.03 954.7,-128.85 976.21,-115.45"/>
<polygon fill="#00ffff" stroke="#00ffff" points="978.21,-118.33 984.8,-110.03 974.47,-112.41 978.21,-118.33"/>
</g>
<!-- proc~hessian_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node5" class="node">
<title>proc~hessian_coordinator</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node5"><a xlink:href="../proc/hessian_coordinator.html" xlink:title="hessian_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="876,-150 755,-150 755,-126 876,-126 876,-150"/>
<text text-anchor="middle" x="815.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hessian_coordinator</text>
</a>
</g>
</g>
<!-- proc~hessian_coordinator&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge4" class="edge">
<title>proc~hessian_coordinator&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M876.33,-134.81C937.73,-131.53 1033.9,-126.41 1103.87,-122.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1104.19,-126.16 1113.99,-122.13 1103.82,-119.17 1104.19,-126.16"/>
</g>
<!-- proc~hessian_coordinator&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge15" class="edge">
<title>proc~hessian_coordinator&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#00ffff" d="M872.46,-126C892.74,-121.65 915.84,-116.69 936.92,-112.17"/>
<polygon fill="#00ffff" stroke="#00ffff" points="937.72,-115.58 946.76,-110.06 936.25,-108.74 937.72,-115.58"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge5" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M1078.17,-105.85C1086.61,-106.75 1095.27,-107.68 1103.88,-108.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1103.61,-112.09 1113.93,-109.68 1104.36,-105.13 1103.61,-112.09"/>
</g>
<!-- proc~serial_gmbe_pie_processor -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node7" class="node">
<title>proc~serial_gmbe_pie_processor</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node7"><a xlink:href="../proc/serial_gmbe_pie_processor.html" xlink:title="serial_gmbe_pie_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="894,-66 737,-66 737,-42 894,-42 894,-66"/>
<text text-anchor="middle" x="815.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_gmbe_pie_processor</text>
</a>
</g>
</g>
<!-- proc~serial_gmbe_pie_processor&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge6" class="edge">
<title>proc~serial_gmbe_pie_processor&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M894.25,-55.58C946.68,-57.93 1017.14,-63.57 1078,-77 1104.38,-82.82 1132.97,-93.18 1154.86,-102.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1153.53,-105.26 1164.11,-105.83 1156.2,-98.79 1153.53,-105.26"/>
</g>
<!-- proc~serial_gmbe_pie_processor&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge16" class="edge">
<title>proc~serial_gmbe_pie_processor&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#00ffff" d="M867.46,-66.02C890.59,-71.48 918.12,-77.98 942.31,-83.68"/>
<polygon fill="#00ffff" stroke="#00ffff" points="941.56,-87.1 952.1,-85.99 943.17,-80.29 941.56,-87.1"/>
</g>
<!-- proc~unfragmented_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node8" class="node">
<title>proc~unfragmented_calculation</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node8"><a xlink:href="../proc/unfragmented_calculation.html" xlink:title="unfragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="892,-24 739,-24 739,0 892,0 892,-24"/>
<text text-anchor="middle" x="815.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unfragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~unfragmented_calculation&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge7" class="edge">
<title>proc~unfragmented_calculation&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M892.06,-17.02C945.24,-22.26 1017.45,-32.83 1078,-54 1110.28,-65.29 1144.02,-85.56 1166.23,-100.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1164.47,-103.31 1174.72,-106 1168.39,-97.51 1164.47,-103.31"/>
</g>
<!-- proc~unfragmented_calculation&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge17" class="edge">
<title>proc~unfragmented_calculation&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#00ffff" d="M868.86,-24.09C877.39,-26.65 886.04,-29.63 894,-33 924.17,-45.8 956.08,-65.67 977.52,-80.07"/>
<polygon fill="#00ffff" stroke="#00ffff" points="975.8,-83.13 986.04,-85.87 979.74,-77.35 975.8,-83.13"/>
</g>
<!-- interface~hessian_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node9" class="node">
<title>interface~hessian_coordinator</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node9"><a xlink:href="../interface/hessian_coordinator.html" xlink:title="hessian_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="650,-150 529,-150 529,-126 650,-126 650,-150"/>
<text text-anchor="middle" x="589.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hessian_coordinator</text>
</a>
</g>
</g>
<!-- interface~hessian_coordinator&#45;&gt;proc~hessian_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge11" class="edge">
<title>interface~hessian_coordinator&#45;&gt;proc~hessian_coordinator</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M650.23,-138C679.34,-138 714.53,-138 744.85,-138"/>
<polygon fill="#00ff00" stroke="#00ff00" points="744.93,-141.5 754.93,-138 744.93,-134.5 744.93,-141.5"/>
</g>
<!-- interface~unfragmented_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node10" class="node">
<title>interface~unfragmented_calculation</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node10"><a xlink:href="../interface/unfragmented_calculation.html" xlink:title="unfragmented_calculation">
<polygon fill="#a7506f" stroke="#a7506f" points="666,-24 513,-24 513,0 666,0 666,-24"/>
<text text-anchor="middle" x="589.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unfragmented_calculation</text>
</a>
</g>
</g>
<!-- interface~unfragmented_calculation&#45;&gt;proc~unfragmented_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge19" class="edge">
<title>interface~unfragmented_calculation&#45;&gt;proc~unfragmented_calculation</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M666.02,-12C686.22,-12 708.19,-12 728.88,-12"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="728.92,-15.5 738.92,-12 728.92,-8.5 728.92,-15.5"/>
</g>
<!-- proc~compute_gmbe -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node11" class="node">
<title>proc~compute_gmbe</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node11"><a xlink:href="../proc/compute_gmbe.html" xlink:title="compute_gmbe">
<polygon fill="#d9534f" stroke="#d9534f" points="863.5,-108 767.5,-108 767.5,-84 863.5,-84 863.5,-108"/>
<text text-anchor="middle" x="815.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_gmbe</text>
</a>
</g>
</g>
<!-- proc~compute_gmbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge12" class="edge">
<title>proc~compute_gmbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#00ffff" d="M863.56,-96.5C880.65,-96.69 900.51,-96.9 919.8,-97.11"/>
<polygon fill="#00ffff" stroke="#00ffff" points="919.77,-100.61 929.81,-97.22 919.85,-93.61 919.77,-100.61"/>
</g>
<!-- proc~global_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node12" class="node">
<title>proc~global_coordinator</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node12"><a xlink:href="../proc/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="646,-276 533,-276 533,-252 646,-252 646,-276"/>
<text text-anchor="middle" x="589.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge8" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M646.16,-253.56C681.18,-247 726.15,-238.57 760.8,-232.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="761.55,-235.49 770.73,-230.21 760.26,-228.61 761.55,-235.49"/>
</g>
<!-- proc~gmbe_run_distributed -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node13" class="node">
<title>proc~gmbe_run_distributed</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node13"><a xlink:href="../proc/gmbe_run_distributed.html" xlink:title="gmbe_context_t%gmbe_run_distributed">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-192 478,-192 478,-168 701,-168 701,-192"/>
<text text-anchor="middle" x="589.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gmbe_context_t%gmbe_run_distributed</text>
</a>
</g>
</g>
<!-- proc~gmbe_run_distributed&#45;&gt;proc~gmbe_pie_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge10" class="edge">
<title>proc~gmbe_run_distributed&#45;&gt;proc~gmbe_pie_coordinator</title>
<path fill="none" stroke="#ffff00" d="M701.19,-180C713.93,-180 726.7,-180 738.83,-180"/>
<polygon fill="#ffff00" stroke="#ffff00" points="738.85,-183.5 748.85,-180 738.85,-176.5 738.85,-183.5"/>
</g>
<!-- proc~gmbe_run_serial -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node14" class="node">
<title>proc~gmbe_run_serial</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node14"><a xlink:href="../proc/gmbe_run_serial.html" xlink:title="gmbe_context_t%gmbe_run_serial">
<polygon fill="#d9534f" stroke="#d9534f" points="687,-66 492,-66 492,-42 687,-42 687,-66"/>
<text text-anchor="middle" x="589.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gmbe_context_t%gmbe_run_serial</text>
</a>
</g>
</g>
<!-- proc~gmbe_run_serial&#45;&gt;proc~serial_gmbe_pie_processor -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge18" class="edge">
<title>proc~gmbe_run_serial&#45;&gt;proc~serial_gmbe_pie_processor</title>
<path fill="none" stroke="#0000ff" d="M687.12,-54C700.2,-54 713.57,-54 726.49,-54"/>
<polygon fill="#0000ff" stroke="#0000ff" points="726.74,-57.5 736.74,-54 726.74,-50.5 726.74,-57.5"/>
</g>
<!-- proc~serial_fragment_processor -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node15" class="node">
<title>proc~serial_fragment_processor</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node15"><a xlink:href="../proc/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="666.5,-234 512.5,-234 512.5,-210 666.5,-210 666.5,-234"/>
<text text-anchor="middle" x="589.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge9" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M666.65,-222C697.6,-222 732.63,-222 760.83,-222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="760.89,-225.5 770.89,-222 760.89,-218.5 760.89,-225.5"/>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node16" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node16"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="400,-276 287,-276 287,-252 400,-252 400,-276"/>
<text text-anchor="middle" x="343.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge22" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M400.17,-264C436.58,-264 484.32,-264 522.62,-264"/>
<polygon fill="#00ff91" stroke="#00ff91" points="522.64,-267.5 532.64,-264 522.64,-260.5 522.64,-267.5"/>
</g>
<!-- interface~serial_fragment_processor -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node17" class="node">
<title>interface~serial_fragment_processor</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node17"><a xlink:href="../interface/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#a7506f" stroke="#a7506f" points="420.5,-234 266.5,-234 266.5,-210 420.5,-210 420.5,-234"/>
<text text-anchor="middle" x="343.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge23" class="edge">
<title>interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M420.7,-222C446.61,-222 475.75,-222 502.39,-222"/>
<polygon fill="#ff00da" stroke="#ff00da" points="502.46,-225.5 512.46,-222 502.46,-218.5 502.46,-225.5"/>
</g>
<!-- proc~distributed_unfragmented_hessian -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node18" class="node">
<title>proc~distributed_unfragmented_hessian</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node18"><a xlink:href="../proc/distributed_unfragmented_hessian.html" xlink:title="distributed_unfragmented_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="442,-150 245,-150 245,-126 442,-126 442,-150"/>
<text text-anchor="middle" x="343.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distributed_unfragmented_hessian</text>
</a>
</g>
</g>
<!-- proc~distributed_unfragmented_hessian&#45;&gt;interface~hessian_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge20" class="edge">
<title>proc~distributed_unfragmented_hessian&#45;&gt;interface~hessian_coordinator</title>
<path fill="none" stroke="#ff0000" d="M442.34,-138C467.86,-138 494.86,-138 518.61,-138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="518.92,-141.5 528.92,-138 518.92,-134.5 518.92,-141.5"/>
</g>
<!-- proc~run_unfragmented_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node19" class="node">
<title>proc~run_unfragmented_calculation</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node19"><a xlink:href="../proc/run_unfragmented_calculation.html" xlink:title="run_unfragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="431.5,-24 255.5,-24 255.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="343.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_unfragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_unfragmented_calculation&#45;&gt;interface~unfragmented_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge21" class="edge">
<title>proc~run_unfragmented_calculation&#45;&gt;interface~unfragmented_calculation</title>
<path fill="none" stroke="#ffda00" d="M431.56,-12C454.68,-12 479.64,-12 502.7,-12"/>
<polygon fill="#ffda00" stroke="#ffda00" points="502.81,-15.5 512.81,-12 502.81,-8.5 502.81,-15.5"/>
</g>
<!-- interface~distributed_unfragmented_hessian -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node20" class="node">
<title>interface~distributed_unfragmented_hessian</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node20"><a xlink:href="../interface/distributed_unfragmented_hessian.html" xlink:title="distributed_unfragmented_hessian">
<polygon fill="#a7506f" stroke="#a7506f" points="203,-150 6,-150 6,-126 203,-126 203,-150"/>
<text text-anchor="middle" x="104.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distributed_unfragmented_hessian</text>
</a>
</g>
</g>
<!-- interface~distributed_unfragmented_hessian&#45;&gt;proc~distributed_unfragmented_hessian -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge26" class="edge">
<title>interface~distributed_unfragmented_hessian&#45;&gt;proc~distributed_unfragmented_hessian</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M203.27,-138C213.7,-138 224.36,-138 234.9,-138"/>
<polygon fill="#00ffff" stroke="#00ffff" points="234.96,-141.5 244.96,-138 234.96,-134.5 234.96,-141.5"/>
</g>
<!-- proc~mbe_run_distributed -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node21" class="node">
<title>proc~mbe_run_distributed</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node21"><a xlink:href="../proc/mbe_run_distributed.html" xlink:title="mbe_context_t%mbe_run_distributed">
<polygon fill="#d9534f" stroke="#d9534f" points="209,-276 0,-276 0,-252 209,-252 209,-276"/>
<text text-anchor="middle" x="104.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_context_t%mbe_run_distributed</text>
</a>
</g>
</g>
<!-- proc~mbe_run_distributed&#45;&gt;interface~global_coordinator -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge24" class="edge">
<title>proc~mbe_run_distributed&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M209.11,-264C232.12,-264 255.9,-264 276.89,-264"/>
<polygon fill="#ff0000" stroke="#ff0000" points="276.95,-267.5 286.95,-264 276.95,-260.5 276.95,-267.5"/>
</g>
<!-- proc~mbe_run_serial -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node22" class="node">
<title>proc~mbe_run_serial</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node22"><a xlink:href="../proc/mbe_run_serial.html" xlink:title="mbe_context_t%mbe_run_serial">
<polygon fill="#d9534f" stroke="#d9534f" points="195,-234 14,-234 14,-210 195,-210 195,-234"/>
<text text-anchor="middle" x="104.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_context_t%mbe_run_serial</text>
</a>
</g>
</g>
<!-- proc~mbe_run_serial&#45;&gt;interface~serial_fragment_processor -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge25" class="edge">
<title>proc~mbe_run_serial&#45;&gt;interface~serial_fragment_processor</title>
<path fill="none" stroke="#7fff00" d="M195.1,-222C215.08,-222 236.23,-222 256.08,-222"/>
<polygon fill="#7fff00" stroke="#7fff00" points="256.33,-225.5 266.33,-222 256.33,-218.5 256.33,-225.5"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_node23" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~compute_vibrational_thermo~~CalledByGraph_node23"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="151.5,-24 57.5,-24 57.5,0 151.5,0 151.5,-24"/>
<text text-anchor="middle" x="104.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_unfragmented_calculation -->
<g id="proc~~compute_vibrational_thermo~~CalledByGraph_edge27" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_unfragmented_calculation</title>
<path fill="none" stroke="#7f00ff" d="M151.76,-12C178.26,-12 212.55,-12 244.74,-12"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="245.1,-15.5 255.1,-12 245.1,-8.5 245.1,-15.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_vibrational_thermoCalledByGraph = svgPanZoom('#proccompute_vibrational_thermoCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-cv_sum"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>Cv_sum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-e_sum"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>E_sum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_sum"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>S_sum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t~3"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>T</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-exp_neg_u"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>exp_neg_u</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-exp_u"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>exp_u</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-freq"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>freq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~8"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-theta_v"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>theta_v</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>u</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">pure subroutine </span><span class="n">compute_vibrational_thermo</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">n_freqs</span><span class="p">,</span><span class="w"> </span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">Cv</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Compute vibrational contributions to thermodynamic properties.</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! Uses quantum harmonic oscillator partition function.</span>
<span class="w">      </span><span class="c">!! E_vib = R * sum(theta_v * [1/(exp(u)-1)]) where u = theta_v/T</span>
<span class="w">      </span><span class="c">!! S_vib = R * sum([u/(exp(u)-1) - ln(1-exp(-u))])</span>
<span class="w">      </span><span class="c">!! Cv_vib = R * sum(u^2 * exp(u) / (exp(u)-1)^2)</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! Note: ZPE is NOT included here (computed separately).</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">frequencies</span><span class="p">(:)</span><span class="w">  </span><span class="c">!! Frequencies in cm^-1</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_freqs</span><span class="w">          </span><span class="c">!! Number of frequencies</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">temperature</span><span class="w">     </span><span class="c">!! Temperature in K</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">E</span><span class="w">              </span><span class="c">!! Thermal energy in Hartree (excluding ZPE)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="c">!! Entropy in cal/(mol*K)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Cv</span><span class="w">             </span><span class="c">!! Heat capacity in cal/(mol*K)</span>

<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="p">,</span><span class="w"> </span><span class="n">theta_v</span><span class="p">,</span><span class="w"> </span><span class="n">u</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exp_u</span><span class="p">,</span><span class="w"> </span><span class="n">exp_neg_u</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">E_sum</span><span class="p">,</span><span class="w"> </span><span class="n">S_sum</span><span class="p">,</span><span class="w"> </span><span class="n">Cv_sum</span>

<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperature</span>
<span class="w">      </span><span class="n">E_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="n">S_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="n">Cv_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n_freqs</span>
<span class="w">         </span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frequencies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="w">         </span><span class="c">! Skip imaginary and near-zero frequencies</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">IMAG_FREQ_THRESHOLD</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_dp</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w">  </span><span class="c">! Skip very low frequencies (likely trans/rot residuals)</span>

<span class="w">         </span><span class="c">! Vibrational temperature: theta_v = h*c*nu / k = 1.4388 * nu (cm^-1)</span>
<span class="w">         </span><span class="n">theta_v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CM1_TO_KELVIN</span><span class="o">*</span><span class="n">freq</span>

<span class="w">         </span><span class="c">! Reduced temperature ratio</span>
<span class="w">         </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theta_v</span><span class="o">/</span><span class="n">T</span>

<span class="w">         </span><span class="c">! Avoid numerical issues for very large u (very low T or high freq)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">VIB_CLASSICAL_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! Classical limit: modes are frozen out</span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         end if</span>

<span class="k">         </span><span class="n">exp_u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="w">         </span><span class="n">exp_neg_u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span>

<span class="w">         </span><span class="c">! Energy contribution (excluding ZPE): theta_v / (exp(u) - 1)</span>
<span class="w">         </span><span class="n">E_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E_sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theta_v</span><span class="o">/</span><span class="p">(</span><span class="n">exp_u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0_dp</span><span class="p">)</span>

<span class="w">         </span><span class="c">! Entropy contribution: u/(exp(u)-1) - ln(1-exp(-u))</span>
<span class="w">         </span><span class="n">S_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S_sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u</span><span class="o">/</span><span class="p">(</span><span class="n">exp_u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mf">1.0_dp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">exp_neg_u</span><span class="p">)</span>

<span class="w">         </span><span class="c">! Heat capacity contribution: u^2 * exp(u) / (exp(u)-1)^2</span>
<span class="w">         </span><span class="n">Cv_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cv_sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">exp_u</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">exp_u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0_dp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="k">end do</span>

<span class="w">      </span><span class="c">! Convert to proper units</span>
<span class="w">      </span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KB_HARTREE</span><span class="o">*</span><span class="n">E_sum</span><span class="w">           </span><span class="c">! Hartree</span>
<span class="w">      </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R_CALMOLK</span><span class="o">*</span><span class="n">S_sum</span><span class="w">            </span><span class="c">! cal/(mol*K)</span>
<span class="w">      </span><span class="n">Cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R_CALMOLK</span><span class="o">*</span><span class="n">Cv_sum</span><span class="w">          </span><span class="c">! cal/(mol*K)</span>

<span class="w">   </span><span class="k">end subroutine </span><span class="n">compute_vibrational_thermo</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-23 06:10 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>