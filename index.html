

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="./favicon.png">

    <title> metalquicha </title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="./css/fontawesome.min.css" rel="stylesheet">
    <link href="./css/brands.min.css" rel="stylesheet">
    <link href="./css/regular.min.css" rel="stylesheet">
    <link href="./css/solid.min.css" rel="stylesheet">
    <link href="./css/v4-font-face.min.css" rel="stylesheet">
    <link href="./css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="./css/local.css" rel="stylesheet">
    <link href="./css/pygments.css" rel="stylesheet">
    <script src="./js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="./index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="./lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="./search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <!-- Main component for a primary marketing message or call to action -->
    <div class="p-5 mb-4 bg-light border rounded-3" id="jumbotron">
      <p>A demonstration of PIC as a framework for scientific applications targetting quantum chemistry</p>
        <p> Find us on&hellip;</p>
      <p>
        <a class="btn btn-lg btn-primary" href="https://github.com/JorgeG94/metalquicha" role="button">GitHub</a>
        
        
        
        
        <a class="btn btn-lg btn-danger" style="float:right" href="https://github.com/JorgeG94/metalquicha/archive/refs/heads/main.zip" role="button">Download the Source</a>
      </p>
    </div>

      <div class="row" id='text'>
        <div class=col-md-8>
          <h1>metalquicha</h1>
          <div class="toc">
<ul>
<li><a href="#metalquicha-api-documentation">Metalquicha API Documentation</a></li>
<li><a href="#metal-quicha-metalquicha">Met&rsquo;al q&rsquo;uicha (metalquicha)</a><ul>
<li><a href="#ai-disclaimer">AI Disclaimer</a></li>
<li><a href="#building">Building</a><ul>
<li><a href="#notes-on-fortran-compiler-compatibility">Notes on Fortran compiler compatibility</a></li>
<li><a href="#building-with-the-fortran-package-manager-fpm">Building with the Fortran Package Manager (FPM)</a><ul>
<li><a href="#obtaining-the-fpm">Obtaining the FPM</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#running-a-calculation">Running a calculation</a></li>
</ul>
</li>
</ul>
</div>
<div class="alert alert-warning">
<p class="alert-title h4">Warning</p>
<p>This API documentation is a work in progress.</p>
</div>
<h1 id="metalquicha-api-documentation">Metalquicha API Documentation</h1>
<p>This is the main API documentation landing page generated by <a href="https://github.com/Fortran-FOSS-Programmers/ford#readme">FORD</a>.
The documentation for comment markup in source code, running <a href="https://github.com/Fortran-FOSS-Programmers/ford#readme">FORD</a> and the <a href="https://github.com/JorgeG94/metalquicha/blob/HEAD/API-doc-FORD-file.md">FORD project file</a> are all maintained on the <a href="https://github.com/Fortran-FOSS-Programmers/ford/wiki">FORD wiki</a>.</p>
<h1 id="metal-quicha-metalquicha">Met&rsquo;al q&rsquo;uicha (metalquicha)</h1>
<p align="center">
  <img src="images/sunflower.png" alt="Otter coding logo" title="Project logo" width="250">
</p>

<p>Yes, this is AI generated (the image) if you know an artist, please let me know.</p>
<p>Met&rsquo;al q&rsquo;uicha (the Huastec (tenek) word for sunflower), which I&rsquo;ll just write as metalquicha, is a sample quantum chemistry backend
with focus on using the <a href="https://github.com/JorgeG94/pic">pic</a> library and its derivatives:
<a href="https://github.com/JorgeG94/pic-mpi">pic-mpi</a> and <a href="https://github.com/JorgeG94/pic-blas">pic-blas</a>
which are Fortran based implementations of commonly used routines such as sorting algorithms,
array handling, strings, loggers, timers, etc.</p>
<p>The documentation is hosted at readthedocs, <a href="https://metalquicha.readthedocs.io/en/latest/index.html">here</a>.</p>
<p>Additionally, users can opt to try the <a href="https://github.com/jeffhammond/vapaa">vapaa</a> backend for the <code>mpi_f08</code> module
to ensure cross compiler portability. Please report any issues associated here and in vapaa.</p>
<p>Metalquicha implements a naive backend for unfragmented and fragmented quantum chemistry
calculations. Currently, metalquicha uses <a href="https://github.com/tblite/tblite">tblite</a> as
its chemistry engine which performs energy calculations.</p>
<p>If you are interested in contributing, please see <a href="https://github.com/JorgeG94/pic/blob/main/contributing.md">here</a>. Pic is the main project here and all the contributions fall downstream.</p>
<p>You can see <a href="https://github.com/users/JorgeG94/projects/4">Project</a> for some information on development priorities and things being done!</p>
<h2 id="ai-disclaimer">AI Disclaimer</h2>
<p>The development of Metalquicha has been assisted by LLMs, such as ChatGPT, and Claude. The philosophy of &ldquo;vibe coding&rdquo; applied to this project is as follows:</p>
<ul>
<li>The programmer (Jorge), describes the overall architecture of a subroutine to be implemented and provides pseudocode</li>
<li>The LLM produces an implementation that compiles</li>
<li>The programmer writes a unit test for the function and validates the subroutine</li>
<li>The LLM is asked to optimize the code while keeping the tests passing</li>
<li>The programmer evaluates the code and evaluates if the routine needs to be redone or just upgraded by hand</li>
<li>Either the programmer changes the code themselves or if they are lazy or cooking dinner while developing, they ask the LLM to try again</li>
</ul>
<p>This was applied for routines such as the <code>mqc_finite_difference</code> module, which is pretty trivial to implement.</p>
<p>LLMs were also extensively used to add comments and basic documentation for the code. The idea is that
Metalquicha is a platform for development of fragmentation methods aimed to be suitable for everyone -
from students with no experience in Fortran and/or Quantum Chemistry to experienced researchers with
extensive expertise in both.</p>
<p><em>Justification for LLM use</em></p>
<p>I wanted to see to what extent LLMs can be used for Fortran code development. I can conclude that they are actually quite good.</p>
<h2 id="building">Building</h2>
<p>You will need an internet connection to download the dependencies. The main dependencies are:</p>
<ul>
<li>CMake</li>
<li>A Fortran compiler</li>
<li>An MPI installation</li>
<li>A BLAS/LAPACK install</li>
<li>TBLITE (will be downloaded automatically)</li>
</ul>
<p>You can then simply:</p>
<div class="codehilite"><pre><span></span><code>mkdir build
cd build
cmake ../
make -j
</code></pre></div>

<h3 id="notes-on-fortran-compiler-compatibility">Notes on Fortran compiler compatibility</h3>
<p>If you enable tblite (enabled by default at the moment) you are going to be blocked by which compilers does tblite
support. If you decide to not build tblite and just build the framework the code will work with most modern compilers.</p>
<p>Supported compilers:</p>
<p>Using TBlite: gcc, ifx, ifort</p>
<p>Without tblite, i.e. no quantum chemistry: gcc, nvfortran, flang(new), ifx, ifort</p>
<h3 id="building-with-the-fortran-package-manager-fpm">Building with the Fortran Package Manager (FPM)</h3>
<p><em>FPM will only work if you are building with openblas, since the linking step is hardcoded.</em></p>
<p>Simply then just do: <code>fpm install --prefix . --compiler mpifort --profile release</code></p>
<h4 id="obtaining-the-fpm">Obtaining the FPM</h4>
<p>Install the FPM following the <a href="https://fpm.fortran-lang.org/install/index.html#install">instructions</a> and then simply: <code>fpm install</code></p>
<h2 id="running-a-calculation">Running a calculation</h2>
<p>To run a calculation you need to process the JSON input into our <code>mqc</code> format. To do this, you can simply do:</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>mqc_prep.py<span class="w"> </span>validation/inputs/prism.json
</code></pre></div>

<p>And this will generate a <code>prism.mqc</code>. Which can be simply run as <code>./build/mqc validation/inputs/prism.mqc</code> to be run
in serial mode. Or <code>mpirun -np 4 ./build/mqc validation/inputs/prism.mqc</code>.</p>
<p>A sample <code>mqc</code> file is shown below:</p>
<div class="codehilite"><pre><span></span><code><span class="nf">%schema</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mqc</span><span class="o">-</span><span class="n">frag</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">index_base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angstrom</span>
<span class="n">end</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">schema</span>

<span class="nf">%model</span>
<span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XTB</span><span class="o">-</span><span class="n">GFN1</span>
<span class="n">basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cc</span><span class="o">-</span><span class="n">pVDZ</span>
<span class="n">aux_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cc</span><span class="o">-</span><span class="n">pVDZ</span><span class="o">-</span><span class="n">RIFIT</span>
<span class="n">end</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">model</span>

<span class="nf">%driver</span>
<span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Energy</span>
<span class="n">end</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">driver</span>

<span class="nf">%structure</span>
<span class="n">charge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">multiplicity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">end</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">structure</span>

<span class="nf">%geometry</span>
<span class="mi">3</span>

<span class="n">O</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mf">0.119262</span>
<span class="n">H</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mf">0.763239</span><span class="w"> </span><span class="mf">-0.477047</span>
<span class="n">H</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mf">-0.763239</span><span class="w"> </span><span class="mf">-0.477047</span>
<span class="n">end</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">geometry</span>

<span class="nf">%scf</span>
<span class="n">maxiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span>
<span class="n">tolerance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-06</span>
<span class="n">end</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">scf</span>
</code></pre></div>

<p>If you don&rsquo;t want to use the python script, you can modify this file by adding an xyz formatted geometry. Supported calculations are <code>Energy</code>, <code>Gradient</code>, and <code>Hessian</code>.</p>
        </div>
          <div class="col-md-4">
            <div class="card card-body bg-light">
              <h2 class="card-title">Developer Info</h2>
              <h4 class="card-text">Jorge Luis Galvez Vallejo</h4>
              <p class="card-text"></p>
                <div class="text-center"><div class="btn-group" role="group">
                    
                    <a class="btn btn-lg btn-primary" href="https://github.com/JorgeG94"><i class="fa fa-github fa-lg"></i></a>
                    
                    
                    
                    
                    
                    
                </div></div>
            </div>
          </div>
      </div>
        <div class="row">
          <hr>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Source Files</h3>
              <ul><li><a href='sourcefile/main.f90.html'>main.f90</a></li><li><a href='sourcefile/mqc_basis_file_reader.f90.html'>mqc_basis_file_reader.f90</a></li><li><a href='sourcefile/mqc_basis_reader.f90.html'>mqc_basis_reader.f90</a></li><li><a href='sourcefile/mqc_basis_utils.f90.html'>mqc_basis_utils.f90</a></li><li><a href='sourcefile/mqc_calc_types.f90.html'>mqc_calc_types.f90</a></li><li><a href='sourcefile/mqc_calculation_interface.f90.html'>mqc_calculation_interface.f90</a></li><li><a href='sourcefile/mqc_calculation_keywords.f90.html'>mqc_calculation_keywords.f90</a></li><li><a href='sourcefile/mqc_cgto.f90.html'>mqc_cgto.f90</a></li><li><a href='sourcefile/mqc_cli_parser.f90.html'>mqc_cli_parser.f90</a></li><li><a href='sourcefile/mqc_combinatorics.f90.html'>mqc_combinatorics.f90</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/files.html"><em>All source files&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Modules</h3>
              <ul><li><a href='module/mqc_basis_file_reader.html'>mqc_basis_file_reader</a></li><li><a href='module/mqc_basis_reader.html'>mqc_basis_reader</a></li><li><a href='module/mqc_basis_utils.html'>mqc_basis_utils</a></li><li><a href='module/mqc_calc_types.html'>mqc_calc_types</a></li><li><a href='module/mqc_calculation_interface.html'>mqc_calculation_interface</a></li><li><a href='module/mqc_calculation_keywords.html'>mqc_calculation_keywords</a></li><li><a href='module/mqc_cgto.html'>mqc_cgto</a></li><li><a href='module/mqc_cli_parser.html'>mqc_cli_parser</a></li><li><a href='module/mqc_combinatorics.html'>mqc_combinatorics</a></li><li><a href='module/mqc_config_adapter.html'>mqc_config_adapter</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/modules.html"><em>All modules&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Procedures</h3>
              <ul><li><a href='proc/add_hydrogen_caps.html'>add_hydrogen_caps</a></li><li><a href='proc/add_solvation_to_calc.html'>add_solvation_to_calc</a></li><li><a href='proc/allocate_basis_shells.html'>allocate_basis_shells</a></li><li><a href='proc/ang_mom_char_to_int.html'>ang_mom_char_to_int</a></li><li><a href='proc/ang_mom_int_to_char.html'>ang_mom_int_to_char</a></li><li><a href='proc/apply_distance_screening.html'>apply_distance_screening</a></li><li><a href='proc/arrays_equal_internal.html'>arrays_equal_internal</a></li><li><a href='proc/atom_sets_equal.html'>atom_sets_equal</a></li><li><a href='proc/atomic_basis_destroy.html'>atomic_basis_destroy</a></li><li><a href='proc/atomic_basis_num_basis_functions.html'>atomic_basis_num_basis_functions</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/procedures.html"><em>All procedures&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Derived Types</h3>
              <ul><li><a href='type/aimd_keywords_t.html'>aimd_keywords_t</a></li><li><a href='type/atomic_basis_type.html'>atomic_basis_type</a></li><li><a href='type/basis_file_t.html'>basis_file_t</a></li><li><a href='type/bond_t.html'>bond_t</a></li><li><a href='type/calculation_result_t.html'>calculation_result_t</a></li><li><a href='type/cc_energy_t.html'>cc_energy_t</a></li><li><a href='type/cgto_type.html'>cgto_type</a></li><li><a href='type/cli_args_type.html'>cli_args_type</a></li><li><a href='type/displaced_geometry_t.html'>displaced_geometry_t</a></li><li><a href='type/driver_config_t.html'>driver_config_t</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/types.html"><em>All derived types&hellip;</em></a></li>
              </ul>
            </div>
          </div>
        </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-11 12:14 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>